
<style>
    * {
        box-sizing: border-box !important;
    }

    body {
        font-family: 'Inter', 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif !important;
        line-height: 1.9 !important;
        color: #1f1f1f !important;
        max-width: none !important;
        margin: 0 !important;
        padding: 8px 16px 16px 16px !important;
        background: #ffffff !important;
        font-size: 16.5px !important;
    }

    p {
        margin-bottom: 20px !important;
        font-size: 16.5px !important;
        line-height: 1.95 !important;
        color: #1f1f1f !important;
        font-weight: 400 !important;
    }

    strong, b {
        color: #1a73e8 !important;
        font-weight: 700 !important;
        background: rgba(26, 115, 232, 0.08) !important;
        padding: 2px 6px !important;
        border-radius: 8px !important;
    }

    /* Details/Summary (collapsible sections) */
    details {
        background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%) !important;
        border-radius: 8px !important;
        padding: 24px 28px !important;
        margin: 24px 0 !important;
        border: none;
        box-shadow: none !important;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
    }

    details:hover {
        border-color: #1a73e8 !important;
        box-shadow: none !important;
        transform: translateY(-2px) !important;
    }

    details[open] {
        background: #ffffff !important;
        border-color: #1a73e8 !important;
        box-shadow: none !important;
    }

    summary {
        cursor: pointer !important;
        font-weight: 800 !important;
        color: #ffffff !important;
        font-size: 20px !important;
        padding: 16px 24px !important;
        border-radius: 8px !important;
        background: linear-gradient(135deg, #1a73e8 0%, #1557b0 100%) !important;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
        display: flex !important;
        align-items: center !important;
        user-select: none !important;
        box-shadow: none !important;
        letter-spacing: 0.5px !important;
    }

    summary:hover {
        background: linear-gradient(135deg, #1557b0 0%, #0d47a1 100%) !important;
        transform: translateX(6px) scale(1.02) !important;
        box-shadow: none !important;
    }

    summary:active {
        transform: translateX(4px) scale(0.99) !important;
    }

    summary::marker {
        color: rgba(255, 255, 255, 0.9) !important;
        font-size: 1.3em !important;
    }

    summary strong {
        background: rgba(255, 255, 255, 0.2) !important;
        color: #ffffff !important;
        padding: 4px 12px !important;
        border-radius: 8px !important;
        margin-left: 8px !important;
        font-size: 19px !important;
        letter-spacing: 1px !important;
    }

    /* Tables - Premium Design */
    table {
        width: 100% !important;
        border-collapse: separate !important;
        border-spacing: 0 !important;
        margin: 28px 0 !important;
        border-radius: 8px !important;
        overflow: hidden !important;
        box-shadow: none !important;
        border: none !important;
        background: #ffffff !important;
    }

    table.simple-table {
        background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%) !important;
    }

    table tr {
        transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1) !important;
        position: relative !important;
    }

    table tr:nth-child(odd) {
        background: rgba(248, 249, 250, 0.5) !important;
    }

    table tr:nth-child(even) {
        background: rgba(255, 255, 255, 0.8) !important;
    }

    table tr:hover {
        background: linear-gradient(90deg, #e8f0fe 0%, #f1f8ff 100%) !important;
        transform: translateX(4px) scale(1.01) !important;
        box-shadow: none !important;
        z-index: 1 !important;
    }

    table td {
        padding: 18px 24px !important;
        border-bottom: 1px solid rgba(232, 234, 237, 0.6) !important;
        font-size: 16.5px !important;
        line-height: 1.7 !important;
        color: #1f1f1f !important;
        vertical-align: middle !important;
    }

    table tr:last-child td {
        border-bottom: none !important;
    }

    /* First column (A, B, C, D, E) */
    table td:first-child {
        font-weight: 800 !important;
        color: #ffffff !important;
        width: 52px !important;
        text-align: center !important;
        font-size: 18px !important;
        background: linear-gradient(135deg, #1a73e8 0%, #1557b0 100%) !important;
        border-right: 3px solid #1557b0 !important;
        position: relative !important;
        letter-spacing: 0.5px !important;
    }

    table tr:hover td:first-child {
        background: linear-gradient(135deg, #1557b0 0%, #0d47a1 100%) !important;
        box-shadow: none !important;
    }

    /* Second column (content) */
    table td:nth-child(2) {
        font-weight: 500 !important;
        padding-left: 28px !important;
    }

    /* Third column (empty - hide it) */
    table td:last-child:empty {
        display: none !important;
    }

    /* Lists */
    ul, ol {
        margin: 16px 0 !important;
        padding-left: 32px !important;
    }

    li {
        margin: 10px 0 !important;
        line-height: 1.8 !important;
        color: #1f1f1f !important;
    }

    ul.bulleted-list li {
        position: relative !important;
        padding-left: 8px !important;
    }

    ul.toggle {
        list-style: none !important;
        padding-left: 0 !important;
    }

    /* Links */
    a {
        color: #1a73e8 !important;
        text-decoration: none !important;
        font-weight: 600 !important;
        border-bottom: 2px solid transparent !important;
        transition: all 0.2s !important;
    }

    a:hover {
        border-bottom-color: #1a73e8 !important;
        background: rgba(26,115,232,0.08) !important;
        padding: 2px 4px !important;
        border-radius: 8px !important;
    }

    /* Images & Media */
    img, video {
        max-width: none !important;
        height: auto !important;
        border-radius: 8px !important;
        box-shadow: none !important;
        margin: 24px 0 !important;
        display: block !important;
        border: none !important;
    }

    img:hover, video:hover {
        box-shadow: none !important;
        border-color: #1a73e8 !important;
    }

    /* Code blocks (if any) */
    code {
        background: #f1f3f4 !important;
        padding: 2px 8px !important;
        border-radius: 8px !important;
        font-family: 'Courier New', monospace !important;
        font-size: 14px !important;
        color: #d93025 !important;
    }

    pre {
        background: #f8f9fa !important;
        padding: 8px 16px 16px 16px !important;
        border-radius: 8px !important;
        overflow-x: auto !important;
        border-left: 4px solid #1a73e8 !important;
    }

    /* Headings */
    h1, h2, h3, h4, h5, h6 {
        color: #1a73e8 !important;
        font-weight: 700 !important;
        margin-top: 24px !important;
        margin-bottom: 16px !important;
        line-height: 1.4 !important;
    }

    h1 { font-size: 32px !important; }
    h2 { font-size: 26px !important; }
    h3 { font-size: 22px !important; }
    h4 { font-size: 19px !important; }

    /* Blockquotes */
    blockquote {
        border-left: 4px solid #1a73e8 !important;
        padding-left: 20px !important;
        margin: 20px 0 !important;
        font-style: italic !important;
        color: #5f6368 !important;
        background: #f8f9fa !important;
        padding: 16px 20px !important;
        border-radius: 8px !important;
    }

    /* Horizontal Rule */
    hr {
        border: none !important;
        height: 2px !important;
        background: linear-gradient(to right, transparent, #1a73e8, transparent) !important;
        margin: 32px 0 !important;
    }

    /* Selection */
    ::selection {
        background: #e8f0fe !important;
        color: #1a73e8 !important;
    }

    /* Highlighter styles */
    .highlighted {
        background-color: #ffeb3b !important;
        transition: background-color 0.2s ease !important;
    }

    .highlighter-btn {
        background: none !important;
        border: none !important;
        cursor: pointer !important;
        font-size: 20px !important;
        padding: 0 8px !important;
        margin-left: 8px !important;
        transition: transform 0.2s ease !important;
        vertical-align: middle !important;
    }

    .highlighter-btn:hover {
        transform: scale(1.2) !important;
    }

    .highlighter-btn.active {
        transform: scale(1.1) !important;
        filter: brightness(1.2) !important;
    }

    .highlighter-mode-active {
        cursor: text !important;
    }


    /* Right padding to avoid overlap with sidebar buttons */
    body {
        padding-right: 50px !important;
    }

    @media (max-width: 768px) {
        body {
            padding-right: 16px !important;
        }
    }

</style>




<details open>
<summary><strong>1066</strong><button class="bionic-reading-btn" onclick="toggleBionicReading(event)" title="Toggle Bionic Reading (Ctrl+B)"><span id="bionicIcon">üëÅÔ∏è</span></button><button class="highlighter-btn" onclick="toggleHighlighter(event)" title="Toggle Highlighter (Ctrl+H)"><span id="highlighterIcon">üñäÔ∏è</span></button></summary>
<p class="" id="39243eba-076d-45fc-a03b-41a160d71b52">A 35-year-old man comes to the
                                        office with progressively worsening fatigue associated with dark urine and back
                                        pain.  Two days ago, the patient ate some large, flat beans brought home by his
                                        wife after a business trip to Egypt.  Physical examination shows jaundice and
                                        pallor.  Laboratory results reveal a hemoglobin level of 8 g/dL.  Further
                                        evaluation reveals deficiency of an enzyme involved in the conversion of
                                        glucose-6-phosphate to ribulose-5-phosphate.  The substance generated during
                                        this conversion is necessary for which of the following biochemical processes?
                                    </p>
<table class="simple-table" id="689ee87a-ddd3-459b-a3fe-fbf71cf0d230">
<tbody>
<tr id="e4420553-c29b-454b-9e25-d70da9dabb3b">
<td class="" id="gffv">A.</td>
<td class="" id="@YQi">ADP phosphorylation</td>
<td class="" id="cpI~"></td>
</tr>
<tr id="88bcc7ac-72dc-4255-b480-c57ae36a0f46">
<td class="" id="gffv">B.</td>
<td class="" id="@YQi">Fatty acid synthesis</td>
<td class="" id="cpI~"></td>
</tr>
<tr id="58be4c5a-ee6b-4a25-9f46-914b22ef1559">
<td class="" id="gffv">C.</td>
<td class="" id="@YQi">Glycogen storage</td>
<td class="" id="cpI~"></td>
</tr>
<tr id="56fdbd63-5243-4185-84ea-c5c834b2f2bb">
<td class="" id="gffv">D.</td>
<td class="" id="@YQi">Ketone body synthesis</td>
<td class="" id="cpI~"></td>
</tr>
<tr id="05ec7174-ff99-4288-9bd9-fcaeca421da9">
<td class="" id="gffv">E.</td>
<td class="" id="@YQi">Protein degradation</td>
<td class="" id="cpI~"></td>
</tr>
</tbody>
</table>
<ul class="toggle" id="91fd2f6a-2220-45be-b961-52992f374c16">
<li>
<details>
<summary>Explanation</summary>
<table class="simple-table" id="b1120507-5363-4208-a3a5-065073810f28">
<tbody>
<tr id="b97ac7c5-187e-4f6b-98c0-e7d86e1a6f5d">
<td class="" id="kaYH">A.</td>
<td class="" id="sTxu">ADP phosphorylation (30%)</td>
<td class="" id="ZX@j"></td>
</tr>
<tr id="c5e623a4-eb6c-476d-9ada-e8b22990f34b">
<td class="" id="kaYH">B.</td>
<td class="" id="sTxu">Fatty acid synthesis (43%)</td>
<td class="" id="ZX@j"></td>
</tr>
<tr id="771d8e8d-c264-4243-b2ba-0bdf2a73cc73">
<td class="" id="kaYH">C.</td>
<td class="" id="sTxu">Glycogen storage (10%)</td>
<td class="" id="ZX@j"></td>
</tr>
<tr id="308e4c68-def5-4434-a7cb-f63127caf36f">
<td class="" id="kaYH">D.</td>
<td class="" id="sTxu">Ketone body synthesis (8%)</td>
<td class="" id="ZX@j"></td>
</tr>
<tr id="e58a306c-a7f6-4ff8-8731-d78f56a59afc">
<td class="" id="kaYH">E.</td>
<td class="" id="sTxu">Protein degradation (7%)</td>
<td class="" id="ZX@j"></td>
</tr>
</tbody>
</table>
<p class="" id="3303460a-e150-4b0a-aeb0-51a885b339ee">Incorrect</p>
<p class="" id="62e24cea-4cd5-4ed3-84b5-fa4d2afe2329">Correct answer B
                                                </p>
<p class="" id="c8ef7232-93f5-4b18-8301-83f9e5588ae2">43%Answered
                                                    correctly</p>
<p class="" id="01298ce0-2823-4544-9136-a05679f783ce">35 secsTime Spent
                                                </p>
<p class="" id="711e6fe9-3f3b-42d8-a79d-1aac54f5e689">2024Version</p>
<ul class="bulleted-list" id="73873538-a87f-4835-901b-fe040841acb7">
<li style="list-style-type:disc">Explanation</li>
</ul>
<ul class="bulleted-list" id="9a8bd6b0-f557-4f7d-a81e-d4ae0392b176">
<li style="list-style-type:disc"></li>
</ul>
<figure class="image" id="2d02efe7-22f6-441c-9dd2-bae8689f49fb"><a href="https://lh7-us.googleusercontent.com/LbtITeV71MH9Av63ku_7Svhqevwk7PE-8QxuhaA2o7_TNLp6eiRFffIE2SA0H0g2jxUnr5sZn_GHWehqkr-u7JHTUinAJIR6rmFqXc7UP3LSF1OgV_gqjAjsawWmdVS7crT6p00hR09XLElHKKwIcKI"><img loading="lazy" src="https://lh7-us.googleusercontent.com/LbtITeV71MH9Av63ku_7Svhqevwk7PE-8QxuhaA2o7_TNLp6eiRFffIE2SA0H0g2jxUnr5sZn_GHWehqkr-u7JHTUinAJIR6rmFqXc7UP3LSF1OgV_gqjAjsawWmdVS7crT6p00hR09XLElHKKwIcKI" style="width:602px"/></a>
</figure>
<p class="" id="500e09ab-3d35-47d9-810d-e721ade6a5c1">This patient most
                                                    likely has glucose-6-phosphate dehydrogenase (G6PD) deficiency. 
                                                    G6PD catalyzes the first step in the pentose phosphate pathway
                                                    (PPP), the oxidative portion of which generates 2 molecules of NADPH
                                                    while converting glucose-6-phosphate to ribulose-5-phosphate.  The
                                                    nonoxidative reactions of the PPP reversibly convert
                                                    ribulose-5-phosphate into ribose-5-phosphate (substrate for
                                                    nucleotide synthesis) or glycolytic intermediates that can be used
                                                    for energy production.</p>
<p class="" id="1c311aac-15aa-4a07-a2f6-f00d07a64b36">Because the PPP is
                                                    the main source of NADPH, the pathway is particularly active in:</p>
<ul class="bulleted-list" id="1023f342-5ff9-4efe-8f32-e4e8c7b7f14e">
<li style="list-style-type:disc">Cells experiencing high oxidative
                                                        stress (eg, erythrocytes) in which NADPH is used to regenerate
                                                        reduced glutathione, an antioxidant that helps maintain cell
                                                        integrity</li>
</ul>
<ul class="bulleted-list" id="3ea00d15-21c3-4d60-9c8f-2fc97e35911b">
<li style="list-style-type:disc">Organs such as the liver and
                                                        adrenal cortex that are involved in reductive biosynthesis (eg,
                                                        synthesis of fatty acids, cholesterol, steroids) and cytochrome
                                                        P450 metabolism</li>
</ul>
<ul class="bulleted-list" id="40add8b3-fcb9-4b68-b901-06420febe8da">
<li style="list-style-type:disc">Phagocytic cells generating a
                                                        respiratory burst via NADPH oxidase</li>
</ul>
<p class="" id="12da2f1e-c0cc-4e1d-a52c-d174582a003d">In patients with
                                                    G6PD deficiency, erythrocytes are unable to maintain a sufficient
                                                    supply of reduced glutathione during periods of increased oxidative
                                                    stress, which can occur with certain infections (eg, pneumonia,
                                                    viral hepatitis), consumption of fava beans, or specific medications
                                                    (eg, primaquine, sulfa drugs).  The resulting oxidative damage
                                                    causes acute hemolytic anemia and jaundice.</p>
<p class="" id="0f8bca0b-b0cc-46ab-8ba0-9f3216947680">(Choice A)  NADH
                                                    can be used as a reducing agent to convert ADP to ATP during
                                                    oxidative phosphorylation.  In contrast to NADH, NADPH cannot be
                                                    used to convert ADP into ATP.</p>
<p class="" id="a1df8935-656b-4b91-98cb-e020e76961b1">(Choice C) 
                                                    Glycogenesis is the process by which glucose is stored for later use
                                                    through the addition of glucose molecules to glycogen chains.  It
                                                    does not require NADPH.</p>
<p class="" id="7eb7b283-eda9-4d57-9b08-04b1ad7d5c3c">(Choice D)  Ketone
                                                    bodies are formed mainly in the liver during times of fasting when
                                                    there is increased fat degradation.  Cytosolic HMG-CoA synthase is
                                                    the starting point of cholesterol synthesis whereas the
                                                    mitochondrial version of the enzyme is the rate-limiting step in
                                                    ketone body synthesis.  Unlike cholesterol synthesis, ketone body
                                                    production does not require NADPH.</p>
<p class="" id="7cc3aa9a-035e-4c45-862a-0432cb79a0cf">(Choice E) 
                                                    Protein catabolism begins with the hydrolysis of polypeptides into
                                                    amino acids.  These subsequently undergo transamination reactions
                                                    that funnel the amine nitrogen predominately into glutamate, which
                                                    is oxidatively deaminated to produce ammonia.  The urea cycle then
                                                    converts ammonia into urea for elimination in the urine.</p>
<p class="" id="1dd9e659-7ad6-402c-be25-a428d4ef1854">Educational
                                                    objective:</p>
<p class="" id="717050f1-1cec-4d81-b225-de2e748ab07f">
                                                    Glucose-6-phosphate dehydrogenase is the rate-limiting enzyme in the
                                                    pentose phosphate pathway, the major source of cellular NADPH.  This
                                                    molecule is necessary for reducing glutathione (protects red blood
                                                    cells from oxidative damage) and for the biosynthesis of
                                                    cholesterol, fatty acids, and steroids.</p>
<p class="" id="353ca0ac-c47c-4499-8453-6eaab180c6f8">Biochemistry</p>
<p class="" id="1e7cdbda-b368-4c40-b01c-103fcaf01198">Subject</p>
<p class="" id="067ad9fe-6bf8-4fb0-bb3d-6882cac1f98f">Biochemistry
                                                    (General Principles)</p>
<p class="" id="05331ea8-1ebe-4772-bdfa-c071ee094771">System</p>
<p class="" id="a026ae3a-e480-4aac-ae6e-42d55a396d97">Hyperphosphatemia
                                                </p>
<p class="" id="81a3ae71-289f-48ba-9ead-88e590826c79">Topic</p>
<p class="" id="b8b79aa4-198a-4de8-a193-9488da03fea4">Copyright ¬©
                                                    UWorld. All rights reserved.</p>
</details>
</li>
</ul>
</details>


















<style>
.bionic-reading-btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    height: 40px;
    background: rgba(255, 255, 255, 0.2);
    border: 2px solid rgba(255, 255, 255, 0.3);
    border-radius: 8px;
    color: white;
    font-size: 20px;
    cursor: pointer;
    transition: all 0.3s;
    margin-left: auto;
    flex-shrink: 0;
}

.bionic-reading-btn:hover {
    background: rgba(255, 255, 255, 0.35);
    border-color: rgba(255, 255, 255, 0.5);
    transform: scale(1.1);
}

.bionic-reading-btn.active {
    background: rgba(52, 168, 83, 0.4);
    border-color: rgba(52, 168, 83, 0.6);
}

.bionic-reading-btn.active:hover {
    background: rgba(52, 168, 83, 0.5);
}

summary {
    display: flex !important;
    align-items: center !important;
    gap: 12px !important;
}

    /* Highlighter styles */
    .highlighted {
        background-color: #ffeb3b !important;
        transition: background-color 0.2s ease !important;
    }

    .highlighter-btn {
        background: none !important;
        border: none !important;
        cursor: pointer !important;
        font-size: 20px !important;
        padding: 0 8px !important;
        margin-left: 8px !important;
        transition: transform 0.2s ease !important;
        vertical-align: middle !important;
    }

    .highlighter-btn:hover {
        transform: scale(1.2) !important;
    }

    .highlighter-btn.active {
        transform: scale(1.1) !important;
        filter: brightness(1.2) !important;
    }

    .highlighter-mode-active {
        cursor: text !important;
    }


    /* Right padding to avoid overlap with sidebar buttons */
    body {
        padding-right: 50px !important;
    }

    @media (max-width: 768px) {
        body {
            padding-right: 16px !important;
        }
    }


    


    

    /* Adjust table padding to make room for radio button */
    


    /* Clickable Answer Choices */
    table tr.answer-choice {
        cursor: pointer !important;
        transition: all 0.3s ease !important;
    }

    table tr.answer-choice:hover {
        background: #f8f9fa !important;
    }

    table tr.answer-choice td:first-child {
        position: relative !important;
        padding-left: 35px !important;
    }

    table tr.answer-choice td:first-child::before {
        content: '';
        position: absolute;
        left: 8px;
        top: 50%;
        transform: translateY(-50%);
        width: 16px;
        height: 16px;
        border: 2px solid #999;
        border-radius: 50%;
        background: white;
        transition: all 0.2s ease;
        box-sizing: border-box;
    }

    table tr.answer-choice.selected td:first-child::before {
        border-color: #1a73e8;
        border-width: 5px;
    }

    table tr.answer-choice.selected {
        background: #e8f4ff !important;
    }

    table tr.answer-choice.selected td:first-child {
        color: #1a73e8 !important;
        font-weight: 600 !important;
    }

</style>



<script>
let bionicEnabled = false;
const originalContent = {};

function toggleBionicReading(event) {
    if (event) {
        event.preventDefault();
        event.stopPropagation();
    }

    bionicEnabled = !bionicEnabled;
    const btn = document.querySelector('.bionic-reading-btn');
    const icon = document.getElementById('bionicIcon');

    if (bionicEnabled) {
        btn.classList.add('active');
        icon.textContent = '‚úÖ';
        applyBionicReading();
    } else {
        btn.classList.remove('active');
        icon.textContent = 'üëÅÔ∏è';
        restoreOriginalText();
    }
}

function applyBionicReading() {
    // Seleciona todos os elementos de texto, EXCETO summary e buttons
    const textElements = document.querySelectorAll('p:not(summary p):not(button p), td:not(summary td):not(button td), li:not(summary li):not(button li)');

    textElements.forEach((element, index) => {
        // Ignora elementos que cont√™m outros elementos complexos
        if (element.querySelector('p, td, li, h1, h2, h3, h4, h5, h6, button, summary')) {
            return;
        }

        // Ignora se o elemento est√° dentro de um summary ou button
        if (element.closest('summary') || element.closest('button') || element.closest('.bionic-reading-btn')) {
            return;
        }

        // Salva o conte√∫do original
        if (!originalContent[index]) {
            originalContent[index] = {
                element: element,
                html: element.innerHTML
            };
        }

        // Aplica Bionic Reading
        const bionicText = convertToBionic(element.textContent);
        element.innerHTML = bionicText;
    });
}

function restoreOriginalText() {
    // Restaura o conte√∫do original
    Object.values(originalContent).forEach(item => {
        item.element.innerHTML = item.html;
    });
}

function convertToBionic(text) {
    // Divide o texto em palavras, mantendo pontua√ß√£o
    const words = text.split(/(\s+|[.,;:!?()""''\-‚Äì‚Äî])/);

    const bionicWords = words.map(word => {
        // Ignora espa√ßos e pontua√ß√£o
        if (word.match(/^\s+$/) || word.match(/^[.,;:!?()""''\-‚Äì‚Äî]+$/)) {
            return word;
        }

        // Ignora palavras muito curtas (1-2 letras)
        if (word.length <= 2) {
            return word;
        }

        // Determina quantas letras deixar em negrito (metade da palavra, arredondado para cima)
        const boldLength = Math.ceil(word.length / 2);

        // Separa a parte em negrito da parte normal
        const boldPart = word.substring(0, boldLength);
        const normalPart = word.substring(boldLength);

        // Retorna com a primeira parte em negrito
        return `<strong style="font-weight: 700 !important; color: inherit !important; background: none !important; padding: 0 !important;">${boldPart}</strong>${normalPart}`;
    });

    return bionicWords.join('');
}

// Adiciona atalho de teclado (Ctrl+B ou Cmd+B)
document.addEventListener('keydown', function(e) {
    if ((e.ctrlKey || e.metaKey) && e.key === 'b') {
        e.preventDefault();
        toggleBionicReading();
    }
});
</script>

<script>
    let highlighterActive = false;
    let questionHighlights = {};

    // Get question ID from the first summary strong tag
    function getQuestionId() {
        const firstSummary = document.querySelector('summary strong');
        return firstSummary ? firstSummary.textContent.trim() : '1';
    }

    // Load highlights from localStorage
    function loadHighlights() {
        const questionId = getQuestionId();
        const stored = localStorage.getItem('highlights_' + questionId);
        if (stored) {
            questionHighlights = JSON.parse(stored);
            applyStoredHighlights();
        }
    }

    // Save highlights to localStorage
    function saveHighlights() {
        const questionId = getQuestionId();
        localStorage.setItem('highlights_' + questionId, JSON.stringify(questionHighlights));
    }

    // Apply stored highlights
    function applyStoredHighlights() {
        Object.keys(questionHighlights).forEach(key => {
            const element = document.querySelector(`[data-highlight-id="${key}"]`);
            if (element && questionHighlights[key]) {
                element.classList.add('highlighted');
            }
        });
    }

    // Toggle highlighter mode
    function toggleHighlighter(event) {
        event.stopPropagation();
        highlighterActive = !highlighterActive;

        const btn = event.target.closest('.highlighter-btn');
        const icon = btn.querySelector('#highlighterIcon');

        if (highlighterActive) {
            btn.classList.add('active');
            icon.textContent = 'üñçÔ∏è';
            document.body.classList.add('highlighter-mode-active');
        } else {
            btn.classList.remove('active');
            icon.textContent = 'üñäÔ∏è';
            document.body.classList.remove('highlighter-mode-active');
        }
    }

    // Clear all highlights for this question
    function clearHighlights() {
        const questionId = getQuestionId();
        questionHighlights = {};
        localStorage.removeItem('highlights_' + questionId);
        document.querySelectorAll('.highlighted').forEach(el => {
            el.classList.remove('highlighted');
        });
    }

    // Handle text selection and highlighting
    document.addEventListener('mouseup', function(e) {
        if (!highlighterActive) return;

        const selection = window.getSelection();
        if (!selection.toString().trim()) return;

        const range = selection.getRangeAt(0);
        const container = range.commonAncestorContainer;

        // Only highlight text in paragraphs, not in buttons or other elements
        const paragraph = container.nodeType === 3 ? container.parentElement : container;
        if (paragraph.tagName !== 'P' && paragraph.tagName !== 'LI' && paragraph.tagName !== 'TD') {
            return;
        }

        // Create highlight span
        const span = document.createElement('span');
        span.classList.add('highlighted');

        // Generate unique ID for this highlight
        const highlightId = 'hl-' + Date.now() + '-' + Math.random().toString(36).substr(2, 9);
        span.setAttribute('data-highlight-id', highlightId);

        try {
            range.surroundContents(span);
            questionHighlights[highlightId] = true;
            saveHighlights();
        } catch (e) {
            console.log('Could not highlight selection');
        }

        selection.removeAllRanges();
    });

    // Load highlights when page loads
    window.addEventListener('load', loadHighlights);

    // Keyboard shortcut: Ctrl+H to toggle highlighter
    document.addEventListener('keydown', function(e) {
        if (e.ctrlKey && e.key === 'h') {
            e.preventDefault();
            const btn = document.querySelector('.highlighter-btn');
            if (btn) {
                toggleHighlighter({target: btn, stopPropagation: () => {}});
            }
        }
        // Ctrl+Shift+H to clear all highlights
        if (e.ctrlKey && e.shiftKey && e.key === 'H') {
            e.preventDefault();
            if (confirm('Clear all highlights for this question?')) {
                clearHighlights();
            }
        }
    });
</script>





<script>
(function() {
    // Get question ID from summary
    function getQuestionId() {
        const firstSummary = document.querySelector('summary strong');
        return firstSummary ? firstSummary.textContent.trim() : '1';
    }

    // Communicate with parent window (if in iframe)
    function notifyParent(choice) {
        if (window.parent && window.parent !== window) {
            window.parent.postMessage({
                type: 'choiceSelected',
                questionId: getQuestionId(),
                choice: choice
            }, '*');
        }
    }

    // Load saved choice from parent or localStorage
    function loadSavedChoice() {
        const questionId = getQuestionId();

        // Try to get from localStorage first
        const saved = localStorage.getItem('choice_q' + questionId);
        if (saved) {
            selectChoice(saved, false);
        }

        // Ask parent for saved choice (if in iframe)
        if (window.parent && window.parent !== window) {
            window.parent.postMessage({
                type: 'getChoice',
                questionId: questionId
            }, '*');
        }
    }

    // Listen for messages from parent
    window.addEventListener('message', function(event) {
        if (event.data.type === 'setChoice' && event.data.questionId === getQuestionId()) {
            selectChoice(event.data.choice, false);
        }
    });

    // Select a choice
    function selectChoice(choice, notify = true) {
        if (!choice) return;

        const questionId = getQuestionId();

        // Remove previous selection
        document.querySelectorAll('tr.answer-choice').forEach(row => {
            row.classList.remove('selected');
        });

        // Add selection to clicked choice
        const choiceRow = document.querySelector(`tr.answer-choice[data-choice="${choice}"]`);
        if (choiceRow) {
            choiceRow.classList.add('selected');

            // Save to localStorage
            localStorage.setItem('choice_q' + questionId, choice);

            // Notify parent (if in iframe)
            if (notify) {
                notifyParent(choice);
            }
        }
    }

    // Initialize answer choices
    function initializeChoices() {
        // Find all answer choice rows (A, B, C, D, E, F, etc.)
        const choicePattern = /^[A-Z]\.$/;
        const tables = document.querySelectorAll('table.simple-table');

        tables.forEach(table => {
            const rows = table.querySelectorAll('tr');
            rows.forEach(row => {
                const firstCell = row.querySelector('td:first-child');
                if (firstCell && choicePattern.test(firstCell.textContent.trim())) {
                    const choice = firstCell.textContent.trim().replace('.', '');
                    row.classList.add('answer-choice');
                    row.setAttribute('data-choice', choice);
                    row.style.position = 'relative';

                    // Add click handler
                    row.addEventListener('click', function(e) {
                        // Don't trigger if clicking inside a link or button
                        if (e.target.tagName === 'A' || e.target.closest('a')) return;

                        // Toggle selection
                        if (this.classList.contains('selected')) {
                            this.classList.remove('selected');
                            const questionId = getQuestionId();
                            localStorage.removeItem('choice_q' + questionId);
                            notifyParent('');
                        } else {
                            selectChoice(choice);
                        }
                    });
                }
            });
        });

        // Load saved choice after a short delay
        setTimeout(loadSavedChoice, 100);
    }

    // Run when page loads
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initializeChoices);
    } else {
        initializeChoices();
    }
})();
</script>
