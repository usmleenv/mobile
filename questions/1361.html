
<style>
    * {
        box-sizing: border-box !important;
    }

    body {
        font-family: 'Inter', 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif !important;
        line-height: 1.9 !important;
        color: #1f1f1f !important;
        max-width: none !important;
        margin: 0 !important;
        padding: 8px 16px 16px 16px !important;
        background: #ffffff !important;
        font-size: 16.5px !important;
    }

    p {
        margin-bottom: 20px !important;
        font-size: 16.5px !important;
        line-height: 1.95 !important;
        color: #1f1f1f !important;
        font-weight: 400 !important;
    }

    strong, b {
        color: #1a73e8 !important;
        font-weight: 700 !important;
        background: rgba(26, 115, 232, 0.08) !important;
        padding: 2px 6px !important;
        border-radius: 8px !important;
    }

    /* Details/Summary (collapsible sections) */
    details {
        background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%) !important;
        border-radius: 8px !important;
        padding: 24px 28px !important;
        margin: 24px 0 !important;
        border: none;
        box-shadow: none !important;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
    }

    details:hover {
        border-color: #1a73e8 !important;
        box-shadow: none !important;
        transform: translateY(-2px) !important;
    }

    details[open] {
        background: #ffffff !important;
        border-color: #1a73e8 !important;
        box-shadow: none !important;
    }

    summary {
        cursor: pointer !important;
        font-weight: 800 !important;
        color: #ffffff !important;
        font-size: 20px !important;
        padding: 16px 24px !important;
        border-radius: 8px !important;
        background: linear-gradient(135deg, #1a73e8 0%, #1557b0 100%) !important;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
        display: flex !important;
        align-items: center !important;
        user-select: none !important;
        box-shadow: none !important;
        letter-spacing: 0.5px !important;
    }

    summary:hover {
        background: linear-gradient(135deg, #1557b0 0%, #0d47a1 100%) !important;
        transform: translateX(6px) scale(1.02) !important;
        box-shadow: none !important;
    }

    summary:active {
        transform: translateX(4px) scale(0.99) !important;
    }

    summary::marker {
        color: rgba(255, 255, 255, 0.9) !important;
        font-size: 1.3em !important;
    }

    summary strong {
        background: rgba(255, 255, 255, 0.2) !important;
        color: #ffffff !important;
        padding: 4px 12px !important;
        border-radius: 8px !important;
        margin-left: 8px !important;
        font-size: 19px !important;
        letter-spacing: 1px !important;
    }

    /* Tables - Premium Design */
    table {
        width: 100% !important;
        border-collapse: separate !important;
        border-spacing: 0 !important;
        margin: 28px 0 !important;
        border-radius: 8px !important;
        overflow: hidden !important;
        box-shadow: none !important;
        border: none !important;
        background: #ffffff !important;
    }

    table.simple-table {
        background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%) !important;
    }

    table tr {
        transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1) !important;
        position: relative !important;
    }

    table tr:nth-child(odd) {
        background: rgba(248, 249, 250, 0.5) !important;
    }

    table tr:nth-child(even) {
        background: rgba(255, 255, 255, 0.8) !important;
    }

    table tr:hover {
        background: linear-gradient(90deg, #e8f0fe 0%, #f1f8ff 100%) !important;
        transform: translateX(4px) scale(1.01) !important;
        box-shadow: none !important;
        z-index: 1 !important;
    }

    table td {
        padding: 18px 24px !important;
        border-bottom: 1px solid rgba(232, 234, 237, 0.6) !important;
        font-size: 16.5px !important;
        line-height: 1.7 !important;
        color: #1f1f1f !important;
        vertical-align: middle !important;
    }

    table tr:last-child td {
        border-bottom: none !important;
    }

    /* First column (A, B, C, D, E) */
    table td:first-child {
        font-weight: 800 !important;
        color: #ffffff !important;
        width: 52px !important;
        text-align: center !important;
        font-size: 18px !important;
        background: linear-gradient(135deg, #1a73e8 0%, #1557b0 100%) !important;
        border-right: 3px solid #1557b0 !important;
        position: relative !important;
        letter-spacing: 0.5px !important;
    }

    table tr:hover td:first-child {
        background: linear-gradient(135deg, #1557b0 0%, #0d47a1 100%) !important;
        box-shadow: none !important;
    }

    /* Second column (content) */
    table td:nth-child(2) {
        font-weight: 500 !important;
        padding-left: 28px !important;
    }

    /* Third column (empty - hide it) */
    table td:last-child:empty {
        display: none !important;
    }

    /* Lists */
    ul, ol {
        margin: 16px 0 !important;
        padding-left: 32px !important;
    }

    li {
        margin: 10px 0 !important;
        line-height: 1.8 !important;
        color: #1f1f1f !important;
    }

    ul.bulleted-list li {
        position: relative !important;
        padding-left: 8px !important;
    }

    ul.toggle {
        list-style: none !important;
        padding-left: 0 !important;
    }

    /* Links */
    a {
        color: #1a73e8 !important;
        text-decoration: none !important;
        font-weight: 600 !important;
        border-bottom: 2px solid transparent !important;
        transition: all 0.2s !important;
    }

    a:hover {
        border-bottom-color: #1a73e8 !important;
        background: rgba(26,115,232,0.08) !important;
        padding: 2px 4px !important;
        border-radius: 8px !important;
    }

    /* Images & Media */
    img, video {
        max-width: none !important;
        height: auto !important;
        border-radius: 8px !important;
        box-shadow: none !important;
        margin: 24px 0 !important;
        display: block !important;
        border: none !important;
    }

    img:hover, video:hover {
        box-shadow: none !important;
        border-color: #1a73e8 !important;
    }

    /* Code blocks (if any) */
    code {
        background: #f1f3f4 !important;
        padding: 2px 8px !important;
        border-radius: 8px !important;
        font-family: 'Courier New', monospace !important;
        font-size: 14px !important;
        color: #d93025 !important;
    }

    pre {
        background: #f8f9fa !important;
        padding: 8px 16px 16px 16px !important;
        border-radius: 8px !important;
        overflow-x: auto !important;
        border-left: 4px solid #1a73e8 !important;
    }

    /* Headings */
    h1, h2, h3, h4, h5, h6 {
        color: #1a73e8 !important;
        font-weight: 700 !important;
        margin-top: 24px !important;
        margin-bottom: 16px !important;
        line-height: 1.4 !important;
    }

    h1 { font-size: 32px !important; }
    h2 { font-size: 26px !important; }
    h3 { font-size: 22px !important; }
    h4 { font-size: 19px !important; }

    /* Blockquotes */
    blockquote {
        border-left: 4px solid #1a73e8 !important;
        padding-left: 20px !important;
        margin: 20px 0 !important;
        font-style: italic !important;
        color: #5f6368 !important;
        background: #f8f9fa !important;
        padding: 16px 20px !important;
        border-radius: 8px !important;
    }

    /* Horizontal Rule */
    hr {
        border: none !important;
        height: 2px !important;
        background: linear-gradient(to right, transparent, #1a73e8, transparent) !important;
        margin: 32px 0 !important;
    }

    /* Selection */
    ::selection {
        background: #e8f0fe !important;
        color: #1a73e8 !important;
    }

    /* Highlighter styles */
    .highlighted {
        background-color: #ffeb3b !important;
        transition: background-color 0.2s ease !important;
    }

    .highlighter-btn {
        background: none !important;
        border: none !important;
        cursor: pointer !important;
        font-size: 20px !important;
        padding: 0 8px !important;
        margin-left: 8px !important;
        transition: transform 0.2s ease !important;
        vertical-align: middle !important;
    }

    .highlighter-btn:hover {
        transform: scale(1.2) !important;
    }

    .highlighter-btn.active {
        transform: scale(1.1) !important;
        filter: brightness(1.2) !important;
    }

    .highlighter-mode-active {
        cursor: text !important;
    }


    /* Right padding to avoid overlap with sidebar buttons */
    body {
        padding-right: 50px !important;
    }

    @media (max-width: 768px) {
        body {
            padding-right: 16px !important;
        }
    }

</style>




<details open>
<summary><strong>1361</strong><button class="bionic-reading-btn" onclick="toggleBionicReading(event)" title="Toggle Bionic Reading (Ctrl+B)"><span id="bionicIcon">üëÅÔ∏è</span></button><button class="highlighter-btn" onclick="toggleHighlighter(event)" title="Toggle Highlighter (Ctrl+H)"><span id="highlighterIcon">üñäÔ∏è</span></button></summary>
<p class="" id="3ec7b4cc-9a01-4ecc-8452-09ab1e249ff1">A 4-year-old boy is brought to
                                        the hospital after several episodes of vomiting.  The boy's mother reports
                                        that he was playing at a local park prior to the onset of illness.  While
                                        cleaning him after the first episode of emesis, she found several small brown
                                        mushrooms clenched in his hands and brought samples with her.  The boy is
                                        otherwise healthy and takes no medications.  He is intubated due to somnolence
                                        and admitted to the intensive care unit.  Analysis of the mushroom samples
                                        determines that the main poison stimulates muscarinic receptors.  Which of the
                                        following is the most direct effect of this poison?</p>
<table class="simple-table" id="b6f51120-6950-40ad-98bb-2dbf6defeb72">
<tbody>
<tr id="e054b071-01f8-4076-8dd3-1c706284e437">
<td class="" id="o[g{">A.</td>
<td class="" id="QgKa">Detrusor muscle relaxation</td>
<td class="" id="UJEf"></td>
</tr>
<tr id="0bdd2d34-a72f-4c3f-8a35-4f5ff56a8b28">
<td class="" id="o[g{">B.</td>
<td class="" id="QgKa">Increased myocardial contractility</td>
<td class="" id="UJEf"></td>
</tr>
<tr id="5a95418c-a2f5-463d-a8e9-cd0fde416a23">
<td class="" id="o[g{">C.</td>
<td class="" id="QgKa">Kidney renin release</td>
<td class="" id="UJEf"></td>
</tr>
<tr id="1c7879b9-8807-4fac-8e26-1951e8222abe">
<td class="" id="o[g{">D.</td>
<td class="" id="QgKa">Nitric oxide synthesis</td>
<td class="" id="UJEf"></td>
</tr>
<tr id="f7f3f9b2-a6b1-4e66-bcae-51fbb5d1b26e">
<td class="" id="o[g{">E.</td>
<td class="" id="QgKa">Pupillary dilation</td>
<td class="" id="UJEf"></td>
</tr>
<tr id="a23d6b73-5cdf-4757-a97a-5c796853ecbf">
<td class="" id="o[g{">F.</td>
<td class="" id="QgKa">Reduced salivation</td>
<td class="" id="UJEf"></td>
</tr>
</tbody>
</table>
<ul class="toggle" id="88556e3e-3ff8-42d7-a3d6-762c3d41e049">
<li>
<details>
<summary>Submit</summary>
<table class="simple-table" id="c07b9bfe-bba5-4bc1-b95f-2e711be64831">
<tbody>
<tr id="874c9ce7-d2cb-44df-a1d9-218bc582a8fe">
<td class="" id="tWH;">A.</td>
<td class="" id="avId">Detrusor muscle relaxation (28%)</td>
<td class="" id="LhEC"></td>
</tr>
<tr id="59b5514d-4dad-4ceb-8a91-d367dcc0e5c3">
<td class="" id="tWH;">B.</td>
<td class="" id="avId">Increased myocardial contractility
                                                                (6%)</td>
<td class="" id="LhEC"></td>
</tr>
<tr id="35a1857c-ea9f-4ba0-adeb-a490d7e40b63">
<td class="" id="tWH;">C.</td>
<td class="" id="avId">Kidney renin release (3%)</td>
<td class="" id="LhEC"></td>
</tr>
<tr id="c8931376-f78c-43e7-90b7-e3864e18af84">
<td class="" id="tWH;">D.</td>
<td class="" id="avId">Nitric oxide synthesis (37%)</td>
<td class="" id="LhEC"></td>
</tr>
<tr id="23810194-c9f5-4751-a3c6-66e3955661bf">
<td class="" id="tWH;">E.</td>
<td class="" id="avId">Pupillary dilation (15%)</td>
<td class="" id="LhEC"></td>
</tr>
<tr id="c11842ad-fa7d-4601-9e19-42e38d486c09">
<td class="" id="tWH;">F.</td>
<td class="" id="avId">Reduced salivation (8%)</td>
<td class="" id="LhEC"></td>
</tr>
</tbody>
</table>
<p class="" id="13eb11b3-c769-4c02-a6da-f9860f3dc8e4">Omitted</p>
<p class="" id="f605fdce-fc41-4592-9dd2-425bf4f84363">Correct answer D
                                                </p>
<p class="" id="162247a6-007f-4c5d-bf74-570235e6977f">37%Answered
                                                    correctly</p>
<p class="" id="fe5aead2-d3d3-4101-a1d5-06e5b6b795b7">0 secsTime Spent
                                                </p>
<p class="" id="57023fe4-cd9b-48ee-a51d-37a08fbee397">2024Version</p>
<ul class="bulleted-list" id="60210755-45df-41ae-9239-82ee809faba4">
<li style="list-style-type:disc">Explanation</li>
</ul>
<ul class="bulleted-list" id="bbb458e1-5765-485b-97b5-33aabe063f7c">
<li style="list-style-type:disc"></li>
</ul>
<table class="simple-table" id="409074af-ce9c-4e54-ae2e-648e71159c1b">
<tbody>
<tr id="097432cd-8c24-40c6-8941-e3855c02690a">
<td class="" id="jv?e">Characteristics of muscarinic
                                                                acetylcholine receptors</td>
<td class="" id="IH:}"></td>
<td class="" id="|]vw"></td>
<td class="" id="_\uM"></td>
</tr>
<tr id="90a047b3-4588-4398-8bbf-1693ff001f7c">
<td class="" id="jv?e">Receptor</td>
<td class="" id="IH:}">Target organ(s)</td>
<td class="" id="|]vw">Effect of stimulation</td>
<td class="" id="_\uM">Effect of inhibition</td>
</tr>
<tr id="7cfda01c-53d1-4c8f-b6bf-5991f840a80f">
<td class="" id="jv?e">M1</td>
<td class="" id="IH:}">Brain</td>
<td class="" id="|]vw">Memory formation/cognitive
                                                                functioning</td>
<td class="" id="_\uM">Confusion</td>
</tr>
<tr id="11016016-4121-4bb4-94c4-5b81a97a3475">
<td class="" id="jv?e">M2</td>
<td class="" id="IH:}">Heart</td>
<td class="" id="|]vw">Decreased heart rate &amp; atrial
                                                                contraction</td>
<td class="" id="_\uM">Increased heart rate &amp;
                                                                contractility</td>
</tr>
<tr id="4a2961d1-dc5f-41a1-a372-110d215545b2">
<td class="" id="jv?e">M3</td>
<td class="" id="IH:}">Peripheral<br/>vasculature<br/>
</td>
<td class="" id="|]vw">Smooth muscle relaxation,
                                                                vasodilation, hypotension</td>
<td class="" id="_\uM">Smooth muscle contraction,
                                                                vasoconstriction, hypertension</td>
</tr>
<tr id="b085a463-d097-4ce3-a2e4-52100ae9aeb8">
<td class="" id="jv?e"></td>
<td class="" id="IH:}">Lungs</td>
<td class="" id="|]vw">Bronchoconstriction</td>
<td class="" id="_\uM">Bronchodilation</td>
</tr>
<tr id="e4c85e44-763d-43dc-a445-5673f295b0fc">
<td class="" id="jv?e"></td>
<td class="" id="IH:}">Bladder</td>
<td class="" id="|]vw">Detrusor contraction</td>
<td class="" id="_\uM">Detrusor relaxation, urinary
                                                                retention</td>
</tr>
<tr id="2e4232e6-d343-422d-a153-bd20df32cc23">
<td class="" id="jv?e"></td>
<td class="" id="IH:}">Eyes</td>
<td class="" id="|]vw">Pupillary sphincter muscle
                                                                contraction (miosis), ciliary muscle contraction
                                                                (accommodation)</td>
<td class="" id="_\uM">Mydriasis, cycloplegia, may
                                                                precipitate acute angle glaucoma in elderly patients
                                                            </td>
</tr>
<tr id="7744a560-3b62-4140-85f7-d5d603c36ffa">
<td class="" id="jv?e"></td>
<td class="" id="IH:}">Gastrointestinal<br/>tract<br/>
</td>
<td class="" id="|]vw">Increased peristalsis, increased
                                                                salivary &amp; gastric secretions</td>
<td class="" id="_\uM">Constipation, dry mouth, decreased
                                                                acid production</td>
</tr>
<tr id="a850788d-7a9d-4160-ad79-64582a54dec6">
<td class="" id="jv?e"></td>
<td class="" id="IH:}">Skin</td>
<td class="" id="|]vw">Increased sweat production</td>
<td class="" id="_\uM">Increased temperature<br/>(from
                                                                decreased sweating)<br/></td>
</tr>
</tbody>
</table>
<p class="" id="e6f5bf0b-bff6-450c-a335-f7a060a2540d">Muscarine, a toxin
                                                    found in certain mushrooms, acts as a muscarinic (M) agonist in
                                                    place of acetylcholine, resulting in an increase in parasympathetic
                                                    nervous system activity.  The M2 and M3 subtype receptors are
                                                    responsible for most of the toxicities seen in patients.</p>
<p class="" id="9263dc16-efae-490f-8a9e-dc00e849ce70">Although the walls
                                                    of peripheral blood vessels lack cholinergic innervation, M3
                                                    receptors are present on the endothelial surface.  Activation of M3
                                                    receptors promotes synthesis of nitric oxide (NO), an
                                                    endothelium-derived relaxing factor.  NO diffuses into vascular
                                                    smooth muscle cells, activating guanylate cyclase and increasing
                                                    intracellular cyclic-GMP.  Increased levels of cyclic-GMP activate
                                                    myosin light chain phosphatase, which dephosphorylates myosin and
                                                    prevents interaction of the myosin head with actin, resulting in
                                                    smooth muscle relaxation and vasodilation.  Vasodilation results in
                                                    hypotension, with persistently low blood pressure leading to
                                                    somnolence due to inadequate cerebral perfusion.</p>
<p class="" id="063b4c86-913f-4ed8-9deb-0428a04f25dd">In contrast,
                                                    activation of M3 receptors in other sites leads to a
                                                    G-protein-coupled increase in intracellular calcium, resulting in
                                                    smooth muscle contraction.  Clinically, this contraction manifests
                                                    as detrusor bladder muscle contraction (Choice A), pupillary
                                                    constriction or miosis (Choice E), and exocrine gland secretion (eg,
                                                    salivation) (Choice F).</p>
<p class="" id="9ac70dcd-7c3b-44ed-8151-7d79b513d6d0">(Choice B)  M2
                                                    receptors are predominantly found in cardiac muscle.  Activation of
                                                    M2 receptors leads to a G-protein-coupled decrease in intracellular
                                                    cyclic-AMP and opens potassium channels to slow depolarization. 
                                                    This combination results in decreased inotropy (less contractility)
                                                    and chronotropy (decreased heart rate).</p>
<p class="" id="7091299e-dc2d-404c-808e-99bdf3828912">(Choice C) 
                                                    Juxtaglomerular cells in the kidney release renin in response to
                                                    decreased renal perfusion pressure.  A muscarinic agonist would not
                                                    have a direct effect on renin release, although the peripheral
                                                    vasodilation and bradycardia might indirectly lead to renin release.
                                                </p>
<p class="" id="29172583-e5a2-482c-bdd2-c238cb5499c3">Educational
                                                    objective:</p>
<p class="" id="517d570e-1d26-4f1f-a8aa-9bbf60b88713">Activation of
                                                    muscarinic receptors by acetylcholine or cholinergic agonists
                                                    results in peripheral vasodilation due to synthesis of nitric oxide
                                                    in endothelial cells, which leads to vascular smooth muscle
                                                    relaxation (eg, hypotension).  Muscarinic receptor activation in
                                                    other sites causes smooth muscle contraction.</p>
<p class="" id="1a094014-9b8f-4289-a7cd-ad7a65698fea">References</p>
<ul class="bulleted-list" id="687151fc-58ef-4b17-a9e6-8c78d165c831">
<li style="list-style-type:disc"><a href="http://www.ncbi.nlm.nih.gov/pubmed/23833447">Muscarinic
                                                            toxicity among family members after consumption of
                                                            mushrooms.</a></li>
</ul>
<ul class="bulleted-list" id="1546a19d-22e3-4a26-bb4c-1131da5dc03b">
<li style="list-style-type:disc"><a href="http://www.ncbi.nlm.nih.gov/pubmed/23597304">New
                                                            pharmacological approaches to the cholinergic system: an
                                                            overview on muscarinic receptor ligands and cholinesterase
                                                            inhibitors.</a></li>
</ul>
<p class="" id="c433b60f-23a6-48ba-9bc8-6ede512a7241">Physiology</p>
<p class="" id="a2611dca-4c52-4084-8127-7d07834fe036">Subject</p>
<p class="" id="cde37968-57df-4781-b7da-091b8c746a05">Poisoning &amp;
                                                    Environmental Exposure</p>
<p class="" id="82c22a4c-b035-467f-adc8-b7da97e452a3">System</p>
<p class="" id="e17aa423-f0ba-4930-bf12-54a302f91046">Mushroom poisoning
                                                </p>
<p class="" id="1c20bbfd-7a65-46a8-9b9d-5e5a4e32451e">Topic</p>
<p class="" id="8bd51fce-6369-4e86-8e9d-00abcf6a23e9">Copyright ¬©
                                                    UWorld. All rights reserved.</p>
<p class="" id="9979c123-027e-47e8-9d4e-739e63f85781">REVIEW</p>
<p class="" id="791f4f89-af6f-4787-9cac-5b38e1ffe968">‚ú®Done</p>
<p class="" id="637e0d4a-798d-4726-bcdc-464d7eefc687">Exhibit Display
                                                </p>
<figure class="image" id="b45493ad-11c1-4429-84ac-20f1b799ed2c"><a href="https://lh7-us.googleusercontent.com/uvQZLx74YZXs0kJcyT4sNmWoTtKWjAze0egtAplGZkqSNtC7V3h-IkqPQIg5DCMy8aBeyjnsu_ruO8ClnNTOc8Gg5372kZdnJRCMoGEmOu2A-SQgHnhMniWIN4IOyok1yi7QIDlLNwf-gg9yFTRiu60"><img loading="lazy" src="https://lh7-us.googleusercontent.com/uvQZLx74YZXs0kJcyT4sNmWoTtKWjAze0egtAplGZkqSNtC7V3h-IkqPQIg5DCMy8aBeyjnsu_ruO8ClnNTOc8Gg5372kZdnJRCMoGEmOu2A-SQgHnhMniWIN4IOyok1yi7QIDlLNwf-gg9yFTRiu60" style="width:602px"/></a>
</figure>
<p class="" id="cf5280c5-12e3-4597-afc4-2967289ee377">Zoom InZoom Out 
                                                    ResetNew</p>
<p class="" id="e917bf14-6535-4586-a4e1-99eb64282f60">ExistingMy
                                                    Notebook</p>
</details>
</li>
</ul>
</details>


















<style>
.bionic-reading-btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    height: 40px;
    background: rgba(255, 255, 255, 0.2);
    border: 2px solid rgba(255, 255, 255, 0.3);
    border-radius: 8px;
    color: white;
    font-size: 20px;
    cursor: pointer;
    transition: all 0.3s;
    margin-left: auto;
    flex-shrink: 0;
}

.bionic-reading-btn:hover {
    background: rgba(255, 255, 255, 0.35);
    border-color: rgba(255, 255, 255, 0.5);
    transform: scale(1.1);
}

.bionic-reading-btn.active {
    background: rgba(52, 168, 83, 0.4);
    border-color: rgba(52, 168, 83, 0.6);
}

.bionic-reading-btn.active:hover {
    background: rgba(52, 168, 83, 0.5);
}

summary {
    display: flex !important;
    align-items: center !important;
    gap: 12px !important;
}

    /* Highlighter styles */
    .highlighted {
        background-color: #ffeb3b !important;
        transition: background-color 0.2s ease !important;
    }

    .highlighter-btn {
        background: none !important;
        border: none !important;
        cursor: pointer !important;
        font-size: 20px !important;
        padding: 0 8px !important;
        margin-left: 8px !important;
        transition: transform 0.2s ease !important;
        vertical-align: middle !important;
    }

    .highlighter-btn:hover {
        transform: scale(1.2) !important;
    }

    .highlighter-btn.active {
        transform: scale(1.1) !important;
        filter: brightness(1.2) !important;
    }

    .highlighter-mode-active {
        cursor: text !important;
    }


    /* Right padding to avoid overlap with sidebar buttons */
    body {
        padding-right: 50px !important;
    }

    @media (max-width: 768px) {
        body {
            padding-right: 16px !important;
        }
    }

</style>



<script>
let bionicEnabled = false;
const originalContent = {};

function toggleBionicReading(event) {
    if (event) {
        event.preventDefault();
        event.stopPropagation();
    }

    bionicEnabled = !bionicEnabled;
    const btn = document.querySelector('.bionic-reading-btn');
    const icon = document.getElementById('bionicIcon');

    if (bionicEnabled) {
        btn.classList.add('active');
        icon.textContent = '‚úÖ';
        applyBionicReading();
    } else {
        btn.classList.remove('active');
        icon.textContent = 'üëÅÔ∏è';
        restoreOriginalText();
    }
}

function applyBionicReading() {
    // Seleciona todos os elementos de texto, EXCETO summary e buttons
    const textElements = document.querySelectorAll('p:not(summary p):not(button p), td:not(summary td):not(button td), li:not(summary li):not(button li)');

    textElements.forEach((element, index) => {
        // Ignora elementos que cont√™m outros elementos complexos
        if (element.querySelector('p, td, li, h1, h2, h3, h4, h5, h6, button, summary')) {
            return;
        }

        // Ignora se o elemento est√° dentro de um summary ou button
        if (element.closest('summary') || element.closest('button') || element.closest('.bionic-reading-btn')) {
            return;
        }

        // Salva o conte√∫do original
        if (!originalContent[index]) {
            originalContent[index] = {
                element: element,
                html: element.innerHTML
            };
        }

        // Aplica Bionic Reading
        const bionicText = convertToBionic(element.textContent);
        element.innerHTML = bionicText;
    });
}

function restoreOriginalText() {
    // Restaura o conte√∫do original
    Object.values(originalContent).forEach(item => {
        item.element.innerHTML = item.html;
    });
}

function convertToBionic(text) {
    // Divide o texto em palavras, mantendo pontua√ß√£o
    const words = text.split(/(\s+|[.,;:!?()""''\-‚Äì‚Äî])/);

    const bionicWords = words.map(word => {
        // Ignora espa√ßos e pontua√ß√£o
        if (word.match(/^\s+$/) || word.match(/^[.,;:!?()""''\-‚Äì‚Äî]+$/)) {
            return word;
        }

        // Ignora palavras muito curtas (1-2 letras)
        if (word.length <= 2) {
            return word;
        }

        // Determina quantas letras deixar em negrito (metade da palavra, arredondado para cima)
        const boldLength = Math.ceil(word.length / 2);

        // Separa a parte em negrito da parte normal
        const boldPart = word.substring(0, boldLength);
        const normalPart = word.substring(boldLength);

        // Retorna com a primeira parte em negrito
        return `<strong style="font-weight: 700 !important; color: inherit !important; background: none !important; padding: 0 !important;">${boldPart}</strong>${normalPart}`;
    });

    return bionicWords.join('');
}

// Adiciona atalho de teclado (Ctrl+B ou Cmd+B)
document.addEventListener('keydown', function(e) {
    if ((e.ctrlKey || e.metaKey) && e.key === 'b') {
        e.preventDefault();
        toggleBionicReading();
    }
});
</script>

<script>
    let highlighterActive = false;
    let questionHighlights = {};

    // Get question ID from the first summary strong tag
    function getQuestionId() {
        const firstSummary = document.querySelector('summary strong');
        return firstSummary ? firstSummary.textContent.trim() : '1';
    }

    // Load highlights from localStorage
    function loadHighlights() {
        const questionId = getQuestionId();
        const stored = localStorage.getItem('highlights_' + questionId);
        if (stored) {
            questionHighlights = JSON.parse(stored);
            applyStoredHighlights();
        }
    }

    // Save highlights to localStorage
    function saveHighlights() {
        const questionId = getQuestionId();
        localStorage.setItem('highlights_' + questionId, JSON.stringify(questionHighlights));
    }

    // Apply stored highlights
    function applyStoredHighlights() {
        Object.keys(questionHighlights).forEach(key => {
            const element = document.querySelector(`[data-highlight-id="${key}"]`);
            if (element && questionHighlights[key]) {
                element.classList.add('highlighted');
            }
        });
    }

    // Toggle highlighter mode
    function toggleHighlighter(event) {
        event.stopPropagation();
        highlighterActive = !highlighterActive;

        const btn = event.target.closest('.highlighter-btn');
        const icon = btn.querySelector('#highlighterIcon');

        if (highlighterActive) {
            btn.classList.add('active');
            icon.textContent = 'üñçÔ∏è';
            document.body.classList.add('highlighter-mode-active');
        } else {
            btn.classList.remove('active');
            icon.textContent = 'üñäÔ∏è';
            document.body.classList.remove('highlighter-mode-active');
        }
    }

    // Clear all highlights for this question
    function clearHighlights() {
        const questionId = getQuestionId();
        questionHighlights = {};
        localStorage.removeItem('highlights_' + questionId);
        document.querySelectorAll('.highlighted').forEach(el => {
            el.classList.remove('highlighted');
        });
    }

    // Handle text selection and highlighting
    document.addEventListener('mouseup', function(e) {
        if (!highlighterActive) return;

        const selection = window.getSelection();
        if (!selection.toString().trim()) return;

        const range = selection.getRangeAt(0);
        const container = range.commonAncestorContainer;

        // Only highlight text in paragraphs, not in buttons or other elements
        const paragraph = container.nodeType === 3 ? container.parentElement : container;
        if (paragraph.tagName !== 'P' && paragraph.tagName !== 'LI' && paragraph.tagName !== 'TD') {
            return;
        }

        // Create highlight span
        const span = document.createElement('span');
        span.classList.add('highlighted');

        // Generate unique ID for this highlight
        const highlightId = 'hl-' + Date.now() + '-' + Math.random().toString(36).substr(2, 9);
        span.setAttribute('data-highlight-id', highlightId);

        try {
            range.surroundContents(span);
            questionHighlights[highlightId] = true;
            saveHighlights();
        } catch (e) {
            console.log('Could not highlight selection');
        }

        selection.removeAllRanges();
    });

    // Load highlights when page loads
    window.addEventListener('load', loadHighlights);

    // Keyboard shortcut: Ctrl+H to toggle highlighter
    document.addEventListener('keydown', function(e) {
        if (e.ctrlKey && e.key === 'h') {
            e.preventDefault();
            const btn = document.querySelector('.highlighter-btn');
            if (btn) {
                toggleHighlighter({target: btn, stopPropagation: () => {}});
            }
        }
        // Ctrl+Shift+H to clear all highlights
        if (e.ctrlKey && e.shiftKey && e.key === 'H') {
            e.preventDefault();
            if (confirm('Clear all highlights for this question?')) {
                clearHighlights();
            }
        }
    });
</script>
