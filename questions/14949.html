
<style>
    * {
        box-sizing: border-box !important;
    }

    body {
        font-family: 'Inter', 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif !important;
        line-height: 1.9 !important;
        color: #1f1f1f !important;
        max-width: none !important;
        margin: 0 !important;
        padding: 8px 16px 16px 16px !important;
        background: #ffffff !important;
        font-size: 16.5px !important;
    }

    p {
        margin-bottom: 20px !important;
        font-size: 16.5px !important;
        line-height: 1.95 !important;
        color: #1f1f1f !important;
        font-weight: 400 !important;
    }

    strong, b {
        color: #1a73e8 !important;
        font-weight: 700 !important;
        background: rgba(26, 115, 232, 0.08) !important;
        padding: 2px 6px !important;
        border-radius: 8px !important;
    }

    /* Details/Summary (collapsible sections) */
    details {
        background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%) !important;
        border-radius: 8px !important;
        padding: 24px 28px !important;
        margin: 24px 0 !important;
        border: none;
        box-shadow: none !important;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
    }

    details:hover {
        border-color: #1a73e8 !important;
        box-shadow: none !important;
        transform: translateY(-2px) !important;
    }

    details[open] {
        background: #ffffff !important;
        border-color: #1a73e8 !important;
        box-shadow: none !important;
    }

    summary {
        cursor: pointer !important;
        font-weight: 800 !important;
        color: #ffffff !important;
        font-size: 20px !important;
        padding: 16px 24px !important;
        border-radius: 8px !important;
        background: linear-gradient(135deg, #1a73e8 0%, #1557b0 100%) !important;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
        display: flex !important;
        align-items: center !important;
        user-select: none !important;
        box-shadow: none !important;
        letter-spacing: 0.5px !important;
    }

    summary:hover {
        background: linear-gradient(135deg, #1557b0 0%, #0d47a1 100%) !important;
        transform: translateX(6px) scale(1.02) !important;
        box-shadow: none !important;
    }

    summary:active {
        transform: translateX(4px) scale(0.99) !important;
    }

    summary::marker {
        color: rgba(255, 255, 255, 0.9) !important;
        font-size: 1.3em !important;
    }

    summary strong {
        background: rgba(255, 255, 255, 0.2) !important;
        color: #ffffff !important;
        padding: 4px 12px !important;
        border-radius: 8px !important;
        margin-left: 8px !important;
        font-size: 19px !important;
        letter-spacing: 1px !important;
    }

    /* Tables - Premium Design */
    table {
        width: 100% !important;
        border-collapse: separate !important;
        border-spacing: 0 !important;
        margin: 28px 0 !important;
        border-radius: 8px !important;
        overflow: hidden !important;
        box-shadow: none !important;
        border: none !important;
        background: #ffffff !important;
    }

    table.simple-table {
        background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%) !important;
    }

    table tr {
        transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1) !important;
        position: relative !important;
    }

    table tr:nth-child(odd) {
        background: rgba(248, 249, 250, 0.5) !important;
    }

    table tr:nth-child(even) {
        background: rgba(255, 255, 255, 0.8) !important;
    }

    table tr:hover {
        background: linear-gradient(90deg, #e8f0fe 0%, #f1f8ff 100%) !important;
        transform: translateX(4px) scale(1.01) !important;
        box-shadow: none !important;
        z-index: 1 !important;
    }

    table td {
        padding: 18px 24px !important;
        border-bottom: 1px solid rgba(232, 234, 237, 0.6) !important;
        font-size: 16.5px !important;
        line-height: 1.7 !important;
        color: #1f1f1f !important;
        vertical-align: middle !important;
    }

    table tr:last-child td {
        border-bottom: none !important;
    }

    /* First column (A, B, C, D, E) */
    table td:first-child {
        font-weight: 800 !important;
        color: #ffffff !important;
        width: 52px !important;
        text-align: center !important;
        font-size: 18px !important;
        background: linear-gradient(135deg, #1a73e8 0%, #1557b0 100%) !important;
        border-right: 3px solid #1557b0 !important;
        position: relative !important;
        letter-spacing: 0.5px !important;
    }

    table tr:hover td:first-child {
        background: linear-gradient(135deg, #1557b0 0%, #0d47a1 100%) !important;
        box-shadow: none !important;
    }

    /* Second column (content) */
    table td:nth-child(2) {
        font-weight: 500 !important;
        padding-left: 28px !important;
    }

    /* Third column (empty - hide it) */
    table td:last-child:empty {
        display: none !important;
    }

    /* Lists */
    ul, ol {
        margin: 16px 0 !important;
        padding-left: 32px !important;
    }

    li {
        margin: 10px 0 !important;
        line-height: 1.8 !important;
        color: #1f1f1f !important;
    }

    ul.bulleted-list li {
        position: relative !important;
        padding-left: 8px !important;
    }

    ul.toggle {
        list-style: none !important;
        padding-left: 0 !important;
    }

    /* Links */
    a {
        color: #1a73e8 !important;
        text-decoration: none !important;
        font-weight: 600 !important;
        border-bottom: 2px solid transparent !important;
        transition: all 0.2s !important;
    }

    a:hover {
        border-bottom-color: #1a73e8 !important;
        background: rgba(26,115,232,0.08) !important;
        padding: 2px 4px !important;
        border-radius: 8px !important;
    }

    /* Images & Media */
    img, video {
        max-width: none !important;
        height: auto !important;
        border-radius: 8px !important;
        box-shadow: none !important;
        margin: 24px 0 !important;
        display: block !important;
        border: none !important;
    }

    img:hover, video:hover {
        box-shadow: none !important;
        border-color: #1a73e8 !important;
    }

    /* Code blocks (if any) */
    code {
        background: #f1f3f4 !important;
        padding: 2px 8px !important;
        border-radius: 8px !important;
        font-family: 'Courier New', monospace !important;
        font-size: 14px !important;
        color: #d93025 !important;
    }

    pre {
        background: #f8f9fa !important;
        padding: 8px 16px 16px 16px !important;
        border-radius: 8px !important;
        overflow-x: auto !important;
        border-left: 4px solid #1a73e8 !important;
    }

    /* Headings */
    h1, h2, h3, h4, h5, h6 {
        color: #1a73e8 !important;
        font-weight: 700 !important;
        margin-top: 24px !important;
        margin-bottom: 16px !important;
        line-height: 1.4 !important;
    }

    h1 { font-size: 32px !important; }
    h2 { font-size: 26px !important; }
    h3 { font-size: 22px !important; }
    h4 { font-size: 19px !important; }

    /* Blockquotes */
    blockquote {
        border-left: 4px solid #1a73e8 !important;
        padding-left: 20px !important;
        margin: 20px 0 !important;
        font-style: italic !important;
        color: #5f6368 !important;
        background: #f8f9fa !important;
        padding: 16px 20px !important;
        border-radius: 8px !important;
    }

    /* Horizontal Rule */
    hr {
        border: none !important;
        height: 2px !important;
        background: linear-gradient(to right, transparent, #1a73e8, transparent) !important;
        margin: 32px 0 !important;
    }

    /* Selection */
    ::selection {
        background: #e8f0fe !important;
        color: #1a73e8 !important;
    }

    /* Highlighter styles */
    .highlighted {
        background-color: #ffeb3b !important;
        transition: background-color 0.2s ease !important;
    }

    .highlighter-btn {
        background: none !important;
        border: none !important;
        cursor: pointer !important;
        font-size: 20px !important;
        padding: 0 8px !important;
        margin-left: 8px !important;
        transition: transform 0.2s ease !important;
        vertical-align: middle !important;
    }

    .highlighter-btn:hover {
        transform: scale(1.2) !important;
    }

    .highlighter-btn.active {
        transform: scale(1.1) !important;
        filter: brightness(1.2) !important;
    }

    .highlighter-mode-active {
        cursor: text !important;
    }


    /* Right padding to avoid overlap with sidebar buttons */
    body {
        padding-right: 50px !important;
    }

    @media (max-width: 768px) {
        body {
            padding-right: 16px !important;
        }
    }

</style>




<details open>
<summary><strong>14949</strong><button class="bionic-reading-btn" onclick="toggleBionicReading(event)" title="Toggle Bionic Reading (Ctrl+B)"><span id="bionicIcon">üëÅÔ∏è</span></button><button class="highlighter-btn" onclick="toggleHighlighter(event)" title="Toggle Highlighter (Ctrl+H)"><span id="highlighterIcon">üñäÔ∏è</span></button></summary>
<p class="" id="7f28a367-fa99-4041-8688-a4e32e14c5c7">A 45-year-old previously
                                        healthy man is brought to the emergency department after being hit by a car
                                        while cycling.  The patient is hypotensive and tachycardic on arrival and has
                                        comminuted fractures of the pelvis and lower extremities.  Volume resuscitation
                                        is performed with intravenous fluids and multiple units of packed red blood
                                        cells and plasma.  Several hours later, the patient develops worsening dyspnea
                                        and hypoxia.  Chest imaging reveals new bilateral infiltrates.  Endotracheal
                                        intubation is performed for respiratory support.  Despite aggressive
                                        resuscitation, the patient dies 24 hours later.  Autopsy examination of the
                                        lungs shows protein-rich fluid within the alveolar airspaces.  Breakdown of the
                                        barrier formed by which of the following cells most likely contributed to this
                                        patient's pulmonary pathology?</p>
<table class="simple-table" id="7cdd2d6e-5940-4a55-8968-4222d9d74c3b">
<tbody>
<tr id="da013da6-9e9d-4970-b6c7-405f8635235c">
<td class="" id="IXtM">A.</td>
<td class="" id="Sf]&gt;">Alveolar macrophages</td>
<td class="" id="BM`\"></td>
</tr>
<tr id="e2379e71-e1f8-4c97-be33-4a9752dc9ad3">
<td class="" id="IXtM">B.</td>
<td class="" id="Sf]&gt;">Ciliated epithelial cells</td>
<td class="" id="BM`\"></td>
</tr>
<tr id="e21c5f38-803f-4583-af6e-1382f7c583a9">
<td class="" id="IXtM">C.</td>
<td class="" id="Sf]&gt;">Club cells (previously Clara cells)</td>
<td class="" id="BM`\"></td>
</tr>
<tr id="535e3798-6457-4b74-b280-d04be288370a">
<td class="" id="IXtM">D.</td>
<td class="" id="Sf]&gt;">Goblet cells</td>
<td class="" id="BM`\"></td>
</tr>
<tr id="07752c48-3f39-42f1-b58f-2e0722b3ebd3">
<td class="" id="IXtM">E.</td>
<td class="" id="Sf]&gt;">Type I pneumocytes</td>
<td class="" id="BM`\"></td>
</tr>
<tr id="d8d9e836-773d-46c2-b279-daeac89ea0cd">
<td class="" id="IXtM">F.</td>
<td class="" id="Sf]&gt;">Type II pneumocytes</td>
<td class="" id="BM`\"></td>
</tr>
</tbody>
</table>
<ul class="toggle" id="7d0ea1a6-7a4e-4a91-9834-4b86a1419fa8">
<li>
<details>
<summary>Submit</summary>
<table class="simple-table" id="6cbc11dd-4b11-4591-8056-3f3f3a01859e">
<tbody>
<tr id="3a75b9a0-0ddb-404f-98b2-7d49d3cd4b67">
<td class="" id="@CKj">A.</td>
<td class="" id="=HzE">Alveolar macrophages (10%)</td>
<td class="" id="l@Rf"></td>
</tr>
<tr id="b1c79d07-9628-4efa-a44e-e80c75f77e44">
<td class="" id="@CKj">B.</td>
<td class="" id="=HzE">Ciliated epithelial cells (3%)</td>
<td class="" id="l@Rf"></td>
</tr>
<tr id="7623b238-554a-4c9f-b489-8d340e367dda">
<td class="" id="@CKj">C.</td>
<td class="" id="=HzE">Club cells (previously Clara cells)
                                                                (3%)</td>
<td class="" id="l@Rf"></td>
</tr>
<tr id="278dbfad-fda6-4b24-bb62-d3472d9ad558">
<td class="" id="@CKj">D.</td>
<td class="" id="=HzE">Goblet cells (1%)</td>
<td class="" id="l@Rf"></td>
</tr>
<tr id="26547a97-efee-4869-bd26-64778baff3b3">
<td class="" id="@CKj">E.</td>
<td class="" id="=HzE">Type I pneumocytes (63%)</td>
<td class="" id="l@Rf"></td>
</tr>
<tr id="ebd82c50-78b2-4bb3-846b-872d797a23fb">
<td class="" id="@CKj">F.</td>
<td class="" id="=HzE">Type II pneumocytes (16%)</td>
<td class="" id="l@Rf"></td>
</tr>
</tbody>
</table>
<p class="" id="9479e11a-96ab-41a3-a32b-c756d54ef21f">Incorrect</p>
<p class="" id="40df9ed0-5f1f-4bf7-afa0-ac2f017b22dc">Correct answer E
                                                </p>
<p class="" id="342881eb-eb2a-4892-b1b4-2734a5901036">63%Answered
                                                    correctly</p>
<p class="" id="d28ab0cf-c109-4736-a324-f202479a0f17">14 secsTime Spent
                                                </p>
<p class="" id="7d49689e-4242-48dd-97b0-c6a49ffff538">2024Version</p>
<ul class="bulleted-list" id="bfdb6483-b2bf-44c5-af38-4bb80c5deebd">
<li style="list-style-type:disc">Explanation</li>
</ul>
<ul class="bulleted-list" id="a93a7933-df2f-4431-8c74-133aa22203e7">
<li style="list-style-type:disc"></li>
</ul>
<figure class="image" id="1fa204d4-00a9-4976-901e-92379a9bf875"><a href="https://lh7-us.googleusercontent.com/RN8RDL8CY1UmV5KlBpX4l1msAxVkLWPo9ub-rH5kEa5usCO4abYopRIjxSzDZXrDSWBhskA9G1RCajSfMl3w8bevB8GpgVgFzBs1GQyzwMOvagM3NdIpENBwr7r-Xiw2LSE2JrI58wap2ydwlaeMwfk"><img loading="lazy" src="https://lh7-us.googleusercontent.com/RN8RDL8CY1UmV5KlBpX4l1msAxVkLWPo9ub-rH5kEa5usCO4abYopRIjxSzDZXrDSWBhskA9G1RCajSfMl3w8bevB8GpgVgFzBs1GQyzwMOvagM3NdIpENBwr7r-Xiw2LSE2JrI58wap2ydwlaeMwfk" style="width:602px"/></a>
</figure>
<p class="" id="4aa37b21-e8e3-4a33-9649-bcb75e902718">This patient who
                                                    developed hypoxia, pulmonary edema (bilateral pulmonary
                                                    infiltrates), and protein-rich fluid in the alveoli had acute
                                                    respiratory distress syndrome (ARDS).  ARDS is a severe inflammatory
                                                    reaction that occurs in the lungs and results in respiratory failure
                                                    with hypoxemia and noncardiogenic pulmonary edema.  Risk factors
                                                    include sepsis, severe trauma (eg, long-bone fractures with fat
                                                    embolism, extensive tissue injury), and transfusion of blood
                                                    products, all of which can initiate pulmonary injury and trigger a
                                                    cascade of inflammation:</p>
<ul class="bulleted-list" id="fce9ef2f-a09a-4519-a5b4-83ca60e11e9f">
<li style="list-style-type:disc">In response to injury, alveolar
                                                        macrophages release multiple proinflammatory cytokines that
                                                        recruit neutrophils to the lungs (Choice A).</li>
</ul>
<ul class="bulleted-list" id="d7162fb0-1f63-4879-ab37-14443baadfbb">
<li style="list-style-type:disc">Upon arrival to pulmonary tissue,
                                                        the neutrophils release inflammatory mediators (eg, proteases,
                                                        free radicals). This increases inflammation and leads to damage
                                                        to the pulmonary endothelium and alveolar pneumocytes.</li>
</ul>
<ul class="bulleted-list" id="14a6ae22-bdcd-4981-b44c-b64cc30b93d0">
<li style="list-style-type:disc">The alveolar-capillary barrier,
                                                        which is formed by the endothelial cells and type I pneumocytes,
                                                        is then destroyed, allowing fluid and red blood cells to escape
                                                        the vascular and interstitial spaces and pour into the alveoli.
                                                        There, they combine with material from necrotic cells and form a
                                                        thick proteinaceous fluid and a hyaline membrane.</li>
</ul>
<ul class="bulleted-list" id="f557ef82-60e5-475d-ab8e-d8e500682a26">
<li style="list-style-type:disc">Destruction of type II pneumocytes,
                                                        which normally produce surfactant and proliferate in response to
                                                        injury, leads to alveolar collapse (but does not cause
                                                        destruction of the alveolar capillary barrier) (Choice F).</li>
</ul>
<p class="" id="7d3d0d67-be02-41ff-aa5a-fe5ab0921cb4">The net effect is
                                                    impaired alveolar gas exchange and respiratory failure, with
                                                    affected patients having a high mortality rate.</p>
<p class="" id="bd9ba421-bbcc-40d6-8fbb-9c2667262712">(Choices B and D) 
                                                    Ciliated epithelium and goblet cells line the larger airways. 
                                                    Goblet cells secrete mucus that traps particulate matter (eg, dust,
                                                    bacteria), while ciliated epithelial cells assist in its elimination
                                                    by sweeping the mucus up the bronchi and trachea to the pharynx,
                                                    where it is swallowed.  These cells are not prominently involved in
                                                    ARDS.</p>
<p class="" id="e572fcce-a7d7-4a83-bb74-9f63d435421e">(Choice C)  Club
                                                    cells (formerly called Clara cells) are nonciliated, secretory
                                                    constituents of the terminal respiratory epithelium.  They secrete
                                                    protein and surfactant components and help detoxify inhaled
                                                    substances (eg, tobacco smoke).  They are not prominently involved
                                                    in ARDS.</p>
<p class="" id="d5557452-9194-4480-a517-85c435b41efb">Educational
                                                    objective:</p>
<p class="" id="dab347ba-2703-49a2-8cc7-1d4f2cbd249f">Acute respiratory
                                                    distress syndrome is a severe inflammatory reaction that occurs in
                                                    the lungs and results in hypoxemia and noncardiogenic pulmonary
                                                    edema.  Pulmonary injury leads to an inflammatory response resulting
                                                    in breakdown of the capillary-alveolar barrier (created by type I
                                                    pneumocytes and endothelial cells), increased capillary
                                                    permeability, intraalveolar fluid accumulation, and hyaline membrane
                                                    formation.</p>
<p class="" id="05e407de-24d6-4c4d-9e37-e95bd1e4d64d">Pathophysiology
                                                </p>
<p class="" id="e525cd48-0d02-4041-9a1e-f1214a14b338">Subject</p>
<p class="" id="1d46ed6b-9b45-43c9-8dbc-80454f080d1a">Pulmonary &amp;
                                                    Critical Care</p>
<p class="" id="1bc52057-8868-42a9-8ccd-937f349ae391">System</p>
<p class="" id="f8214923-1193-419c-926d-f34a97db45df">Respiratory mucosa
                                                </p>
<p class="" id="5380cc36-d105-41eb-a30b-3a4ea280b594">Topic</p>
<p class="" id="f43e5a10-b3f1-4ef3-9cf1-f8f7c87b0492">Copyright ¬©
                                                    UWorld. All rights reserved.</p>
<p class="" id="65d1001f-d261-4ee5-a8de-ba830156337e">‚ùåüÖ±Ô∏è1üÖ∞Ô∏è1üîç1 ~üïí1
                                                    sec</p>
</details>
</li>
</ul>
</details>


















<style>
.bionic-reading-btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    height: 40px;
    background: rgba(255, 255, 255, 0.2);
    border: 2px solid rgba(255, 255, 255, 0.3);
    border-radius: 8px;
    color: white;
    font-size: 20px;
    cursor: pointer;
    transition: all 0.3s;
    margin-left: auto;
    flex-shrink: 0;
}

.bionic-reading-btn:hover {
    background: rgba(255, 255, 255, 0.35);
    border-color: rgba(255, 255, 255, 0.5);
    transform: scale(1.1);
}

.bionic-reading-btn.active {
    background: rgba(52, 168, 83, 0.4);
    border-color: rgba(52, 168, 83, 0.6);
}

.bionic-reading-btn.active:hover {
    background: rgba(52, 168, 83, 0.5);
}

summary {
    display: flex !important;
    align-items: center !important;
    gap: 12px !important;
}

    /* Highlighter styles */
    .highlighted {
        background-color: #ffeb3b !important;
        transition: background-color 0.2s ease !important;
    }

    .highlighter-btn {
        background: none !important;
        border: none !important;
        cursor: pointer !important;
        font-size: 20px !important;
        padding: 0 8px !important;
        margin-left: 8px !important;
        transition: transform 0.2s ease !important;
        vertical-align: middle !important;
    }

    .highlighter-btn:hover {
        transform: scale(1.2) !important;
    }

    .highlighter-btn.active {
        transform: scale(1.1) !important;
        filter: brightness(1.2) !important;
    }

    .highlighter-mode-active {
        cursor: text !important;
    }


    /* Right padding to avoid overlap with sidebar buttons */
    body {
        padding-right: 50px !important;
    }

    @media (max-width: 768px) {
        body {
            padding-right: 16px !important;
        }
    }


    


    

    /* Adjust table padding to make room for radio button */
    


    /* Clickable Answer Choices */
    table tr.answer-choice {
        cursor: pointer !important;
        transition: all 0.3s ease !important;
    }

    table tr.answer-choice:hover {
        background: #f8f9fa !important;
    }

    table tr.answer-choice td:first-child {
        position: relative !important;
        padding-left: 35px !important;
    }

    table tr.answer-choice td:first-child::before {
        content: '';
        position: absolute;
        left: 8px;
        top: 50%;
        transform: translateY(-50%);
        width: 16px;
        height: 16px;
        border: 2px solid #999;
        border-radius: 50%;
        background: white;
        transition: all 0.2s ease;
        box-sizing: border-box;
    }

    table tr.answer-choice.selected td:first-child::before {
        border-color: #1a73e8;
        border-width: 5px;
    }

    table tr.answer-choice.selected {
        background: #e8f4ff !important;
    }

    table tr.answer-choice.selected td:first-child {
        color: #1a73e8 !important;
        font-weight: 600 !important;
    }

</style>



<script>
let bionicEnabled = false;
const originalContent = {};

function toggleBionicReading(event) {
    if (event) {
        event.preventDefault();
        event.stopPropagation();
    }

    bionicEnabled = !bionicEnabled;
    const btn = document.querySelector('.bionic-reading-btn');
    const icon = document.getElementById('bionicIcon');

    if (bionicEnabled) {
        btn.classList.add('active');
        icon.textContent = '‚úÖ';
        applyBionicReading();
    } else {
        btn.classList.remove('active');
        icon.textContent = 'üëÅÔ∏è';
        restoreOriginalText();
    }
}

function applyBionicReading() {
    // Seleciona todos os elementos de texto, EXCETO summary e buttons
    const textElements = document.querySelectorAll('p:not(summary p):not(button p), td:not(summary td):not(button td), li:not(summary li):not(button li)');

    textElements.forEach((element, index) => {
        // Ignora elementos que cont√™m outros elementos complexos
        if (element.querySelector('p, td, li, h1, h2, h3, h4, h5, h6, button, summary')) {
            return;
        }

        // Ignora se o elemento est√° dentro de um summary ou button
        if (element.closest('summary') || element.closest('button') || element.closest('.bionic-reading-btn')) {
            return;
        }

        // Salva o conte√∫do original
        if (!originalContent[index]) {
            originalContent[index] = {
                element: element,
                html: element.innerHTML
            };
        }

        // Aplica Bionic Reading
        const bionicText = convertToBionic(element.textContent);
        element.innerHTML = bionicText;
    });
}

function restoreOriginalText() {
    // Restaura o conte√∫do original
    Object.values(originalContent).forEach(item => {
        item.element.innerHTML = item.html;
    });
}

function convertToBionic(text) {
    // Divide o texto em palavras, mantendo pontua√ß√£o
    const words = text.split(/(\s+|[.,;:!?()""''\-‚Äì‚Äî])/);

    const bionicWords = words.map(word => {
        // Ignora espa√ßos e pontua√ß√£o
        if (word.match(/^\s+$/) || word.match(/^[.,;:!?()""''\-‚Äì‚Äî]+$/)) {
            return word;
        }

        // Ignora palavras muito curtas (1-2 letras)
        if (word.length <= 2) {
            return word;
        }

        // Determina quantas letras deixar em negrito (metade da palavra, arredondado para cima)
        const boldLength = Math.ceil(word.length / 2);

        // Separa a parte em negrito da parte normal
        const boldPart = word.substring(0, boldLength);
        const normalPart = word.substring(boldLength);

        // Retorna com a primeira parte em negrito
        return `<strong style="font-weight: 700 !important; color: inherit !important; background: none !important; padding: 0 !important;">${boldPart}</strong>${normalPart}`;
    });

    return bionicWords.join('');
}

// Adiciona atalho de teclado (Ctrl+B ou Cmd+B)
document.addEventListener('keydown', function(e) {
    if ((e.ctrlKey || e.metaKey) && e.key === 'b') {
        e.preventDefault();
        toggleBionicReading();
    }
});
</script>

<script>
    let highlighterActive = false;
    let questionHighlights = {};

    // Get question ID from the first summary strong tag
    function getQuestionId() {
        const firstSummary = document.querySelector('summary strong');
        return firstSummary ? firstSummary.textContent.trim() : '1';
    }

    // Load highlights from localStorage
    function loadHighlights() {
        const questionId = getQuestionId();
        const stored = localStorage.getItem('highlights_' + questionId);
        if (stored) {
            questionHighlights = JSON.parse(stored);
            applyStoredHighlights();
        }
    }

    // Save highlights to localStorage
    function saveHighlights() {
        const questionId = getQuestionId();
        localStorage.setItem('highlights_' + questionId, JSON.stringify(questionHighlights));
    }

    // Apply stored highlights
    function applyStoredHighlights() {
        Object.keys(questionHighlights).forEach(key => {
            const element = document.querySelector(`[data-highlight-id="${key}"]`);
            if (element && questionHighlights[key]) {
                element.classList.add('highlighted');
            }
        });
    }

    // Toggle highlighter mode
    function toggleHighlighter(event) {
        event.stopPropagation();
        highlighterActive = !highlighterActive;

        const btn = event.target.closest('.highlighter-btn');
        const icon = btn.querySelector('#highlighterIcon');

        if (highlighterActive) {
            btn.classList.add('active');
            icon.textContent = 'üñçÔ∏è';
            document.body.classList.add('highlighter-mode-active');
        } else {
            btn.classList.remove('active');
            icon.textContent = 'üñäÔ∏è';
            document.body.classList.remove('highlighter-mode-active');
        }
    }

    // Clear all highlights for this question
    function clearHighlights() {
        const questionId = getQuestionId();
        questionHighlights = {};
        localStorage.removeItem('highlights_' + questionId);
        document.querySelectorAll('.highlighted').forEach(el => {
            el.classList.remove('highlighted');
        });
    }

    // Handle text selection and highlighting
    document.addEventListener('mouseup', function(e) {
        if (!highlighterActive) return;

        const selection = window.getSelection();
        if (!selection.toString().trim()) return;

        const range = selection.getRangeAt(0);
        const container = range.commonAncestorContainer;

        // Only highlight text in paragraphs, not in buttons or other elements
        const paragraph = container.nodeType === 3 ? container.parentElement : container;
        if (paragraph.tagName !== 'P' && paragraph.tagName !== 'LI' && paragraph.tagName !== 'TD') {
            return;
        }

        // Create highlight span
        const span = document.createElement('span');
        span.classList.add('highlighted');

        // Generate unique ID for this highlight
        const highlightId = 'hl-' + Date.now() + '-' + Math.random().toString(36).substr(2, 9);
        span.setAttribute('data-highlight-id', highlightId);

        try {
            range.surroundContents(span);
            questionHighlights[highlightId] = true;
            saveHighlights();
        } catch (e) {
            console.log('Could not highlight selection');
        }

        selection.removeAllRanges();
    });

    // Load highlights when page loads
    window.addEventListener('load', loadHighlights);

    // Keyboard shortcut: Ctrl+H to toggle highlighter
    document.addEventListener('keydown', function(e) {
        if (e.ctrlKey && e.key === 'h') {
            e.preventDefault();
            const btn = document.querySelector('.highlighter-btn');
            if (btn) {
                toggleHighlighter({target: btn, stopPropagation: () => {}});
            }
        }
        // Ctrl+Shift+H to clear all highlights
        if (e.ctrlKey && e.shiftKey && e.key === 'H') {
            e.preventDefault();
            if (confirm('Clear all highlights for this question?')) {
                clearHighlights();
            }
        }
    });
</script>





<script>
(function() {
    // Get question ID from summary
    function getQuestionId() {
        const firstSummary = document.querySelector('summary strong');
        return firstSummary ? firstSummary.textContent.trim() : '1';
    }

    // Communicate with parent window (if in iframe)
    function notifyParent(choice) {
        if (window.parent && window.parent !== window) {
            window.parent.postMessage({
                type: 'choiceSelected',
                questionId: getQuestionId(),
                choice: choice
            }, '*');
        }
    }

    // Load saved choice from parent or localStorage
    function loadSavedChoice() {
        const questionId = getQuestionId();

        // Try to get from localStorage first
        const saved = localStorage.getItem('choice_q' + questionId);
        if (saved) {
            selectChoice(saved, false);
        }

        // Ask parent for saved choice (if in iframe)
        if (window.parent && window.parent !== window) {
            window.parent.postMessage({
                type: 'getChoice',
                questionId: questionId
            }, '*');
        }
    }

    // Listen for messages from parent
    window.addEventListener('message', function(event) {
        if (event.data.type === 'setChoice' && event.data.questionId === getQuestionId()) {
            selectChoice(event.data.choice, false);
        }
    });

    // Select a choice
    function selectChoice(choice, notify = true) {
        if (!choice) return;

        const questionId = getQuestionId();

        // Remove previous selection
        document.querySelectorAll('tr.answer-choice').forEach(row => {
            row.classList.remove('selected');
        });

        // Add selection to clicked choice
        const choiceRow = document.querySelector(`tr.answer-choice[data-choice="${choice}"]`);
        if (choiceRow) {
            choiceRow.classList.add('selected');

            // Save to localStorage
            localStorage.setItem('choice_q' + questionId, choice);

            // Notify parent (if in iframe)
            if (notify) {
                notifyParent(choice);
            }
        }
    }

    // Initialize answer choices
    function initializeChoices() {
        // Find all answer choice rows (A, B, C, D, E, F, etc.)
        const choicePattern = /^[A-Z]\.$/;
        const tables = document.querySelectorAll('table.simple-table');

        tables.forEach(table => {
            const rows = table.querySelectorAll('tr');
            rows.forEach(row => {
                const firstCell = row.querySelector('td:first-child');
                if (firstCell && choicePattern.test(firstCell.textContent.trim())) {
                    const choice = firstCell.textContent.trim().replace('.', '');
                    row.classList.add('answer-choice');
                    row.setAttribute('data-choice', choice);
                    row.style.position = 'relative';

                    // Add click handler
                    row.addEventListener('click', function(e) {
                        // Don't trigger if clicking inside a link or button
                        if (e.target.tagName === 'A' || e.target.closest('a')) return;

                        // Toggle selection
                        if (this.classList.contains('selected')) {
                            this.classList.remove('selected');
                            const questionId = getQuestionId();
                            localStorage.removeItem('choice_q' + questionId);
                            notifyParent('');
                        } else {
                            selectChoice(choice);
                        }
                    });
                }
            });
        });

        // Load saved choice after a short delay
        setTimeout(loadSavedChoice, 100);
    }

    // Run when page loads
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initializeChoices);
    } else {
        initializeChoices();
    }
})();
</script>
