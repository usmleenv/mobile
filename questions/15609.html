
<style>
    * {
        box-sizing: border-box !important;
    }

    body {
        font-family: 'Inter', 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif !important;
        line-height: 1.9 !important;
        color: #1f1f1f !important;
        max-width: none !important;
        margin: 0 !important;
        padding: 8px 16px 16px 16px !important;
        background: #ffffff !important;
        font-size: 16.5px !important;
    }

    p {
        margin-bottom: 20px !important;
        font-size: 16.5px !important;
        line-height: 1.95 !important;
        color: #1f1f1f !important;
        font-weight: 400 !important;
    }

    strong, b {
        color: #1a73e8 !important;
        font-weight: 700 !important;
        background: rgba(26, 115, 232, 0.08) !important;
        padding: 2px 6px !important;
        border-radius: 8px !important;
    }

    /* Details/Summary (collapsible sections) */
    details {
        background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%) !important;
        border-radius: 8px !important;
        padding: 24px 28px !important;
        margin: 24px 0 !important;
        border: none;
        box-shadow: none !important;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
    }

    details:hover {
        border-color: #1a73e8 !important;
        box-shadow: none !important;
        transform: translateY(-2px) !important;
    }

    details[open] {
        background: #ffffff !important;
        border-color: #1a73e8 !important;
        box-shadow: none !important;
    }

    summary {
        cursor: pointer !important;
        font-weight: 800 !important;
        color: #ffffff !important;
        font-size: 20px !important;
        padding: 16px 24px !important;
        border-radius: 8px !important;
        background: linear-gradient(135deg, #1a73e8 0%, #1557b0 100%) !important;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
        display: flex !important;
        align-items: center !important;
        user-select: none !important;
        box-shadow: none !important;
        letter-spacing: 0.5px !important;
    }

    summary:hover {
        background: linear-gradient(135deg, #1557b0 0%, #0d47a1 100%) !important;
        transform: translateX(6px) scale(1.02) !important;
        box-shadow: none !important;
    }

    summary:active {
        transform: translateX(4px) scale(0.99) !important;
    }

    summary::marker {
        color: rgba(255, 255, 255, 0.9) !important;
        font-size: 1.3em !important;
    }

    summary strong {
        background: rgba(255, 255, 255, 0.2) !important;
        color: #ffffff !important;
        padding: 4px 12px !important;
        border-radius: 8px !important;
        margin-left: 8px !important;
        font-size: 19px !important;
        letter-spacing: 1px !important;
    }

    /* Tables - Premium Design */
    table {
        width: 100% !important;
        border-collapse: separate !important;
        border-spacing: 0 !important;
        margin: 28px 0 !important;
        border-radius: 8px !important;
        overflow: hidden !important;
        box-shadow: none !important;
        border: none !important;
        background: #ffffff !important;
    }

    table.simple-table {
        background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%) !important;
    }

    table tr {
        transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1) !important;
        position: relative !important;
    }

    table tr:nth-child(odd) {
        background: rgba(248, 249, 250, 0.5) !important;
    }

    table tr:nth-child(even) {
        background: rgba(255, 255, 255, 0.8) !important;
    }

    table tr:hover {
        background: linear-gradient(90deg, #e8f0fe 0%, #f1f8ff 100%) !important;
        transform: translateX(4px) scale(1.01) !important;
        box-shadow: none !important;
        z-index: 1 !important;
    }

    table td {
        padding: 18px 24px !important;
        border-bottom: 1px solid rgba(232, 234, 237, 0.6) !important;
        font-size: 16.5px !important;
        line-height: 1.7 !important;
        color: #1f1f1f !important;
        vertical-align: middle !important;
    }

    table tr:last-child td {
        border-bottom: none !important;
    }

    /* First column (A, B, C, D, E) */
    table td:first-child {
        font-weight: 800 !important;
        color: #ffffff !important;
        width: 52px !important;
        text-align: center !important;
        font-size: 18px !important;
        background: linear-gradient(135deg, #1a73e8 0%, #1557b0 100%) !important;
        border-right: 3px solid #1557b0 !important;
        position: relative !important;
        letter-spacing: 0.5px !important;
    }

    table tr:hover td:first-child {
        background: linear-gradient(135deg, #1557b0 0%, #0d47a1 100%) !important;
        box-shadow: none !important;
    }

    /* Second column (content) */
    table td:nth-child(2) {
        font-weight: 500 !important;
        padding-left: 28px !important;
    }

    /* Third column (empty - hide it) */
    table td:last-child:empty {
        display: none !important;
    }

    /* Lists */
    ul, ol {
        margin: 16px 0 !important;
        padding-left: 32px !important;
    }

    li {
        margin: 10px 0 !important;
        line-height: 1.8 !important;
        color: #1f1f1f !important;
    }

    ul.bulleted-list li {
        position: relative !important;
        padding-left: 8px !important;
    }

    ul.toggle {
        list-style: none !important;
        padding-left: 0 !important;
    }

    /* Links */
    a {
        color: #1a73e8 !important;
        text-decoration: none !important;
        font-weight: 600 !important;
        border-bottom: 2px solid transparent !important;
        transition: all 0.2s !important;
    }

    a:hover {
        border-bottom-color: #1a73e8 !important;
        background: rgba(26,115,232,0.08) !important;
        padding: 2px 4px !important;
        border-radius: 8px !important;
    }

    /* Images & Media */
    img, video {
        max-width: none !important;
        height: auto !important;
        border-radius: 8px !important;
        box-shadow: none !important;
        margin: 24px 0 !important;
        display: block !important;
        border: none !important;
    }

    img:hover, video:hover {
        box-shadow: none !important;
        border-color: #1a73e8 !important;
    }

    /* Code blocks (if any) */
    code {
        background: #f1f3f4 !important;
        padding: 2px 8px !important;
        border-radius: 8px !important;
        font-family: 'Courier New', monospace !important;
        font-size: 14px !important;
        color: #d93025 !important;
    }

    pre {
        background: #f8f9fa !important;
        padding: 8px 16px 16px 16px !important;
        border-radius: 8px !important;
        overflow-x: auto !important;
        border-left: 4px solid #1a73e8 !important;
    }

    /* Headings */
    h1, h2, h3, h4, h5, h6 {
        color: #1a73e8 !important;
        font-weight: 700 !important;
        margin-top: 24px !important;
        margin-bottom: 16px !important;
        line-height: 1.4 !important;
    }

    h1 { font-size: 32px !important; }
    h2 { font-size: 26px !important; }
    h3 { font-size: 22px !important; }
    h4 { font-size: 19px !important; }

    /* Blockquotes */
    blockquote {
        border-left: 4px solid #1a73e8 !important;
        padding-left: 20px !important;
        margin: 20px 0 !important;
        font-style: italic !important;
        color: #5f6368 !important;
        background: #f8f9fa !important;
        padding: 16px 20px !important;
        border-radius: 8px !important;
    }

    /* Horizontal Rule */
    hr {
        border: none !important;
        height: 2px !important;
        background: linear-gradient(to right, transparent, #1a73e8, transparent) !important;
        margin: 32px 0 !important;
    }

    /* Selection */
    ::selection {
        background: #e8f0fe !important;
        color: #1a73e8 !important;
    }

    /* Highlighter styles */
    .highlighted {
        background-color: #ffeb3b !important;
        transition: background-color 0.2s ease !important;
    }

    .highlighter-btn {
        background: none !important;
        border: none !important;
        cursor: pointer !important;
        font-size: 20px !important;
        padding: 0 8px !important;
        margin-left: 8px !important;
        transition: transform 0.2s ease !important;
        vertical-align: middle !important;
    }

    .highlighter-btn:hover {
        transform: scale(1.2) !important;
    }

    .highlighter-btn.active {
        transform: scale(1.1) !important;
        filter: brightness(1.2) !important;
    }

    .highlighter-mode-active {
        cursor: text !important;
    }


    /* Right padding to avoid overlap with sidebar buttons */
    body {
        padding-right: 50px !important;
    }

    @media (max-width: 768px) {
        body {
            padding-right: 16px !important;
        }
    }

</style>




<details open>
<summary><strong>15609</strong><button class="bionic-reading-btn" onclick="toggleBionicReading(event)" title="Toggle Bionic Reading (Ctrl+B)"><span id="bionicIcon">üëÅÔ∏è</span></button><button class="highlighter-btn" onclick="toggleHighlighter(event)" title="Toggle Highlighter (Ctrl+H)"><span id="highlighterIcon">üñäÔ∏è</span></button></summary>
<p class="" id="147aebda-7b5d-440e-986e-891424f8fdf0">A 6-year-old boy is brought to
                                        the office by his mother due to behavioral difficulties at school.  His teacher
                                        has said, "He interrupts the class, doesn't listen, and cannot sit
                                        still for more than a few minutes."  He has been sent home on a few
                                        occasions for hitting other children and taking their toys.  The patient was
                                        adopted at age 6 months and his birth history is unknown.  He runs around the
                                        office playing with various toys and is easily distracted.  Vital signs are
                                        within normal limits.  Weight and height are tracking on the 10th percentile,
                                        and head circumference is below the 5th percentile for age and sex.  Physical
                                        examination reveals short palpebral fissures, a smooth philtrum, thin upper lip,
                                        and difficulty with both gross and fine motor coordination.  Which of the
                                        following is the likely cause of this patient's condition?</p>
<table class="simple-table" id="b7b12c45-edf6-46cf-ad51-fda568d34c19">
<tbody>
<tr id="a0836400-853d-46cf-8228-d4d68b9f9053">
<td class="" id="k&gt;Y?">A.</td>
<td class="" id="Net{">CGG trinucleotide repeat</td>
<td class="" id="r~hs"></td>
</tr>
<tr id="de599116-1e0e-4b56-897b-dd9366582d32">
<td class="" id="k&gt;Y?">B.</td>
<td class="" id="Net{">Intrauterine alcohol exposure</td>
<td class="" id="r~hs"></td>
</tr>
<tr id="da4271f2-d6a8-4059-83fe-714954d9cf10">
<td class="" id="k&gt;Y?">C.</td>
<td class="" id="Net{">Intrauterine cocaine exposure</td>
<td class="" id="r~hs"></td>
</tr>
<tr id="c0aa1431-5d19-46cd-bd65-fc653d2ed941">
<td class="" id="k&gt;Y?">D.</td>
<td class="" id="Net{">Intrauterine rubella exposure</td>
<td class="" id="r~hs"></td>
</tr>
<tr id="4804f82f-8e24-4069-82ac-20cd11216d3f">
<td class="" id="k&gt;Y?">E.</td>
<td class="" id="Net{">Trisomy 18</td>
<td class="" id="r~hs"></td>
</tr>
<tr id="06587653-0e66-4d81-9408-a70ede2e5da4">
<td class="" id="k&gt;Y?">F.</td>
<td class="" id="Net{">Trisomy 21</td>
<td class="" id="r~hs"></td>
</tr>
</tbody>
</table>
<ul class="toggle" id="c6913dd8-3481-4662-be5b-8be0f4316235">
<li>
<details>
<summary>Submit</summary>
<table class="simple-table" id="723ce4bf-385a-4b78-9c17-b92fa0e9e918">
<tbody>
<tr id="1b58573c-084a-456e-b916-9a1a917b5e77">
<td class="" id="jK?V">A.</td>
<td class="" id="ip`t">CGG trinucleotide repeat (2%)</td>
<td class="" id="vCNw"></td>
</tr>
<tr id="e3b2db10-31a1-4cb8-8f94-1aa72b83e53e">
<td class="" id="jK?V">B.</td>
<td class="" id="ip`t">Intrauterine alcohol exposure (81%)
                                                            </td>
<td class="" id="vCNw"></td>
</tr>
<tr id="c53807c7-b871-4ddf-8c39-c4efe1e12120">
<td class="" id="jK?V">C.</td>
<td class="" id="ip`t">Intrauterine cocaine exposure (2%)
                                                            </td>
<td class="" id="vCNw"></td>
</tr>
<tr id="01e24a7a-cf76-40a3-bef0-5662245aefbf">
<td class="" id="jK?V">D.</td>
<td class="" id="ip`t">Intrauterine rubella exposure (0%)
                                                            </td>
<td class="" id="vCNw"></td>
</tr>
<tr id="3174d7e5-6dd0-47db-ae5d-a772e98f2115">
<td class="" id="jK?V">E.</td>
<td class="" id="ip`t">Trisomy 18 (2%)</td>
<td class="" id="vCNw"></td>
</tr>
<tr id="0a097a25-0f6e-4bbd-a11d-7fbdf85a2a99">
<td class="" id="jK?V">F.</td>
<td class="" id="ip`t">Trisomy 21 (9%)</td>
<td class="" id="vCNw"></td>
</tr>
</tbody>
</table>
<p class="" id="cb606219-bc68-4eb7-a4db-2bca2ba669f0">Incorrect</p>
<p class="" id="54fdfa1c-ee9c-45f3-9a97-2acec9bbc611">Correct answer B
                                                </p>
<p class="" id="cca8ffae-5fb4-4f5f-a7a1-27af773a606a">81%Answered
                                                    correctly</p>
<p class="" id="ffc7aa98-0274-4d98-aa2e-aaa071a4497d">15 secsTime Spent
                                                </p>
<p class="" id="68e0596f-4e3a-405f-8136-03d4512e6acb">2024Version</p>
<ul class="bulleted-list" id="f9129cb7-3e0a-4243-8331-110491a31ba9">
<li style="list-style-type:disc">Explanation</li>
</ul>
<ul class="bulleted-list" id="2c27b1b6-5eb9-412d-a2cd-df64a71563ba">
<li style="list-style-type:disc"></li>
</ul>
<figure class="image" id="543b7018-d16c-4021-8259-8c41d6814616"><a href="https://lh7-us.googleusercontent.com/Dve1sazYdNNwGRmTPVox_6hPrmPuaK87rtpBAG7x6tULkJPJsC8CXgfu77j6AVRV8eRWUTg68FSAvRmUXQ-PzMS55K6eKy-n3euUQOSrF18khnYxoqdFek4xkHgbMfd-LEClFplebSPw95nArNI2NKY"><img loading="lazy" src="https://lh7-us.googleusercontent.com/Dve1sazYdNNwGRmTPVox_6hPrmPuaK87rtpBAG7x6tULkJPJsC8CXgfu77j6AVRV8eRWUTg68FSAvRmUXQ-PzMS55K6eKy-n3euUQOSrF18khnYxoqdFek4xkHgbMfd-LEClFplebSPw95nArNI2NKY" style="width:602px"/></a>
</figure>
<p class="" id="b60db596-23ba-4501-9524-55d11308c862">This child's
                                                    behavioral difficulties (distractibility, hyperactivity, hitting),
                                                    growth retardation, poor coordination, and facial anomalies are
                                                    suggestive of fetal alcohol syndrome (FAS).  Alcohol is a teratogen
                                                    that affects multiple organ systems (eg, heart, joints, kidneys,
                                                    visual systems, auditory systems), most characteristically the CNS. 
                                                    Features of FAS include facial dysmorphism (short palpebral
                                                    fissures, thin upper lip, smooth philtrum), growth retardation, and
                                                    CNS involvement (structural and/or neurobehavioral).</p>
<p class="" id="8538d0af-cb46-489f-8f94-7f5865b1f67c">Intrauterine
                                                    alcohol exposure can cause reduction in the volume of the caudate,
                                                    striatum, thalamus, and cerebellum, resulting in abnormal reflexes,
                                                    tone, and coordination.  A decrease in the volume of the frontal
                                                    lobe and dysfunction of the amygdala contribute to deficits in
                                                    executive functioning, impulse control, and emotion regulation. 
                                                    Other neurobehavioral manifestations include cognitive impairment,
                                                    learning disabilities, and social skill deficits.</p>
<p class="" id="79aa44fd-71e1-4c19-9e8c-e91c4dc72793">(Choice A) 
                                                    Fragile X syndrome is caused by unstable CGG
                                                    (cytosine-guanine-guanine) trinucleotide repeats on the X
                                                    chromosome.  Features include intellectual disability; a long,
                                                    narrow face; large, protruding ears; macrocephaly; and
                                                    macroorchidism.</p>
<p class="" id="19870b7b-075f-47a6-82eb-2db2210294e0">(Choice C) 
                                                    Cocaine exposure in utero is associated with hypertonia and tremors
                                                    in neonates and impairments in attention, language development, and
                                                    behavioral regulation in school-aged children.  It would not cause
                                                    the facial anomalies seen in this patient.</p>
<p class="" id="1ee68489-142c-41f3-af96-adf3f79d7691">(Choice D) 
                                                    Rubella exposure in utero is associated with congenital heart
                                                    defects, hearing impairment, and ocular abnormalities (eg, glaucoma,
                                                    cataracts, retinopathy).</p>
<p class="" id="b6028da8-b0ef-4e26-bd10-614a68891340">(Choice E) 
                                                    Trisomy 18 (Edwards syndrome) is associated with a small mouth and
                                                    prominent forehead; pointy ears; and flexed, overlapping fingers. 
                                                    Horseshoe kidney and congenital heart defects may be present. 
                                                    Survival beyond one year of age is uncommon and associated with
                                                    severe intellectual disability.</p>
<p class="" id="847ce9b4-ec7c-4abc-ba68-e14507c629f5">(Choice F)  Facial
                                                    features in trisomy 21 (Down syndrome) include epicanthal folds,
                                                    upslanting palpebral fissures, brachycephaly (back of the head
                                                    symmetrically flattened), flat nasal bridge, and protruding tongue. 
                                                    It is associated with varying degrees of intellectual disability.
                                                </p>
<p class="" id="39a9a201-ce88-42aa-bc7e-45a7a72ecfd0">Educational
                                                    objective:</p>
<p class="" id="aebbda1e-8fe3-407f-a28b-6bcd3396a8a1">Typical features
                                                    of fetal alcohol syndrome include facial dysmorphism (short
                                                    palpebral fissures, thin upper lip, smooth philtrum), growth
                                                    retardation, neurological abnormalities, and behavioral
                                                    difficulties.</p>
<p class="" id="22443563-fc07-4765-b910-611a67ed460d">References</p>
<ul class="bulleted-list" id="3a6db24b-c268-4363-b6c6-2b85accef7fe">
<li style="list-style-type:disc"><a href="http://www.ncbi.nlm.nih.gov/pubmed/29094891">Fetal
                                                            alcohol syndrome and fetal alcohol spectrum disorders.</a>
</li>
</ul>
<ul class="bulleted-list" id="fa929994-dffa-4da6-bdff-688a79e4efe3">
<li style="list-style-type:disc"><a href="http://www.ncbi.nlm.nih.gov/pubmed/27729236">A review
                                                            of the physical features of the fetal alcohol spectrum
                                                            disorders.</a></li>
</ul>
<p class="" id="d55c015e-727a-456b-a405-56798ad5dbf0">Pathophysiology
                                                </p>
<p class="" id="46e2b477-bf94-4671-8ef3-e90bb2b9a474">Subject</p>
<p class="" id="6a8110d0-ac16-4ad9-9eaf-7621bade0847">
                                                    Psychiatric/Behavioral &amp; Substance Use Disorder</p>
<p class="" id="adc9acfe-732f-4058-a1dc-b7a759e457a6">System</p>
<p class="" id="53ac7536-9360-4b63-8dc0-b4fc514aeed3">Fetal alcohol
                                                    syndrome</p>
<p class="" id="e8f4ae8f-f49f-439a-910d-b9e47c708ad7">Topic</p>
<p class="" id="8626d6de-8b32-4913-b8df-b40acc5a4474">Copyright ¬©
                                                    UWorld. All rights reserved.</p>
</details>
</li>
</ul>
</details>


















<style>
.bionic-reading-btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    height: 40px;
    background: rgba(255, 255, 255, 0.2);
    border: 2px solid rgba(255, 255, 255, 0.3);
    border-radius: 8px;
    color: white;
    font-size: 20px;
    cursor: pointer;
    transition: all 0.3s;
    margin-left: auto;
    flex-shrink: 0;
}

.bionic-reading-btn:hover {
    background: rgba(255, 255, 255, 0.35);
    border-color: rgba(255, 255, 255, 0.5);
    transform: scale(1.1);
}

.bionic-reading-btn.active {
    background: rgba(52, 168, 83, 0.4);
    border-color: rgba(52, 168, 83, 0.6);
}

.bionic-reading-btn.active:hover {
    background: rgba(52, 168, 83, 0.5);
}

summary {
    display: flex !important;
    align-items: center !important;
    gap: 12px !important;
}

    /* Highlighter styles */
    .highlighted {
        background-color: #ffeb3b !important;
        transition: background-color 0.2s ease !important;
    }

    .highlighter-btn {
        background: none !important;
        border: none !important;
        cursor: pointer !important;
        font-size: 20px !important;
        padding: 0 8px !important;
        margin-left: 8px !important;
        transition: transform 0.2s ease !important;
        vertical-align: middle !important;
    }

    .highlighter-btn:hover {
        transform: scale(1.2) !important;
    }

    .highlighter-btn.active {
        transform: scale(1.1) !important;
        filter: brightness(1.2) !important;
    }

    .highlighter-mode-active {
        cursor: text !important;
    }


    /* Right padding to avoid overlap with sidebar buttons */
    body {
        padding-right: 50px !important;
    }

    @media (max-width: 768px) {
        body {
            padding-right: 16px !important;
        }
    }

</style>



<script>
let bionicEnabled = false;
const originalContent = {};

function toggleBionicReading(event) {
    if (event) {
        event.preventDefault();
        event.stopPropagation();
    }

    bionicEnabled = !bionicEnabled;
    const btn = document.querySelector('.bionic-reading-btn');
    const icon = document.getElementById('bionicIcon');

    if (bionicEnabled) {
        btn.classList.add('active');
        icon.textContent = '‚úÖ';
        applyBionicReading();
    } else {
        btn.classList.remove('active');
        icon.textContent = 'üëÅÔ∏è';
        restoreOriginalText();
    }
}

function applyBionicReading() {
    // Seleciona todos os elementos de texto, EXCETO summary e buttons
    const textElements = document.querySelectorAll('p:not(summary p):not(button p), td:not(summary td):not(button td), li:not(summary li):not(button li)');

    textElements.forEach((element, index) => {
        // Ignora elementos que cont√™m outros elementos complexos
        if (element.querySelector('p, td, li, h1, h2, h3, h4, h5, h6, button, summary')) {
            return;
        }

        // Ignora se o elemento est√° dentro de um summary ou button
        if (element.closest('summary') || element.closest('button') || element.closest('.bionic-reading-btn')) {
            return;
        }

        // Salva o conte√∫do original
        if (!originalContent[index]) {
            originalContent[index] = {
                element: element,
                html: element.innerHTML
            };
        }

        // Aplica Bionic Reading
        const bionicText = convertToBionic(element.textContent);
        element.innerHTML = bionicText;
    });
}

function restoreOriginalText() {
    // Restaura o conte√∫do original
    Object.values(originalContent).forEach(item => {
        item.element.innerHTML = item.html;
    });
}

function convertToBionic(text) {
    // Divide o texto em palavras, mantendo pontua√ß√£o
    const words = text.split(/(\s+|[.,;:!?()""''\-‚Äì‚Äî])/);

    const bionicWords = words.map(word => {
        // Ignora espa√ßos e pontua√ß√£o
        if (word.match(/^\s+$/) || word.match(/^[.,;:!?()""''\-‚Äì‚Äî]+$/)) {
            return word;
        }

        // Ignora palavras muito curtas (1-2 letras)
        if (word.length <= 2) {
            return word;
        }

        // Determina quantas letras deixar em negrito (metade da palavra, arredondado para cima)
        const boldLength = Math.ceil(word.length / 2);

        // Separa a parte em negrito da parte normal
        const boldPart = word.substring(0, boldLength);
        const normalPart = word.substring(boldLength);

        // Retorna com a primeira parte em negrito
        return `<strong style="font-weight: 700 !important; color: inherit !important; background: none !important; padding: 0 !important;">${boldPart}</strong>${normalPart}`;
    });

    return bionicWords.join('');
}

// Adiciona atalho de teclado (Ctrl+B ou Cmd+B)
document.addEventListener('keydown', function(e) {
    if ((e.ctrlKey || e.metaKey) && e.key === 'b') {
        e.preventDefault();
        toggleBionicReading();
    }
});
</script>

<script>
    let highlighterActive = false;
    let questionHighlights = {};

    // Get question ID from the first summary strong tag
    function getQuestionId() {
        const firstSummary = document.querySelector('summary strong');
        return firstSummary ? firstSummary.textContent.trim() : '1';
    }

    // Load highlights from localStorage
    function loadHighlights() {
        const questionId = getQuestionId();
        const stored = localStorage.getItem('highlights_' + questionId);
        if (stored) {
            questionHighlights = JSON.parse(stored);
            applyStoredHighlights();
        }
    }

    // Save highlights to localStorage
    function saveHighlights() {
        const questionId = getQuestionId();
        localStorage.setItem('highlights_' + questionId, JSON.stringify(questionHighlights));
    }

    // Apply stored highlights
    function applyStoredHighlights() {
        Object.keys(questionHighlights).forEach(key => {
            const element = document.querySelector(`[data-highlight-id="${key}"]`);
            if (element && questionHighlights[key]) {
                element.classList.add('highlighted');
            }
        });
    }

    // Toggle highlighter mode
    function toggleHighlighter(event) {
        event.stopPropagation();
        highlighterActive = !highlighterActive;

        const btn = event.target.closest('.highlighter-btn');
        const icon = btn.querySelector('#highlighterIcon');

        if (highlighterActive) {
            btn.classList.add('active');
            icon.textContent = 'üñçÔ∏è';
            document.body.classList.add('highlighter-mode-active');
        } else {
            btn.classList.remove('active');
            icon.textContent = 'üñäÔ∏è';
            document.body.classList.remove('highlighter-mode-active');
        }
    }

    // Clear all highlights for this question
    function clearHighlights() {
        const questionId = getQuestionId();
        questionHighlights = {};
        localStorage.removeItem('highlights_' + questionId);
        document.querySelectorAll('.highlighted').forEach(el => {
            el.classList.remove('highlighted');
        });
    }

    // Handle text selection and highlighting
    document.addEventListener('mouseup', function(e) {
        if (!highlighterActive) return;

        const selection = window.getSelection();
        if (!selection.toString().trim()) return;

        const range = selection.getRangeAt(0);
        const container = range.commonAncestorContainer;

        // Only highlight text in paragraphs, not in buttons or other elements
        const paragraph = container.nodeType === 3 ? container.parentElement : container;
        if (paragraph.tagName !== 'P' && paragraph.tagName !== 'LI' && paragraph.tagName !== 'TD') {
            return;
        }

        // Create highlight span
        const span = document.createElement('span');
        span.classList.add('highlighted');

        // Generate unique ID for this highlight
        const highlightId = 'hl-' + Date.now() + '-' + Math.random().toString(36).substr(2, 9);
        span.setAttribute('data-highlight-id', highlightId);

        try {
            range.surroundContents(span);
            questionHighlights[highlightId] = true;
            saveHighlights();
        } catch (e) {
            console.log('Could not highlight selection');
        }

        selection.removeAllRanges();
    });

    // Load highlights when page loads
    window.addEventListener('load', loadHighlights);

    // Keyboard shortcut: Ctrl+H to toggle highlighter
    document.addEventListener('keydown', function(e) {
        if (e.ctrlKey && e.key === 'h') {
            e.preventDefault();
            const btn = document.querySelector('.highlighter-btn');
            if (btn) {
                toggleHighlighter({target: btn, stopPropagation: () => {}});
            }
        }
        // Ctrl+Shift+H to clear all highlights
        if (e.ctrlKey && e.shiftKey && e.key === 'H') {
            e.preventDefault();
            if (confirm('Clear all highlights for this question?')) {
                clearHighlights();
            }
        }
    });
</script>
