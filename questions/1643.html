
<style>
    * {
        box-sizing: border-box !important;
    }

    body {
        font-family: 'Inter', 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif !important;
        line-height: 1.9 !important;
        color: #1f1f1f !important;
        max-width: none !important;
        margin: 0 !important;
        padding: 8px 16px 16px 16px !important;
        background: #ffffff !important;
        font-size: 16.5px !important;
    }

    p {
        margin-bottom: 20px !important;
        font-size: 16.5px !important;
        line-height: 1.95 !important;
        color: #1f1f1f !important;
        font-weight: 400 !important;
    }

    strong, b {
        color: #1a73e8 !important;
        font-weight: 700 !important;
        background: rgba(26, 115, 232, 0.08) !important;
        padding: 2px 6px !important;
        border-radius: 8px !important;
    }

    /* Details/Summary (collapsible sections) */
    details {
        background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%) !important;
        border-radius: 8px !important;
        padding: 24px 28px !important;
        margin: 24px 0 !important;
        border: none;
        box-shadow: none !important;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
    }

    details:hover {
        border-color: #1a73e8 !important;
        box-shadow: none !important;
        transform: translateY(-2px) !important;
    }

    details[open] {
        background: #ffffff !important;
        border-color: #1a73e8 !important;
        box-shadow: none !important;
    }

    summary {
        cursor: pointer !important;
        font-weight: 800 !important;
        color: #ffffff !important;
        font-size: 20px !important;
        padding: 16px 24px !important;
        border-radius: 8px !important;
        background: linear-gradient(135deg, #1a73e8 0%, #1557b0 100%) !important;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
        display: flex !important;
        align-items: center !important;
        user-select: none !important;
        box-shadow: none !important;
        letter-spacing: 0.5px !important;
    }

    summary:hover {
        background: linear-gradient(135deg, #1557b0 0%, #0d47a1 100%) !important;
        transform: translateX(6px) scale(1.02) !important;
        box-shadow: none !important;
    }

    summary:active {
        transform: translateX(4px) scale(0.99) !important;
    }

    summary::marker {
        color: rgba(255, 255, 255, 0.9) !important;
        font-size: 1.3em !important;
    }

    summary strong {
        background: rgba(255, 255, 255, 0.2) !important;
        color: #ffffff !important;
        padding: 4px 12px !important;
        border-radius: 8px !important;
        margin-left: 8px !important;
        font-size: 19px !important;
        letter-spacing: 1px !important;
    }

    /* Tables - Premium Design */
    table {
        width: 100% !important;
        border-collapse: separate !important;
        border-spacing: 0 !important;
        margin: 28px 0 !important;
        border-radius: 8px !important;
        overflow: hidden !important;
        box-shadow: none !important;
        border: none !important;
        background: #ffffff !important;
    }

    table.simple-table {
        background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%) !important;
    }

    table tr {
        transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1) !important;
        position: relative !important;
    }

    table tr:nth-child(odd) {
        background: rgba(248, 249, 250, 0.5) !important;
    }

    table tr:nth-child(even) {
        background: rgba(255, 255, 255, 0.8) !important;
    }

    table tr:hover {
        background: linear-gradient(90deg, #e8f0fe 0%, #f1f8ff 100%) !important;
        transform: translateX(4px) scale(1.01) !important;
        box-shadow: none !important;
        z-index: 1 !important;
    }

    table td {
        padding: 18px 24px !important;
        border-bottom: 1px solid rgba(232, 234, 237, 0.6) !important;
        font-size: 16.5px !important;
        line-height: 1.7 !important;
        color: #1f1f1f !important;
        vertical-align: middle !important;
    }

    table tr:last-child td {
        border-bottom: none !important;
    }

    /* First column (A, B, C, D, E) */
    table td:first-child {
        font-weight: 800 !important;
        color: #ffffff !important;
        width: 52px !important;
        text-align: center !important;
        font-size: 18px !important;
        background: linear-gradient(135deg, #1a73e8 0%, #1557b0 100%) !important;
        border-right: 3px solid #1557b0 !important;
        position: relative !important;
        letter-spacing: 0.5px !important;
    }

    table tr:hover td:first-child {
        background: linear-gradient(135deg, #1557b0 0%, #0d47a1 100%) !important;
        box-shadow: none !important;
    }

    /* Second column (content) */
    table td:nth-child(2) {
        font-weight: 500 !important;
        padding-left: 28px !important;
    }

    /* Third column (empty - hide it) */
    table td:last-child:empty {
        display: none !important;
    }

    /* Lists */
    ul, ol {
        margin: 16px 0 !important;
        padding-left: 32px !important;
    }

    li {
        margin: 10px 0 !important;
        line-height: 1.8 !important;
        color: #1f1f1f !important;
    }

    ul.bulleted-list li {
        position: relative !important;
        padding-left: 8px !important;
    }

    ul.toggle {
        list-style: none !important;
        padding-left: 0 !important;
    }

    /* Links */
    a {
        color: #1a73e8 !important;
        text-decoration: none !important;
        font-weight: 600 !important;
        border-bottom: 2px solid transparent !important;
        transition: all 0.2s !important;
    }

    a:hover {
        border-bottom-color: #1a73e8 !important;
        background: rgba(26,115,232,0.08) !important;
        padding: 2px 4px !important;
        border-radius: 8px !important;
    }

    /* Images & Media */
    img, video {
        max-width: none !important;
        height: auto !important;
        border-radius: 8px !important;
        box-shadow: none !important;
        margin: 24px 0 !important;
        display: block !important;
        border: none !important;
    }

    img:hover, video:hover {
        box-shadow: none !important;
        border-color: #1a73e8 !important;
    }

    /* Code blocks (if any) */
    code {
        background: #f1f3f4 !important;
        padding: 2px 8px !important;
        border-radius: 8px !important;
        font-family: 'Courier New', monospace !important;
        font-size: 14px !important;
        color: #d93025 !important;
    }

    pre {
        background: #f8f9fa !important;
        padding: 8px 16px 16px 16px !important;
        border-radius: 8px !important;
        overflow-x: auto !important;
        border-left: 4px solid #1a73e8 !important;
    }

    /* Headings */
    h1, h2, h3, h4, h5, h6 {
        color: #1a73e8 !important;
        font-weight: 700 !important;
        margin-top: 24px !important;
        margin-bottom: 16px !important;
        line-height: 1.4 !important;
    }

    h1 { font-size: 32px !important; }
    h2 { font-size: 26px !important; }
    h3 { font-size: 22px !important; }
    h4 { font-size: 19px !important; }

    /* Blockquotes */
    blockquote {
        border-left: 4px solid #1a73e8 !important;
        padding-left: 20px !important;
        margin: 20px 0 !important;
        font-style: italic !important;
        color: #5f6368 !important;
        background: #f8f9fa !important;
        padding: 16px 20px !important;
        border-radius: 8px !important;
    }

    /* Horizontal Rule */
    hr {
        border: none !important;
        height: 2px !important;
        background: linear-gradient(to right, transparent, #1a73e8, transparent) !important;
        margin: 32px 0 !important;
    }

    /* Selection */
    ::selection {
        background: #e8f0fe !important;
        color: #1a73e8 !important;
    }

    /* Highlighter styles */
    .highlighted {
        background-color: #ffeb3b !important;
        transition: background-color 0.2s ease !important;
    }

    .highlighter-btn {
        background: none !important;
        border: none !important;
        cursor: pointer !important;
        font-size: 20px !important;
        padding: 0 8px !important;
        margin-left: 8px !important;
        transition: transform 0.2s ease !important;
        vertical-align: middle !important;
    }

    .highlighter-btn:hover {
        transform: scale(1.2) !important;
    }

    .highlighter-btn.active {
        transform: scale(1.1) !important;
        filter: brightness(1.2) !important;
    }

    .highlighter-mode-active {
        cursor: text !important;
    }


    /* Right padding to avoid overlap with sidebar buttons */
    body {
        padding-right: 50px !important;
    }

    @media (max-width: 768px) {
        body {
            padding-right: 16px !important;
        }
    }

</style>




<details open>
<summary><strong>1643</strong><button class="bionic-reading-btn" onclick="toggleBionicReading(event)" title="Toggle Bionic Reading (Ctrl+B)"><span id="bionicIcon">üëÅÔ∏è</span></button><button class="highlighter-btn" onclick="toggleHighlighter(event)" title="Toggle Highlighter (Ctrl+H)"><span id="highlighterIcon">üñäÔ∏è</span></button></summary>
<p class="" id="f55642a3-c4da-4d72-bc76-5b65ff04b8df">A 43-year-old woman comes to
                                        the emergency department due to low-grade fevers and malaise.  She has a history
                                        of lung transplantation due to cystic fibrosis and had 2 episodes of
                                        cytomegalovirus (CMV) viremia over the past few months, which were treated with
                                        ganciclovir.  Temperature is 37.6 C (99.7 F).  Physical examination is
                                        unrevealing.  Chest x-ray and urinalysis are negative for infection.  Polymerase
                                        chain reaction testing for CMV in blood shows elevated CMV levels consistent
                                        with CMV viremia.  Given the recurrent episodes of viremia, genotype analysis is
                                        performed and demonstrates ganciclovir-resistant CMV.  The patient is started on
                                        an alternate intravenous antiviral agent.  She develops hypocalcemia and
                                        hypomagnesemia.  Which of the following agents is the most likely cause of these
                                        side effects?</p>
<table class="simple-table" id="4faa1cdd-55cf-4ac7-af83-1532cce7d9d0">
<tbody>
<tr id="79ca2bc6-72dc-431a-bb01-3a436b5157e8">
<td class="" id="ZUxt">A.</td>
<td class="" id="m_jT">Acyclovir</td>
<td class="" id="WrVs"></td>
</tr>
<tr id="58af22fc-675c-4dbb-8f98-779345083c12">
<td class="" id="ZUxt">B.</td>
<td class="" id="m_jT">Cidofovir</td>
<td class="" id="WrVs"></td>
</tr>
<tr id="76a3e27a-0b3b-4ae9-a2bf-44fd71e0c164">
<td class="" id="ZUxt">C.</td>
<td class="" id="m_jT">Foscarnet</td>
<td class="" id="WrVs"></td>
</tr>
<tr id="f93b632d-3a95-41ee-9ceb-9c02699f3e37">
<td class="" id="ZUxt">D.</td>
<td class="" id="m_jT">Lamivudine</td>
<td class="" id="WrVs"></td>
</tr>
<tr id="ff3003c0-3403-4644-8e6b-219eb30f6471">
<td class="" id="ZUxt">E.</td>
<td class="" id="m_jT">Sofosbuvir</td>
<td class="" id="WrVs"></td>
</tr>
<tr id="cd00dcf9-2531-4fae-a1c8-39bc14a2c839">
<td class="" id="ZUxt">F.</td>
<td class="" id="m_jT">Valganciclovir</td>
<td class="" id="WrVs"></td>
</tr>
</tbody>
</table>
<ul class="toggle" id="4d97d6b8-7e60-4202-820c-0e2e55de6efc">
<li>
<details>
<summary>Submit</summary>
<table class="simple-table" id="f28a0970-66aa-4813-83eb-3035e7c50fad">
<tbody>
<tr id="f370551a-7cd3-4127-b534-84d8738e0d40">
<td class="" id="o_Hf">A.</td>
<td class="" id="`K{v">Acyclovir (6%)</td>
<td class="" id="&gt;rQz"></td>
</tr>
<tr id="33b0fd3b-fa68-481e-8dcd-48b8371550f3">
<td class="" id="o_Hf">B.</td>
<td class="" id="`K{v">Cidofovir (7%)</td>
<td class="" id="&gt;rQz"></td>
</tr>
<tr id="85e0cfa0-a417-4b55-bddc-71b796adbe00">
<td class="" id="o_Hf">C.</td>
<td class="" id="`K{v">Foscarnet (73%)</td>
<td class="" id="&gt;rQz"></td>
</tr>
<tr id="bfe47de7-a74c-4bf8-be7c-3be3e83bf8c8">
<td class="" id="o_Hf">D.</td>
<td class="" id="`K{v">Lamivudine (4%)</td>
<td class="" id="&gt;rQz"></td>
</tr>
<tr id="3cc1fe5f-2b7c-48d1-a170-287aa0dd464d">
<td class="" id="o_Hf">E.</td>
<td class="" id="`K{v">Sofosbuvir (1%)</td>
<td class="" id="&gt;rQz"></td>
</tr>
<tr id="ba1bc574-4efb-4956-89c4-b1937f3b56e2">
<td class="" id="o_Hf">F.</td>
<td class="" id="`K{v">Valganciclovir (6%)</td>
<td class="" id="&gt;rQz"></td>
</tr>
</tbody>
</table>
<p class="" id="260ac1e3-1264-466f-ad51-1e4f9fe59ebd">Correct</p>
<p class="" id="d3209062-5759-46fb-a5de-5a25bdfdeffc">73%Answered
                                                    correctly</p>
<p class="" id="8ced3783-fe5e-4fe3-b92c-084cce8d93c3">14 secsTime Spent
                                                </p>
<p class="" id="a960cf67-1eb1-4292-ab89-603f00add223">2024Version</p>
<ul class="bulleted-list" id="700e5855-edb9-4221-9f37-4c4e3f3a6a43">
<li style="list-style-type:disc">Explanation</li>
</ul>
<ul class="bulleted-list" id="fc68380f-b45e-424c-8da3-40e65fc4f664">
<li style="list-style-type:disc"></li>
</ul>
<p class="" id="563cb9f6-bc10-44bf-94ec-6f861b2bd488">Foscarnet is a
                                                    pyrophosphate analog that is sometimes used for
                                                    ganciclovir-resistant cytomegalovirus (CMV) infections.  Foscarnet
                                                    can chelate calcium.  Moreover, foscarnet-induced renal wasting of
                                                    magnesium may lead to hypomagnesemia and a reduction in the release
                                                    of parathyroid hormone, which contributes to the hypocalcemic
                                                    state.  Both hypocalcemia and hypomagnesemia can promote seizures.
                                                </p>
<p class="" id="1b7cc866-d600-45aa-bbdd-5de38aa7add8">(Choice A)  Major
                                                    toxicities of acyclovir (used in some herpes simplex virus
                                                    infections) include crystal nephropathy and neurotoxicity that
                                                    manifests as delirium and/or tremor.</p>
<p class="" id="00ff7491-1742-4d20-9d27-d08ad468272b">(Choice B) 
                                                    Cidofovir, used in some cases of CMV retinitis, is associated with
                                                    nephrotoxicity manifesting as proteinuria or elevated creatinine.
                                                </p>
<p class="" id="37d178c0-eb82-44e7-9039-f8e7bc8fcfa0">(Choice D) 
                                                    Lamivudine is a nucleoside reverse transcriptase inhibitor (NRTI). 
                                                    Side effects are unusual with lamivudine, unlike other NRTIs. 
                                                    Lamivudine is occasionally associated with peripheral neuropathy and
                                                    lactic acidosis.</p>
<p class="" id="d9b2974f-a402-41ec-aec4-4051f8dd45e6">(Choice E) 
                                                    Sofosbuvir inhibits nonstructural protein 5B (NS5B), an
                                                    RNA-dependent RNA polymerase needed for hepatitis C virus
                                                    replication.  Adverse effects associated with its use include
                                                    fatigue and nausea.</p>
<p class="" id="69de096f-fbd2-4df0-bd18-663ed81fb545">(Choice F) 
                                                    Valganciclovir is a ganciclovir prodrug and is unlikely to be useful
                                                    against ganciclovir-resistant CMV.  Ganciclovir is associated with
                                                    severe neutropenia, which can be exacerbated by other bone-marrow
                                                    suppressing agents (eg, zidovudine, trimethoprim-sulfamethoxazole).
                                                </p>
<p class="" id="8ede1867-9635-46ad-afa9-b9dfd5f7495a">Educational
                                                    objective:</p>
<p class="" id="028b4868-5008-4aff-96e0-d05735843738">Foscarnet is an
                                                    analog of pyrophosphate that can chelate calcium and promote
                                                    nephrotoxic renal magnesium wasting.  These toxicities can result in
                                                    hypocalcemia and hypomagnesemia, which can cause seizures.</p>
<p class="" id="ea4449cd-51c4-40a0-80c3-62ea1ecd6ccc">Pharmacology</p>
<p class="" id="f99e3ff0-4bf5-47ce-9c2b-70ae5e642a20">Subject</p>
<p class="" id="ffd66b3a-2657-459b-b650-84ef9b241a8d">Infectious
                                                    Diseases</p>
<p class="" id="400b1aa4-2735-461b-a5f0-f9e790c6b23a">System</p>
<p class="" id="450f582d-6da5-4dd3-a585-51fe1a585785">Foscarnet</p>
<p class="" id="a20befdb-0d1f-4192-972a-ae41e9d45c97">Topic</p>
<p class="" id="19870bf1-e944-4e7f-9cd6-0b95b2713174">Copyright ¬©
                                                    UWorld. All rights reserved.</p>
<p class="" id="d3b18a03-8a78-48e8-80d9-193ce368dc63">‚ùåelementFinder:
                                                    //a[@href='javascript:void(0)']</p>
</details>
</li>
</ul>
</details>


















<style>
.bionic-reading-btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    height: 40px;
    background: rgba(255, 255, 255, 0.2);
    border: 2px solid rgba(255, 255, 255, 0.3);
    border-radius: 8px;
    color: white;
    font-size: 20px;
    cursor: pointer;
    transition: all 0.3s;
    margin-left: auto;
    flex-shrink: 0;
}

.bionic-reading-btn:hover {
    background: rgba(255, 255, 255, 0.35);
    border-color: rgba(255, 255, 255, 0.5);
    transform: scale(1.1);
}

.bionic-reading-btn.active {
    background: rgba(52, 168, 83, 0.4);
    border-color: rgba(52, 168, 83, 0.6);
}

.bionic-reading-btn.active:hover {
    background: rgba(52, 168, 83, 0.5);
}

summary {
    display: flex !important;
    align-items: center !important;
    gap: 12px !important;
}

    /* Highlighter styles */
    .highlighted {
        background-color: #ffeb3b !important;
        transition: background-color 0.2s ease !important;
    }

    .highlighter-btn {
        background: none !important;
        border: none !important;
        cursor: pointer !important;
        font-size: 20px !important;
        padding: 0 8px !important;
        margin-left: 8px !important;
        transition: transform 0.2s ease !important;
        vertical-align: middle !important;
    }

    .highlighter-btn:hover {
        transform: scale(1.2) !important;
    }

    .highlighter-btn.active {
        transform: scale(1.1) !important;
        filter: brightness(1.2) !important;
    }

    .highlighter-mode-active {
        cursor: text !important;
    }


    /* Right padding to avoid overlap with sidebar buttons */
    body {
        padding-right: 50px !important;
    }

    @media (max-width: 768px) {
        body {
            padding-right: 16px !important;
        }
    }

</style>



<script>
let bionicEnabled = false;
const originalContent = {};

function toggleBionicReading(event) {
    if (event) {
        event.preventDefault();
        event.stopPropagation();
    }

    bionicEnabled = !bionicEnabled;
    const btn = document.querySelector('.bionic-reading-btn');
    const icon = document.getElementById('bionicIcon');

    if (bionicEnabled) {
        btn.classList.add('active');
        icon.textContent = '‚úÖ';
        applyBionicReading();
    } else {
        btn.classList.remove('active');
        icon.textContent = 'üëÅÔ∏è';
        restoreOriginalText();
    }
}

function applyBionicReading() {
    // Seleciona todos os elementos de texto, EXCETO summary e buttons
    const textElements = document.querySelectorAll('p:not(summary p):not(button p), td:not(summary td):not(button td), li:not(summary li):not(button li)');

    textElements.forEach((element, index) => {
        // Ignora elementos que cont√™m outros elementos complexos
        if (element.querySelector('p, td, li, h1, h2, h3, h4, h5, h6, button, summary')) {
            return;
        }

        // Ignora se o elemento est√° dentro de um summary ou button
        if (element.closest('summary') || element.closest('button') || element.closest('.bionic-reading-btn')) {
            return;
        }

        // Salva o conte√∫do original
        if (!originalContent[index]) {
            originalContent[index] = {
                element: element,
                html: element.innerHTML
            };
        }

        // Aplica Bionic Reading
        const bionicText = convertToBionic(element.textContent);
        element.innerHTML = bionicText;
    });
}

function restoreOriginalText() {
    // Restaura o conte√∫do original
    Object.values(originalContent).forEach(item => {
        item.element.innerHTML = item.html;
    });
}

function convertToBionic(text) {
    // Divide o texto em palavras, mantendo pontua√ß√£o
    const words = text.split(/(\s+|[.,;:!?()""''\-‚Äì‚Äî])/);

    const bionicWords = words.map(word => {
        // Ignora espa√ßos e pontua√ß√£o
        if (word.match(/^\s+$/) || word.match(/^[.,;:!?()""''\-‚Äì‚Äî]+$/)) {
            return word;
        }

        // Ignora palavras muito curtas (1-2 letras)
        if (word.length <= 2) {
            return word;
        }

        // Determina quantas letras deixar em negrito (metade da palavra, arredondado para cima)
        const boldLength = Math.ceil(word.length / 2);

        // Separa a parte em negrito da parte normal
        const boldPart = word.substring(0, boldLength);
        const normalPart = word.substring(boldLength);

        // Retorna com a primeira parte em negrito
        return `<strong style="font-weight: 700 !important; color: inherit !important; background: none !important; padding: 0 !important;">${boldPart}</strong>${normalPart}`;
    });

    return bionicWords.join('');
}

// Adiciona atalho de teclado (Ctrl+B ou Cmd+B)
document.addEventListener('keydown', function(e) {
    if ((e.ctrlKey || e.metaKey) && e.key === 'b') {
        e.preventDefault();
        toggleBionicReading();
    }
});
</script>

<script>
    let highlighterActive = false;
    let questionHighlights = {};

    // Get question ID from the first summary strong tag
    function getQuestionId() {
        const firstSummary = document.querySelector('summary strong');
        return firstSummary ? firstSummary.textContent.trim() : '1';
    }

    // Load highlights from localStorage
    function loadHighlights() {
        const questionId = getQuestionId();
        const stored = localStorage.getItem('highlights_' + questionId);
        if (stored) {
            questionHighlights = JSON.parse(stored);
            applyStoredHighlights();
        }
    }

    // Save highlights to localStorage
    function saveHighlights() {
        const questionId = getQuestionId();
        localStorage.setItem('highlights_' + questionId, JSON.stringify(questionHighlights));
    }

    // Apply stored highlights
    function applyStoredHighlights() {
        Object.keys(questionHighlights).forEach(key => {
            const element = document.querySelector(`[data-highlight-id="${key}"]`);
            if (element && questionHighlights[key]) {
                element.classList.add('highlighted');
            }
        });
    }

    // Toggle highlighter mode
    function toggleHighlighter(event) {
        event.stopPropagation();
        highlighterActive = !highlighterActive;

        const btn = event.target.closest('.highlighter-btn');
        const icon = btn.querySelector('#highlighterIcon');

        if (highlighterActive) {
            btn.classList.add('active');
            icon.textContent = 'üñçÔ∏è';
            document.body.classList.add('highlighter-mode-active');
        } else {
            btn.classList.remove('active');
            icon.textContent = 'üñäÔ∏è';
            document.body.classList.remove('highlighter-mode-active');
        }
    }

    // Clear all highlights for this question
    function clearHighlights() {
        const questionId = getQuestionId();
        questionHighlights = {};
        localStorage.removeItem('highlights_' + questionId);
        document.querySelectorAll('.highlighted').forEach(el => {
            el.classList.remove('highlighted');
        });
    }

    // Handle text selection and highlighting
    document.addEventListener('mouseup', function(e) {
        if (!highlighterActive) return;

        const selection = window.getSelection();
        if (!selection.toString().trim()) return;

        const range = selection.getRangeAt(0);
        const container = range.commonAncestorContainer;

        // Only highlight text in paragraphs, not in buttons or other elements
        const paragraph = container.nodeType === 3 ? container.parentElement : container;
        if (paragraph.tagName !== 'P' && paragraph.tagName !== 'LI' && paragraph.tagName !== 'TD') {
            return;
        }

        // Create highlight span
        const span = document.createElement('span');
        span.classList.add('highlighted');

        // Generate unique ID for this highlight
        const highlightId = 'hl-' + Date.now() + '-' + Math.random().toString(36).substr(2, 9);
        span.setAttribute('data-highlight-id', highlightId);

        try {
            range.surroundContents(span);
            questionHighlights[highlightId] = true;
            saveHighlights();
        } catch (e) {
            console.log('Could not highlight selection');
        }

        selection.removeAllRanges();
    });

    // Load highlights when page loads
    window.addEventListener('load', loadHighlights);

    // Keyboard shortcut: Ctrl+H to toggle highlighter
    document.addEventListener('keydown', function(e) {
        if (e.ctrlKey && e.key === 'h') {
            e.preventDefault();
            const btn = document.querySelector('.highlighter-btn');
            if (btn) {
                toggleHighlighter({target: btn, stopPropagation: () => {}});
            }
        }
        // Ctrl+Shift+H to clear all highlights
        if (e.ctrlKey && e.shiftKey && e.key === 'H') {
            e.preventDefault();
            if (confirm('Clear all highlights for this question?')) {
                clearHighlights();
            }
        }
    });
</script>
