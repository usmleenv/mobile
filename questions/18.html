
<style>
    * {
        box-sizing: border-box !important;
    }

    body {
        font-family: 'Inter', 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif !important;
        line-height: 1.9 !important;
        color: #1f1f1f !important;
        max-width: none !important;
        margin: 0 !important;
        padding: 8px 16px 16px 16px !important;
        background: #ffffff !important;
        font-size: 16.5px !important;
    }

    p {
        margin-bottom: 20px !important;
        font-size: 16.5px !important;
        line-height: 1.95 !important;
        color: #1f1f1f !important;
        font-weight: 400 !important;
    }

    strong, b {
        color: #1a73e8 !important;
        font-weight: 700 !important;
        background: rgba(26, 115, 232, 0.08) !important;
        padding: 2px 6px !important;
        border-radius: 8px !important;
    }

    /* Details/Summary (collapsible sections) */
    details {
        background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%) !important;
        border-radius: 8px !important;
        padding: 24px 28px !important;
        margin: 24px 0 !important;
        border: none;
        box-shadow: none !important;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
    }

    details:hover {
        border-color: #1a73e8 !important;
        box-shadow: none !important;
        transform: translateY(-2px) !important;
    }

    details[open] {
        background: #ffffff !important;
        border-color: #1a73e8 !important;
        box-shadow: none !important;
    }

    summary {
        cursor: pointer !important;
        font-weight: 800 !important;
        color: #ffffff !important;
        font-size: 20px !important;
        padding: 16px 24px !important;
        border-radius: 8px !important;
        background: linear-gradient(135deg, #1a73e8 0%, #1557b0 100%) !important;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
        display: flex !important;
        align-items: center !important;
        user-select: none !important;
        box-shadow: none !important;
        letter-spacing: 0.5px !important;
    }

    summary:hover {
        background: linear-gradient(135deg, #1557b0 0%, #0d47a1 100%) !important;
        transform: translateX(6px) scale(1.02) !important;
        box-shadow: none !important;
    }

    summary:active {
        transform: translateX(4px) scale(0.99) !important;
    }

    summary::marker {
        color: rgba(255, 255, 255, 0.9) !important;
        font-size: 1.3em !important;
    }

    summary strong {
        background: rgba(255, 255, 255, 0.2) !important;
        color: #ffffff !important;
        padding: 4px 12px !important;
        border-radius: 8px !important;
        margin-left: 8px !important;
        font-size: 19px !important;
        letter-spacing: 1px !important;
    }

    /* Tables - Premium Design */
    table {
        width: 100% !important;
        border-collapse: separate !important;
        border-spacing: 0 !important;
        margin: 28px 0 !important;
        border-radius: 8px !important;
        overflow: hidden !important;
        box-shadow: none !important;
        border: none !important;
        background: #ffffff !important;
    }

    table.simple-table {
        background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%) !important;
    }

    table tr {
        transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1) !important;
        position: relative !important;
    }

    table tr:nth-child(odd) {
        background: rgba(248, 249, 250, 0.5) !important;
    }

    table tr:nth-child(even) {
        background: rgba(255, 255, 255, 0.8) !important;
    }

    table tr:hover {
        background: linear-gradient(90deg, #e8f0fe 0%, #f1f8ff 100%) !important;
        transform: translateX(4px) scale(1.01) !important;
        box-shadow: none !important;
        z-index: 1 !important;
    }

    table td {
        padding: 18px 24px !important;
        border-bottom: 1px solid rgba(232, 234, 237, 0.6) !important;
        font-size: 16.5px !important;
        line-height: 1.7 !important;
        color: #1f1f1f !important;
        vertical-align: middle !important;
    }

    table tr:last-child td {
        border-bottom: none !important;
    }

    /* First column (A, B, C, D, E) */
    table td:first-child {
        font-weight: 800 !important;
        color: #ffffff !important;
        width: 52px !important;
        text-align: center !important;
        font-size: 18px !important;
        background: linear-gradient(135deg, #1a73e8 0%, #1557b0 100%) !important;
        border-right: 3px solid #1557b0 !important;
        position: relative !important;
        letter-spacing: 0.5px !important;
    }

    table tr:hover td:first-child {
        background: linear-gradient(135deg, #1557b0 0%, #0d47a1 100%) !important;
        box-shadow: none !important;
    }

    /* Second column (content) */
    table td:nth-child(2) {
        font-weight: 500 !important;
        padding-left: 28px !important;
    }

    /* Third column (empty - hide it) */
    table td:last-child:empty {
        display: none !important;
    }

    /* Lists */
    ul, ol {
        margin: 16px 0 !important;
        padding-left: 32px !important;
    }

    li {
        margin: 10px 0 !important;
        line-height: 1.8 !important;
        color: #1f1f1f !important;
    }

    ul.bulleted-list li {
        position: relative !important;
        padding-left: 8px !important;
    }

    ul.toggle {
        list-style: none !important;
        padding-left: 0 !important;
    }

    /* Links */
    a {
        color: #1a73e8 !important;
        text-decoration: none !important;
        font-weight: 600 !important;
        border-bottom: 2px solid transparent !important;
        transition: all 0.2s !important;
    }

    a:hover {
        border-bottom-color: #1a73e8 !important;
        background: rgba(26,115,232,0.08) !important;
        padding: 2px 4px !important;
        border-radius: 8px !important;
    }

    /* Images & Media */
    img, video {
        max-width: none !important;
        height: auto !important;
        border-radius: 8px !important;
        box-shadow: none !important;
        margin: 24px 0 !important;
        display: block !important;
        border: none !important;
    }

    img:hover, video:hover {
        box-shadow: none !important;
        border-color: #1a73e8 !important;
    }

    /* Code blocks (if any) */
    code {
        background: #f1f3f4 !important;
        padding: 2px 8px !important;
        border-radius: 8px !important;
        font-family: 'Courier New', monospace !important;
        font-size: 14px !important;
        color: #d93025 !important;
    }

    pre {
        background: #f8f9fa !important;
        padding: 8px 16px 16px 16px !important;
        border-radius: 8px !important;
        overflow-x: auto !important;
        border-left: 4px solid #1a73e8 !important;
    }

    /* Headings */
    h1, h2, h3, h4, h5, h6 {
        color: #1a73e8 !important;
        font-weight: 700 !important;
        margin-top: 24px !important;
        margin-bottom: 16px !important;
        line-height: 1.4 !important;
    }

    h1 { font-size: 32px !important; }
    h2 { font-size: 26px !important; }
    h3 { font-size: 22px !important; }
    h4 { font-size: 19px !important; }

    /* Blockquotes */
    blockquote {
        border-left: 4px solid #1a73e8 !important;
        padding-left: 20px !important;
        margin: 20px 0 !important;
        font-style: italic !important;
        color: #5f6368 !important;
        background: #f8f9fa !important;
        padding: 16px 20px !important;
        border-radius: 8px !important;
    }

    /* Horizontal Rule */
    hr {
        border: none !important;
        height: 2px !important;
        background: linear-gradient(to right, transparent, #1a73e8, transparent) !important;
        margin: 32px 0 !important;
    }

    /* Selection */
    ::selection {
        background: #e8f0fe !important;
        color: #1a73e8 !important;
    }

    /* Highlighter styles */
    .highlighted {
        background-color: #ffeb3b !important;
        transition: background-color 0.2s ease !important;
    }

    .highlighter-btn {
        background: none !important;
        border: none !important;
        cursor: pointer !important;
        font-size: 20px !important;
        padding: 0 8px !important;
        margin-left: 8px !important;
        transition: transform 0.2s ease !important;
        vertical-align: middle !important;
    }

    .highlighter-btn:hover {
        transform: scale(1.2) !important;
    }

    .highlighter-btn.active {
        transform: scale(1.1) !important;
        filter: brightness(1.2) !important;
    }

    .highlighter-mode-active {
        cursor: text !important;
    }


    /* Right padding to avoid overlap with sidebar buttons */
    body {
        padding-right: 50px !important;
    }

    @media (max-width: 768px) {
        body {
            padding-right: 16px !important;
        }
    }

</style>




<details open>
<summary><strong>18</strong><button class="bionic-reading-btn" onclick="toggleBionicReading(event)" title="Toggle Bionic Reading (Ctrl+B)"><span id="bionicIcon">üëÅÔ∏è</span></button><button class="highlighter-btn" onclick="toggleHighlighter(event)" title="Toggle Highlighter (Ctrl+H)"><span id="highlighterIcon">üñäÔ∏è</span></button></summary>
<p class="" id="f7532e51-bf89-4e00-82ab-9d8868006fde">A 63-year-old man collapses at
                                        home after experiencing severe retrosternal chest pain.  The emergency medical
                                        team finds him with no pulse, and cardiac monitoring shows ventricular
                                        fibrillation.  Cardiopulmonary resuscitation is performed, and the patient
                                        regains spontaneous circulation after several minutes.  On arrival at the
                                        hospital, he has stable vital signs but does not follow commands or respond to
                                        strong stimuli.  Which of the following areas is most likely to be affected
                                        first by ischemic damage in this patient?</p>
<table class="simple-table" id="abc12242-1d77-4657-a5be-d5a51bdf7f3a">
<tbody>
<tr id="0e210e2e-ff13-46f4-8a8b-f2790005f0f9">
<td class="" id="oR`_">A.</td>
<td class="" id="LQWZ">Caudate nucleus</td>
<td class="" id="vD{l"></td>
</tr>
<tr id="0cb3446f-4a19-4fab-87eb-1a724b2d89c2">
<td class="" id="oR`_">B.</td>
<td class="" id="LQWZ">Hippocampus</td>
<td class="" id="vD{l"></td>
</tr>
<tr id="e6066371-e91a-468b-8fb6-337f92d741e0">
<td class="" id="oR`_">C.</td>
<td class="" id="LQWZ">Hypothalamus</td>
<td class="" id="vD{l"></td>
</tr>
<tr id="6f5aca89-112f-4b37-a7a6-98333757e2dc">
<td class="" id="oR`_">D.</td>
<td class="" id="LQWZ">Substantia nigra</td>
<td class="" id="vD{l"></td>
</tr>
<tr id="9d21bb8b-eaa7-4d23-9a9c-5b386b06206a">
<td class="" id="oR`_">E.</td>
<td class="" id="LQWZ">Thalamic nuclei</td>
<td class="" id="vD{l"></td>
</tr>
</tbody>
</table>
<ul class="toggle" id="d23bae49-2e83-4157-a191-fdb444352d06">
<li>
<details>
<summary>Submit</summary>
<table class="simple-table" id="1fa699c7-71eb-41fc-8666-beb7fd9bcbd4">
<tbody>
<tr id="a7b6b9c8-3055-4947-b43f-4b87632a252e">
<td class="" id="h@M@">A.</td>
<td class="" id="BlIr">Caudate nucleus (7%)</td>
<td class="" id="kTO&lt;"></td>
</tr>
<tr id="dc3c6299-cbcb-4702-9d1c-5b81cf458394">
<td class="" id="h@M@">B.</td>
<td class="" id="BlIr">Hippocampus (56%)</td>
<td class="" id="kTO&lt;"></td>
</tr>
<tr id="2ac89f5d-8178-46d5-b3f9-e6dfca4f1d3f">
<td class="" id="h@M@">C.</td>
<td class="" id="BlIr">Hypothalamus (7%)</td>
<td class="" id="kTO&lt;"></td>
</tr>
<tr id="1ed67395-fa45-46ca-be7e-c6f53ebc1a9b">
<td class="" id="h@M@">D.</td>
<td class="" id="BlIr">Substantia nigra (2%)</td>
<td class="" id="kTO&lt;"></td>
</tr>
<tr id="35dc3e32-883b-4e22-a673-775b58ddc019">
<td class="" id="h@M@">E.</td>
<td class="" id="BlIr">Thalamic nuclei (26%)</td>
<td class="" id="kTO&lt;"></td>
</tr>
</tbody>
</table>
<p class="" id="7d7943b0-655e-4007-8c02-f4bd0e0d5d27">Incorrect</p>
<p class="" id="35c97bc6-e9fc-4493-8d59-520391995def">Correct answer B
                                                </p>
<p class="" id="49481ccb-374c-41c3-a11d-97e6efe00ffe">56%Answered
                                                    correctly</p>
<p class="" id="c72e37c7-e061-4ccc-8471-d5a58be6a595">14 secsTime Spent
                                                </p>
<p class="" id="07819153-2960-4d4b-9434-24f119e0c915">2024Version</p>
<ul class="bulleted-list" id="2f2bb4e9-e2c2-406f-92fc-9705a7416ac0">
<li style="list-style-type:disc">Explanation</li>
</ul>
<ul class="bulleted-list" id="a099bae6-97ec-4f20-8fad-05be0b69a69c">
<li style="list-style-type:disc"></li>
</ul>
<p class="" id="c5980585-cc2b-4ae1-939c-193ccd6c687d">This
                                                    patient's cardiac arrest, secondary to ventricular
                                                    fibrillation, caused rapid cessation of cerebral blood flow and
                                                    global cerebral ischemia.  Although cardiac function and circulation
                                                    were restored after medical intervention, the patient's brain
                                                    was subjected to ischemia for an unknown length of time, resulting
                                                    in neurological impairment.</p>
<p class="" id="be0277c3-cc07-40d8-a81d-1972ff0031b1">Global ischemia
                                                    lasting longer than 3-5 minutes can cause irreversible damage to
                                                    neurons.  The cells that are typically affected first by hypoxia are
                                                    the CA1 pyramidal neurons of the hippocampus, which can be damaged
                                                    by ischemia in as little as 3 minutes.  The cerebellar Purkinje
                                                    cells and neocortex pyramidal neurons are also highly susceptible to
                                                    damage if ischemia lasts for 5-10 minutes.  These neurons are likely
                                                    vulnerable to ischemia because of their high metabolic demand and
                                                    unique neurochemical characteristics (eg, inability to repolarize
                                                    after anoxic depolarization).</p>
<p class="" id="efb766f3-12da-41da-94ca-7ac58000dca7">The hippocampus is
                                                    located in the medial temporal lobe and plays an essential role in
                                                    memory, spatial processing, and response inhibition.  Selective
                                                    damage to the hippocampus is common with transient ischemia and can
                                                    result in an inability to make new memories (anterograde amnesia)
                                                    and disorientation to place or time.</p>
<p class="" id="53b0b251-613c-45d3-b059-e14ea9558185">(Choices A, C, D,
                                                    and E)  Although the caudate nucleus, hypothalamus, substantia
                                                    nigra, and thalamic nuclei are also vulnerable to ischemia if
                                                    cerebral hypoxia is sustained, they are not as susceptible to damage
                                                    as the hippocampal CA1 pyramidal neurons.</p>
<p class="" id="511ca662-2cd8-44c0-bbc6-46d60e52fc75">Educational
                                                    objective:</p>
<p class="" id="21fe941f-8b78-4985-b244-99378c66ebbf">Global cerebral
                                                    ischemia is typically precipitated by systemic hypotension (eg,
                                                    cardiac arrest).  The cells most susceptible to ischemia are the CA1
                                                    pyramidal neurons of the hippocampus.  Other areas of the brain that
                                                    are damaged early in the course of global cerebral ischemia include
                                                    the cerebellar Purkinje cells and the pyramidal neurons of the
                                                    neocortex.</p>
<p class="" id="0891b037-c623-4d36-8443-adb80d840ed0">References</p>
<ul class="bulleted-list" id="3b9bb334-202c-4652-a8a4-3671dcb5fe8c">
<li style="list-style-type:disc"><a href="http://www.ncbi.nlm.nih.gov/pubmed/16969737">Mechanisms
                                                            of injury in hypoxic-ischemic encephalopathy: implications
                                                            to therapy.</a></li>
</ul>
<ul class="bulleted-list" id="d51e5280-e055-4bca-8b2c-849e1363fa87">
<li style="list-style-type:disc"><a href="http://www.ncbi.nlm.nih.gov/pubmed/16443127">Mechanisms
                                                            of brain injury after global cerebral ischemia.</a></li>
</ul>
<p class="" id="5697e0e8-e8e1-45e7-a115-84a5557acc11">Pathology</p>
<p class="" id="6bdc336c-9fe8-4747-a37a-e23b24416947">Subject</p>
<p class="" id="d805d00c-bb5b-4f22-89ae-c573c76d91f9">Nervous System</p>
<p class="" id="2cf2b5fa-acb8-432a-ad88-71d59b0cef7d">System</p>
<p class="" id="d93b41f3-d9f5-42cd-92ac-09de72af966b">Ischemic stroke
                                                </p>
<p class="" id="90e605ce-c49e-4cab-adf9-338d621a7eb0">Topic</p>
<p class="" id="b6308c67-8b26-437e-b8a3-6ef93547bb92">Copyright ¬©
                                                    UWorld. All rights reserved.</p>
<p class="" id="a0cc7b04-8c3f-4c37-b8bb-2f0c3e5c3c59">My Notebook</p>
<p class="" id="ada23f5a-05f0-4bc7-9846-022be1518e17">0</p>
<p class="" id="7f59a696-5514-400b-be2b-2a7bd02c3085">Flashcards</p>
<p class="" id="7c8c374c-1029-4a3e-802f-a3389a796fe6">Feedback</p>
<p class="" id="161dbdb8-c7b1-40f8-b9e2-7165f40f708a">Suspend</p>
<p class="" id="12ae407a-2603-4df9-9203-1ef40ae36878">End Block</p>
<p class="" id="9c38729f-db27-4a6e-83b9-240d1daeed1f">‚ùåelementFinder:
                                                    //a[@href='javascript:void(0)']</p>
</details>
</li>
</ul>
</details>


















<style>
.bionic-reading-btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    height: 40px;
    background: rgba(255, 255, 255, 0.2);
    border: 2px solid rgba(255, 255, 255, 0.3);
    border-radius: 8px;
    color: white;
    font-size: 20px;
    cursor: pointer;
    transition: all 0.3s;
    margin-left: auto;
    flex-shrink: 0;
}

.bionic-reading-btn:hover {
    background: rgba(255, 255, 255, 0.35);
    border-color: rgba(255, 255, 255, 0.5);
    transform: scale(1.1);
}

.bionic-reading-btn.active {
    background: rgba(52, 168, 83, 0.4);
    border-color: rgba(52, 168, 83, 0.6);
}

.bionic-reading-btn.active:hover {
    background: rgba(52, 168, 83, 0.5);
}

summary {
    display: flex !important;
    align-items: center !important;
    gap: 12px !important;
}

    /* Highlighter styles */
    .highlighted {
        background-color: #ffeb3b !important;
        transition: background-color 0.2s ease !important;
    }

    .highlighter-btn {
        background: none !important;
        border: none !important;
        cursor: pointer !important;
        font-size: 20px !important;
        padding: 0 8px !important;
        margin-left: 8px !important;
        transition: transform 0.2s ease !important;
        vertical-align: middle !important;
    }

    .highlighter-btn:hover {
        transform: scale(1.2) !important;
    }

    .highlighter-btn.active {
        transform: scale(1.1) !important;
        filter: brightness(1.2) !important;
    }

    .highlighter-mode-active {
        cursor: text !important;
    }


    /* Right padding to avoid overlap with sidebar buttons */
    body {
        padding-right: 50px !important;
    }

    @media (max-width: 768px) {
        body {
            padding-right: 16px !important;
        }
    }

</style>



<script>
let bionicEnabled = false;
const originalContent = {};

function toggleBionicReading(event) {
    if (event) {
        event.preventDefault();
        event.stopPropagation();
    }

    bionicEnabled = !bionicEnabled;
    const btn = document.querySelector('.bionic-reading-btn');
    const icon = document.getElementById('bionicIcon');

    if (bionicEnabled) {
        btn.classList.add('active');
        icon.textContent = '‚úÖ';
        applyBionicReading();
    } else {
        btn.classList.remove('active');
        icon.textContent = 'üëÅÔ∏è';
        restoreOriginalText();
    }
}

function applyBionicReading() {
    // Seleciona todos os elementos de texto, EXCETO summary e buttons
    const textElements = document.querySelectorAll('p:not(summary p):not(button p), td:not(summary td):not(button td), li:not(summary li):not(button li)');

    textElements.forEach((element, index) => {
        // Ignora elementos que cont√™m outros elementos complexos
        if (element.querySelector('p, td, li, h1, h2, h3, h4, h5, h6, button, summary')) {
            return;
        }

        // Ignora se o elemento est√° dentro de um summary ou button
        if (element.closest('summary') || element.closest('button') || element.closest('.bionic-reading-btn')) {
            return;
        }

        // Salva o conte√∫do original
        if (!originalContent[index]) {
            originalContent[index] = {
                element: element,
                html: element.innerHTML
            };
        }

        // Aplica Bionic Reading
        const bionicText = convertToBionic(element.textContent);
        element.innerHTML = bionicText;
    });
}

function restoreOriginalText() {
    // Restaura o conte√∫do original
    Object.values(originalContent).forEach(item => {
        item.element.innerHTML = item.html;
    });
}

function convertToBionic(text) {
    // Divide o texto em palavras, mantendo pontua√ß√£o
    const words = text.split(/(\s+|[.,;:!?()""''\-‚Äì‚Äî])/);

    const bionicWords = words.map(word => {
        // Ignora espa√ßos e pontua√ß√£o
        if (word.match(/^\s+$/) || word.match(/^[.,;:!?()""''\-‚Äì‚Äî]+$/)) {
            return word;
        }

        // Ignora palavras muito curtas (1-2 letras)
        if (word.length <= 2) {
            return word;
        }

        // Determina quantas letras deixar em negrito (metade da palavra, arredondado para cima)
        const boldLength = Math.ceil(word.length / 2);

        // Separa a parte em negrito da parte normal
        const boldPart = word.substring(0, boldLength);
        const normalPart = word.substring(boldLength);

        // Retorna com a primeira parte em negrito
        return `<strong style="font-weight: 700 !important; color: inherit !important; background: none !important; padding: 0 !important;">${boldPart}</strong>${normalPart}`;
    });

    return bionicWords.join('');
}

// Adiciona atalho de teclado (Ctrl+B ou Cmd+B)
document.addEventListener('keydown', function(e) {
    if ((e.ctrlKey || e.metaKey) && e.key === 'b') {
        e.preventDefault();
        toggleBionicReading();
    }
});
</script>

<script>
    let highlighterActive = false;
    let questionHighlights = {};

    // Get question ID from the first summary strong tag
    function getQuestionId() {
        const firstSummary = document.querySelector('summary strong');
        return firstSummary ? firstSummary.textContent.trim() : '1';
    }

    // Load highlights from localStorage
    function loadHighlights() {
        const questionId = getQuestionId();
        const stored = localStorage.getItem('highlights_' + questionId);
        if (stored) {
            questionHighlights = JSON.parse(stored);
            applyStoredHighlights();
        }
    }

    // Save highlights to localStorage
    function saveHighlights() {
        const questionId = getQuestionId();
        localStorage.setItem('highlights_' + questionId, JSON.stringify(questionHighlights));
    }

    // Apply stored highlights
    function applyStoredHighlights() {
        Object.keys(questionHighlights).forEach(key => {
            const element = document.querySelector(`[data-highlight-id="${key}"]`);
            if (element && questionHighlights[key]) {
                element.classList.add('highlighted');
            }
        });
    }

    // Toggle highlighter mode
    function toggleHighlighter(event) {
        event.stopPropagation();
        highlighterActive = !highlighterActive;

        const btn = event.target.closest('.highlighter-btn');
        const icon = btn.querySelector('#highlighterIcon');

        if (highlighterActive) {
            btn.classList.add('active');
            icon.textContent = 'üñçÔ∏è';
            document.body.classList.add('highlighter-mode-active');
        } else {
            btn.classList.remove('active');
            icon.textContent = 'üñäÔ∏è';
            document.body.classList.remove('highlighter-mode-active');
        }
    }

    // Clear all highlights for this question
    function clearHighlights() {
        const questionId = getQuestionId();
        questionHighlights = {};
        localStorage.removeItem('highlights_' + questionId);
        document.querySelectorAll('.highlighted').forEach(el => {
            el.classList.remove('highlighted');
        });
    }

    // Handle text selection and highlighting
    document.addEventListener('mouseup', function(e) {
        if (!highlighterActive) return;

        const selection = window.getSelection();
        if (!selection.toString().trim()) return;

        const range = selection.getRangeAt(0);
        const container = range.commonAncestorContainer;

        // Only highlight text in paragraphs, not in buttons or other elements
        const paragraph = container.nodeType === 3 ? container.parentElement : container;
        if (paragraph.tagName !== 'P' && paragraph.tagName !== 'LI' && paragraph.tagName !== 'TD') {
            return;
        }

        // Create highlight span
        const span = document.createElement('span');
        span.classList.add('highlighted');

        // Generate unique ID for this highlight
        const highlightId = 'hl-' + Date.now() + '-' + Math.random().toString(36).substr(2, 9);
        span.setAttribute('data-highlight-id', highlightId);

        try {
            range.surroundContents(span);
            questionHighlights[highlightId] = true;
            saveHighlights();
        } catch (e) {
            console.log('Could not highlight selection');
        }

        selection.removeAllRanges();
    });

    // Load highlights when page loads
    window.addEventListener('load', loadHighlights);

    // Keyboard shortcut: Ctrl+H to toggle highlighter
    document.addEventListener('keydown', function(e) {
        if (e.ctrlKey && e.key === 'h') {
            e.preventDefault();
            const btn = document.querySelector('.highlighter-btn');
            if (btn) {
                toggleHighlighter({target: btn, stopPropagation: () => {}});
            }
        }
        // Ctrl+Shift+H to clear all highlights
        if (e.ctrlKey && e.shiftKey && e.key === 'H') {
            e.preventDefault();
            if (confirm('Clear all highlights for this question?')) {
                clearHighlights();
            }
        }
    });
</script>
