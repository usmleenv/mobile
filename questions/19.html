
<style>
    * {
        box-sizing: border-box !important;
    }

    body {
        font-family: 'Inter', 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif !important;
        line-height: 1.9 !important;
        color: #1f1f1f !important;
        max-width: none !important;
        margin: 0 !important;
        padding: 8px 16px 16px 16px !important;
        background: #ffffff !important;
        font-size: 16.5px !important;
    }

    p {
        margin-bottom: 20px !important;
        font-size: 16.5px !important;
        line-height: 1.95 !important;
        color: #1f1f1f !important;
        font-weight: 400 !important;
    }

    strong, b {
        color: #1a73e8 !important;
        font-weight: 700 !important;
        background: rgba(26, 115, 232, 0.08) !important;
        padding: 2px 6px !important;
        border-radius: 8px !important;
    }

    /* Details/Summary (collapsible sections) */
    details {
        background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%) !important;
        border-radius: 8px !important;
        padding: 24px 28px !important;
        margin: 24px 0 !important;
        border: none;
        box-shadow: none !important;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
    }

    details:hover {
        border-color: #1a73e8 !important;
        box-shadow: none !important;
        transform: translateY(-2px) !important;
    }

    details[open] {
        background: #ffffff !important;
        border-color: #1a73e8 !important;
        box-shadow: none !important;
    }

    summary {
        cursor: pointer !important;
        font-weight: 800 !important;
        color: #ffffff !important;
        font-size: 20px !important;
        padding: 16px 24px !important;
        border-radius: 8px !important;
        background: linear-gradient(135deg, #1a73e8 0%, #1557b0 100%) !important;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
        display: flex !important;
        align-items: center !important;
        user-select: none !important;
        box-shadow: none !important;
        letter-spacing: 0.5px !important;
    }

    summary:hover {
        background: linear-gradient(135deg, #1557b0 0%, #0d47a1 100%) !important;
        transform: translateX(6px) scale(1.02) !important;
        box-shadow: none !important;
    }

    summary:active {
        transform: translateX(4px) scale(0.99) !important;
    }

    summary::marker {
        color: rgba(255, 255, 255, 0.9) !important;
        font-size: 1.3em !important;
    }

    summary strong {
        background: rgba(255, 255, 255, 0.2) !important;
        color: #ffffff !important;
        padding: 4px 12px !important;
        border-radius: 8px !important;
        margin-left: 8px !important;
        font-size: 19px !important;
        letter-spacing: 1px !important;
    }

    /* Tables - Premium Design */
    table {
        width: 100% !important;
        border-collapse: separate !important;
        border-spacing: 0 !important;
        margin: 28px 0 !important;
        border-radius: 8px !important;
        overflow: hidden !important;
        box-shadow: none !important;
        border: none !important;
        background: #ffffff !important;
    }

    table.simple-table {
        background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%) !important;
    }

    table tr {
        transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1) !important;
        position: relative !important;
    }

    table tr:nth-child(odd) {
        background: rgba(248, 249, 250, 0.5) !important;
    }

    table tr:nth-child(even) {
        background: rgba(255, 255, 255, 0.8) !important;
    }

    table tr:hover {
        background: linear-gradient(90deg, #e8f0fe 0%, #f1f8ff 100%) !important;
        transform: translateX(4px) scale(1.01) !important;
        box-shadow: none !important;
        z-index: 1 !important;
    }

    table td {
        padding: 18px 24px !important;
        border-bottom: 1px solid rgba(232, 234, 237, 0.6) !important;
        font-size: 16.5px !important;
        line-height: 1.7 !important;
        color: #1f1f1f !important;
        vertical-align: middle !important;
    }

    table tr:last-child td {
        border-bottom: none !important;
    }

    /* First column (A, B, C, D, E) */
    table td:first-child {
        font-weight: 800 !important;
        color: #ffffff !important;
        width: 52px !important;
        text-align: center !important;
        font-size: 18px !important;
        background: linear-gradient(135deg, #1a73e8 0%, #1557b0 100%) !important;
        border-right: 3px solid #1557b0 !important;
        position: relative !important;
        letter-spacing: 0.5px !important;
    }

    table tr:hover td:first-child {
        background: linear-gradient(135deg, #1557b0 0%, #0d47a1 100%) !important;
        box-shadow: none !important;
    }

    /* Second column (content) */
    table td:nth-child(2) {
        font-weight: 500 !important;
        padding-left: 28px !important;
    }

    /* Third column (empty - hide it) */
    table td:last-child:empty {
        display: none !important;
    }

    /* Lists */
    ul, ol {
        margin: 16px 0 !important;
        padding-left: 32px !important;
    }

    li {
        margin: 10px 0 !important;
        line-height: 1.8 !important;
        color: #1f1f1f !important;
    }

    ul.bulleted-list li {
        position: relative !important;
        padding-left: 8px !important;
    }

    ul.toggle {
        list-style: none !important;
        padding-left: 0 !important;
    }

    /* Links */
    a {
        color: #1a73e8 !important;
        text-decoration: none !important;
        font-weight: 600 !important;
        border-bottom: 2px solid transparent !important;
        transition: all 0.2s !important;
    }

    a:hover {
        border-bottom-color: #1a73e8 !important;
        background: rgba(26,115,232,0.08) !important;
        padding: 2px 4px !important;
        border-radius: 8px !important;
    }

    /* Images & Media */
    img, video {
        max-width: none !important;
        height: auto !important;
        border-radius: 8px !important;
        box-shadow: none !important;
        margin: 24px 0 !important;
        display: block !important;
        border: none !important;
    }

    img:hover, video:hover {
        box-shadow: none !important;
        border-color: #1a73e8 !important;
    }

    /* Code blocks (if any) */
    code {
        background: #f1f3f4 !important;
        padding: 2px 8px !important;
        border-radius: 8px !important;
        font-family: 'Courier New', monospace !important;
        font-size: 14px !important;
        color: #d93025 !important;
    }

    pre {
        background: #f8f9fa !important;
        padding: 8px 16px 16px 16px !important;
        border-radius: 8px !important;
        overflow-x: auto !important;
        border-left: 4px solid #1a73e8 !important;
    }

    /* Headings */
    h1, h2, h3, h4, h5, h6 {
        color: #1a73e8 !important;
        font-weight: 700 !important;
        margin-top: 24px !important;
        margin-bottom: 16px !important;
        line-height: 1.4 !important;
    }

    h1 { font-size: 32px !important; }
    h2 { font-size: 26px !important; }
    h3 { font-size: 22px !important; }
    h4 { font-size: 19px !important; }

    /* Blockquotes */
    blockquote {
        border-left: 4px solid #1a73e8 !important;
        padding-left: 20px !important;
        margin: 20px 0 !important;
        font-style: italic !important;
        color: #5f6368 !important;
        background: #f8f9fa !important;
        padding: 16px 20px !important;
        border-radius: 8px !important;
    }

    /* Horizontal Rule */
    hr {
        border: none !important;
        height: 2px !important;
        background: linear-gradient(to right, transparent, #1a73e8, transparent) !important;
        margin: 32px 0 !important;
    }

    /* Selection */
    ::selection {
        background: #e8f0fe !important;
        color: #1a73e8 !important;
    }

    /* Highlighter styles */
    .highlighted {
        background-color: #ffeb3b !important;
        transition: background-color 0.2s ease !important;
    }

    .highlighter-btn {
        background: none !important;
        border: none !important;
        cursor: pointer !important;
        font-size: 20px !important;
        padding: 0 8px !important;
        margin-left: 8px !important;
        transition: transform 0.2s ease !important;
        vertical-align: middle !important;
    }

    .highlighter-btn:hover {
        transform: scale(1.2) !important;
    }

    .highlighter-btn.active {
        transform: scale(1.1) !important;
        filter: brightness(1.2) !important;
    }

    .highlighter-mode-active {
        cursor: text !important;
    }


    /* Right padding to avoid overlap with sidebar buttons */
    body {
        padding-right: 50px !important;
    }

    @media (max-width: 768px) {
        body {
            padding-right: 16px !important;
        }
    }

</style>




<details open>
<summary><strong>19</strong><button class="bionic-reading-btn" onclick="toggleBionicReading(event)" title="Toggle Bionic Reading (Ctrl+B)"><span id="bionicIcon">üëÅÔ∏è</span></button><button class="highlighter-btn" onclick="toggleHighlighter(event)" title="Toggle Highlighter (Ctrl+H)"><span id="highlighterIcon">üñäÔ∏è</span></button></summary>
<p class="" id="84b1bfb1-26c7-48df-8db8-615711a18967">An 82-year-old man is found
                                        unresponsive by his neighbor.  The patient lives alone in his suburban home. 
                                        When the neighbor went to check on him, the patient was on the floor and not
                                        answering any questions.  His medical history is unknown.  On arrival of
                                        emergency medical services, the patient is obtunded and responds only to painful
                                        stimuli.  Supportive measures are begun, including endotracheal intubation, but
                                        the patient dies en route to the hospital.  Autopsy reveals extensive
                                        atherosclerotic disease involving the coronary and internal carotid arteries. 
                                        Histopathologic examination of the brain in the right middle cerebral artery
                                        territory shows neurons with intensely eosinophilic cytoplasm and nuclear
                                        fragmentation.  Based on these findings, this patient's cerebral injury
                                        most likely occurred approximately how long ago?</p>
<table class="simple-table" id="393f63f4-caae-495d-b759-14bfa15913d1">
<tbody>
<tr id="b6ded9a7-0496-4646-a309-06a86db720fa">
<td class="" id="fkqP">A.</td>
<td class="" id="Gsi_">Less than an hour</td>
<td class="" id="s:Um"></td>
</tr>
<tr id="96a364f5-55a4-4b52-b63d-9d150586f74a">
<td class="" id="fkqP">B.</td>
<td class="" id="Gsi_">12-24 hours</td>
<td class="" id="s:Um"></td>
</tr>
<tr id="d6571d60-b17f-4ef7-b03f-67a5515f54f8">
<td class="" id="fkqP">C.</td>
<td class="" id="Gsi_">1-2 weeks</td>
<td class="" id="s:Um"></td>
</tr>
<tr id="cf27c4a9-2ad1-48f2-a513-ebf7cc89ce0e">
<td class="" id="fkqP">D.</td>
<td class="" id="Gsi_">2 months</td>
<td class="" id="s:Um"></td>
</tr>
<tr id="8a9379f9-2320-417b-9059-a744af4a7903">
<td class="" id="fkqP">E.</td>
<td class="" id="Gsi_">2 years</td>
<td class="" id="s:Um"></td>
</tr>
</tbody>
</table>
<ul class="toggle" id="9de9f26c-144c-4862-9741-10f67d641aa4">
<li>
<details>
<summary>Submit</summary>
<table class="simple-table" id="11ff42cd-9f8d-4785-8274-e4fbb9ccd12d">
<tbody>
<tr id="1c0949df-2994-4249-beaa-fcf7dfeda48e">
<td class="" id="FCSm">A.</td>
<td class="" id="Y`;M">Less than an hour (11%)</td>
<td class="" id="h:si"></td>
</tr>
<tr id="92dc248f-9c94-47f6-9405-e63a279b57d4">
<td class="" id="FCSm">B.</td>
<td class="" id="Y`;M">12-24 hours (80%)</td>
<td class="" id="h:si"></td>
</tr>
<tr id="c088ed28-13b7-4b4d-9d24-79e49ea535fa">
<td class="" id="FCSm">C.</td>
<td class="" id="Y`;M">1-2 weeks (6%)</td>
<td class="" id="h:si"></td>
</tr>
<tr id="b8ae68b7-8064-4682-86a7-a8b95f4340e2">
<td class="" id="FCSm">D.</td>
<td class="" id="Y`;M">2 months (0%)</td>
<td class="" id="h:si"></td>
</tr>
<tr id="5a5da44c-9781-4c54-b2f3-9b6a4747a081">
<td class="" id="FCSm">E.</td>
<td class="" id="Y`;M">2 years (0%)</td>
<td class="" id="h:si"></td>
</tr>
</tbody>
</table>
<p class="" id="d09bb28f-dde0-458f-b046-10687920a48e">Incorrect</p>
<p class="" id="9c5ec27c-f3c0-4a23-a712-1227241e6dd7">Correct answer B
                                                </p>
<p class="" id="dd3bd852-da16-4459-91b6-4c8965af8041">80%Answered
                                                    correctly</p>
<p class="" id="bcf87fa5-85d8-4d40-b415-03477923b72f">19 secsTime Spent
                                                </p>
<p class="" id="936928c9-b03a-43d8-9292-7e64ec648f5a">2024Version</p>
<ul class="bulleted-list" id="700f9788-584c-4862-9dcd-e87adf642914">
<li style="list-style-type:disc">Explanation</li>
</ul>
<ul class="bulleted-list" id="150d4efb-0669-4cee-86f9-3a6990b7c4f1">
<li style="list-style-type:disc"></li>
</ul>
<table class="simple-table" id="1f92dfc9-1058-466f-adf0-4deef107ce82">
<tbody>
<tr id="a182139e-fd69-4603-97b7-0f7e9ac91dfd">
<td class="" id="PSO;">Ischemic stroke</td>
<td class="" id="u`Si"></td>
<td class="" id="ITXm"></td>
</tr>
<tr id="8ec4dab9-e309-4a9f-99c3-4637183dc5d6">
<td class="" id="PSO;">Time after injury</td>
<td class="" id="u`Si">Microscopic changes</td>
<td class="" id="ITXm">Macroscopic changes</td>
</tr>
<tr id="04bedd6f-49ce-42b8-8357-06001829a41f">
<td class="" id="PSO;">12-24 hours</td>
<td class="" id="u`Si">Red neurons (eosinophilic cytoplasm,
                                                                pyknotic nuclei, loss of Nissl substance)</td>
<td class="" id="ITXm"></td>
</tr>
<tr id="33f8d40f-150a-42ce-8881-490210832ad1">
<td class="" id="PSO;">24-72 hours</td>
<td class="" id="u`Si">Neutrophilic infiltration</td>
<td class="" id="ITXm"></td>
</tr>
<tr id="d5497095-ee7e-4243-9db6-45109684b723">
<td class="" id="PSO;">3-7 days</td>
<td class="" id="u`Si">Macrophage/microglia infiltration
                                                                &amp; phagocytosis begins</td>
<td class="" id="ITXm"></td>
</tr>
<tr id="41ab6bda-5266-4263-9457-edf1eb81f33f">
<td class="" id="PSO;">1-2 weeks</td>
<td class="" id="u`Si">Reactive gliosis &amp; vascular
                                                                proliferation around the necrotic area</td>
<td class="" id="ITXm">Liquefactive necrosis (1 week-1
                                                                month)</td>
</tr>
<tr id="c5e9bcea-ad3e-4efa-9eb2-7a46d96735f7">
<td class="" id="PSO;">&gt;2 weeks</td>
<td class="" id="u`Si">Glial scar formation</td>
<td class="" id="ITXm">Cystic area surrounded by dense glial
                                                                fibers (&gt;1 month)</td>
</tr>
</tbody>
</table>
<p class="" id="0aedbb18-e1f3-47e5-ace0-970dd3f44e96">This patient was
                                                    found unconscious, in rapid hemodynamic decline, an unknown amount
                                                    of time after an inciting cardiovascular event.  The autopsy
                                                    demonstrates histopathologic evidence of ischemic stroke caused by
                                                    widespread atherosclerosis.  Sustained interruption in blood
                                                    circulation to branches of the internal carotid arteries (eg, middle
                                                    cerebral artery) can lead to tissue hypoxia and irreversible
                                                    cellular injury with characteristic microscopic and macroscopic
                                                    changes.</p>
<p class="" id="8035565a-d0bf-46b8-8075-9259701a3360">Specific findings
                                                    vary with time but follow a predictable course.  Red neurons are
                                                    typically seen 12-24 hours after irreversible ischemic injury and
                                                    are characterized by intense eosinophilic staining of the cytoplasm
                                                    due to dissolution of Nissl bodies (basophilic granules consisting
                                                    of rough endoplasmic reticulum and ribosomes).  The nuclei also
                                                    become pyknotic (eg, shrunken and deeply basophilic) and undergo
                                                    fragmentation (karyorrhexis).  After about a day, the tissue damage
                                                    promotes neutrophil infiltration, followed by macrophage/microglial
                                                    recruitment a few days later.</p>
<p class="" id="47efd21e-d1b2-4d61-8af0-b8fc0c09c671">(Choice A)  There
                                                    is typically little change in the microscopic or macroscopic
                                                    appearance of brain tissue &lt;1 hour after irreversible ischemic
                                                    injury.</p>
<p class="" id="0f7be881-8c60-4b86-a447-1d0b85d4c121">(Choice C)  At 1-2
                                                    weeks, there will be robust phagocytosis of neuron and myelin
                                                    breakdown products by activated macrophages/microglia.  Around this
                                                    time, astrocytes start proliferating with the development of a
                                                    network of cytoplasmic extensions (reactive gliosis), and new
                                                    vessels are formed in the periphery of the necrotic area.</p>
<p class="" id="3c02f1cc-5d66-4db2-a10d-32f18ce3bc34">(Choices D and E) 
                                                    Several months to years after brain infarction, the necrotic area
                                                    appears as a cystic cavity surrounded by a wall of dense fibers
                                                    formed by astrocytic processes (glial scar).</p>
<p class="" id="3069fb7f-ce6f-40b3-b1d8-fe5951628222">Educational
                                                    objective:</p>
<p class="" id="830554d2-c4e0-4cdb-84f2-cd9446a43afb">Inadequate blood
                                                    supply to the brain (eg, arterial thrombosis or embolism) leads to
                                                    ischemic stroke.  The first microscopic changes are typically seen
                                                    12-24 hours after irreversible ischemic injury and include intense
                                                    eosinophilic staining of the neuronal cytoplasm (red neurons) and
                                                    nuclear fragmentation.</p>
<p class="" id="df7eb059-a80f-4921-86a8-ea7c7a29e2bf">References</p>
<ul class="bulleted-list" id="98788614-b615-4286-bc0b-8992c7091902">
<li style="list-style-type:disc"><a href="http://www.ncbi.nlm.nih.gov/pubmed/19690757">Histopathological
                                                            changes in acute ischemic stroke.</a></li>
</ul>
<p class="" id="cf0ba460-0550-410f-937b-c32a2874165d">Pathology</p>
<p class="" id="f77571dd-1c13-46b0-9716-4d4c858e4690">Subject</p>
<p class="" id="2791f635-a255-4903-afca-f163863bd9e8">Nervous System</p>
<p class="" id="53c1cc9a-8703-429b-b224-398f8f7f6f24">System</p>
<p class="" id="aca3490c-7e49-49bd-a67b-cd563b23412c">Ischemic stroke
                                                </p>
<p class="" id="23dfc134-1322-45de-8b0f-6c6909a1e5d7">Topic</p>
<p class="" id="c0cd932c-7241-47b6-a1a2-e9e1f7ffa19a">Copyright ¬©
                                                    UWorld. All rights reserved.</p>
<p class="" id="7fc1d08c-3ef8-478a-8717-563a890e9243">My Notebook</p>
<p class="" id="892425f3-86c7-426a-8034-da9edf76c506">0</p>
<p class="" id="b461e957-8623-419b-865c-1290ecaf87a8">Flashcards</p>
<p class="" id="d7949dd0-3027-4bc1-b967-67d62de3145f">Feedback</p>
<p class="" id="a56b978c-2e7c-43b5-b784-402c8caf3488">Suspend</p>
<p class="" id="206738a1-6089-4531-9fe8-e40b67e7020d">End Block</p>
<p class="" id="1ae18b8c-3ad9-42db-b92a-112fae2d337b">‚ùåüÖ±Ô∏è1üÖ∞Ô∏è1üîç1 ~üïí1
                                                    sec</p>
</details>
</li>
</ul>
</details>


















<style>
.bionic-reading-btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    height: 40px;
    background: rgba(255, 255, 255, 0.2);
    border: 2px solid rgba(255, 255, 255, 0.3);
    border-radius: 8px;
    color: white;
    font-size: 20px;
    cursor: pointer;
    transition: all 0.3s;
    margin-left: auto;
    flex-shrink: 0;
}

.bionic-reading-btn:hover {
    background: rgba(255, 255, 255, 0.35);
    border-color: rgba(255, 255, 255, 0.5);
    transform: scale(1.1);
}

.bionic-reading-btn.active {
    background: rgba(52, 168, 83, 0.4);
    border-color: rgba(52, 168, 83, 0.6);
}

.bionic-reading-btn.active:hover {
    background: rgba(52, 168, 83, 0.5);
}

summary {
    display: flex !important;
    align-items: center !important;
    gap: 12px !important;
}

    /* Highlighter styles */
    .highlighted {
        background-color: #ffeb3b !important;
        transition: background-color 0.2s ease !important;
    }

    .highlighter-btn {
        background: none !important;
        border: none !important;
        cursor: pointer !important;
        font-size: 20px !important;
        padding: 0 8px !important;
        margin-left: 8px !important;
        transition: transform 0.2s ease !important;
        vertical-align: middle !important;
    }

    .highlighter-btn:hover {
        transform: scale(1.2) !important;
    }

    .highlighter-btn.active {
        transform: scale(1.1) !important;
        filter: brightness(1.2) !important;
    }

    .highlighter-mode-active {
        cursor: text !important;
    }


    /* Right padding to avoid overlap with sidebar buttons */
    body {
        padding-right: 50px !important;
    }

    @media (max-width: 768px) {
        body {
            padding-right: 16px !important;
        }
    }

</style>



<script>
let bionicEnabled = false;
const originalContent = {};

function toggleBionicReading(event) {
    if (event) {
        event.preventDefault();
        event.stopPropagation();
    }

    bionicEnabled = !bionicEnabled;
    const btn = document.querySelector('.bionic-reading-btn');
    const icon = document.getElementById('bionicIcon');

    if (bionicEnabled) {
        btn.classList.add('active');
        icon.textContent = '‚úÖ';
        applyBionicReading();
    } else {
        btn.classList.remove('active');
        icon.textContent = 'üëÅÔ∏è';
        restoreOriginalText();
    }
}

function applyBionicReading() {
    // Seleciona todos os elementos de texto, EXCETO summary e buttons
    const textElements = document.querySelectorAll('p:not(summary p):not(button p), td:not(summary td):not(button td), li:not(summary li):not(button li)');

    textElements.forEach((element, index) => {
        // Ignora elementos que cont√™m outros elementos complexos
        if (element.querySelector('p, td, li, h1, h2, h3, h4, h5, h6, button, summary')) {
            return;
        }

        // Ignora se o elemento est√° dentro de um summary ou button
        if (element.closest('summary') || element.closest('button') || element.closest('.bionic-reading-btn')) {
            return;
        }

        // Salva o conte√∫do original
        if (!originalContent[index]) {
            originalContent[index] = {
                element: element,
                html: element.innerHTML
            };
        }

        // Aplica Bionic Reading
        const bionicText = convertToBionic(element.textContent);
        element.innerHTML = bionicText;
    });
}

function restoreOriginalText() {
    // Restaura o conte√∫do original
    Object.values(originalContent).forEach(item => {
        item.element.innerHTML = item.html;
    });
}

function convertToBionic(text) {
    // Divide o texto em palavras, mantendo pontua√ß√£o
    const words = text.split(/(\s+|[.,;:!?()""''\-‚Äì‚Äî])/);

    const bionicWords = words.map(word => {
        // Ignora espa√ßos e pontua√ß√£o
        if (word.match(/^\s+$/) || word.match(/^[.,;:!?()""''\-‚Äì‚Äî]+$/)) {
            return word;
        }

        // Ignora palavras muito curtas (1-2 letras)
        if (word.length <= 2) {
            return word;
        }

        // Determina quantas letras deixar em negrito (metade da palavra, arredondado para cima)
        const boldLength = Math.ceil(word.length / 2);

        // Separa a parte em negrito da parte normal
        const boldPart = word.substring(0, boldLength);
        const normalPart = word.substring(boldLength);

        // Retorna com a primeira parte em negrito
        return `<strong style="font-weight: 700 !important; color: inherit !important; background: none !important; padding: 0 !important;">${boldPart}</strong>${normalPart}`;
    });

    return bionicWords.join('');
}

// Adiciona atalho de teclado (Ctrl+B ou Cmd+B)
document.addEventListener('keydown', function(e) {
    if ((e.ctrlKey || e.metaKey) && e.key === 'b') {
        e.preventDefault();
        toggleBionicReading();
    }
});
</script>

<script>
    let highlighterActive = false;
    let questionHighlights = {};

    // Get question ID from the first summary strong tag
    function getQuestionId() {
        const firstSummary = document.querySelector('summary strong');
        return firstSummary ? firstSummary.textContent.trim() : '1';
    }

    // Load highlights from localStorage
    function loadHighlights() {
        const questionId = getQuestionId();
        const stored = localStorage.getItem('highlights_' + questionId);
        if (stored) {
            questionHighlights = JSON.parse(stored);
            applyStoredHighlights();
        }
    }

    // Save highlights to localStorage
    function saveHighlights() {
        const questionId = getQuestionId();
        localStorage.setItem('highlights_' + questionId, JSON.stringify(questionHighlights));
    }

    // Apply stored highlights
    function applyStoredHighlights() {
        Object.keys(questionHighlights).forEach(key => {
            const element = document.querySelector(`[data-highlight-id="${key}"]`);
            if (element && questionHighlights[key]) {
                element.classList.add('highlighted');
            }
        });
    }

    // Toggle highlighter mode
    function toggleHighlighter(event) {
        event.stopPropagation();
        highlighterActive = !highlighterActive;

        const btn = event.target.closest('.highlighter-btn');
        const icon = btn.querySelector('#highlighterIcon');

        if (highlighterActive) {
            btn.classList.add('active');
            icon.textContent = 'üñçÔ∏è';
            document.body.classList.add('highlighter-mode-active');
        } else {
            btn.classList.remove('active');
            icon.textContent = 'üñäÔ∏è';
            document.body.classList.remove('highlighter-mode-active');
        }
    }

    // Clear all highlights for this question
    function clearHighlights() {
        const questionId = getQuestionId();
        questionHighlights = {};
        localStorage.removeItem('highlights_' + questionId);
        document.querySelectorAll('.highlighted').forEach(el => {
            el.classList.remove('highlighted');
        });
    }

    // Handle text selection and highlighting
    document.addEventListener('mouseup', function(e) {
        if (!highlighterActive) return;

        const selection = window.getSelection();
        if (!selection.toString().trim()) return;

        const range = selection.getRangeAt(0);
        const container = range.commonAncestorContainer;

        // Only highlight text in paragraphs, not in buttons or other elements
        const paragraph = container.nodeType === 3 ? container.parentElement : container;
        if (paragraph.tagName !== 'P' && paragraph.tagName !== 'LI' && paragraph.tagName !== 'TD') {
            return;
        }

        // Create highlight span
        const span = document.createElement('span');
        span.classList.add('highlighted');

        // Generate unique ID for this highlight
        const highlightId = 'hl-' + Date.now() + '-' + Math.random().toString(36).substr(2, 9);
        span.setAttribute('data-highlight-id', highlightId);

        try {
            range.surroundContents(span);
            questionHighlights[highlightId] = true;
            saveHighlights();
        } catch (e) {
            console.log('Could not highlight selection');
        }

        selection.removeAllRanges();
    });

    // Load highlights when page loads
    window.addEventListener('load', loadHighlights);

    // Keyboard shortcut: Ctrl+H to toggle highlighter
    document.addEventListener('keydown', function(e) {
        if (e.ctrlKey && e.key === 'h') {
            e.preventDefault();
            const btn = document.querySelector('.highlighter-btn');
            if (btn) {
                toggleHighlighter({target: btn, stopPropagation: () => {}});
            }
        }
        // Ctrl+Shift+H to clear all highlights
        if (e.ctrlKey && e.shiftKey && e.key === 'H') {
            e.preventDefault();
            if (confirm('Clear all highlights for this question?')) {
                clearHighlights();
            }
        }
    });
</script>
