
<style>
    * {
        box-sizing: border-box !important;
    }

    body {
        font-family: 'Inter', 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif !important;
        line-height: 1.9 !important;
        color: #1f1f1f !important;
        max-width: none !important;
        margin: 0 !important;
        padding: 8px 16px 16px 16px !important;
        background: #ffffff !important;
        font-size: 16.5px !important;
    }

    p {
        margin-bottom: 20px !important;
        font-size: 16.5px !important;
        line-height: 1.95 !important;
        color: #1f1f1f !important;
        font-weight: 400 !important;
    }

    strong, b {
        color: #1a73e8 !important;
        font-weight: 700 !important;
        background: rgba(26, 115, 232, 0.08) !important;
        padding: 2px 6px !important;
        border-radius: 8px !important;
    }

    /* Details/Summary (collapsible sections) */
    details {
        background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%) !important;
        border-radius: 8px !important;
        padding: 24px 28px !important;
        margin: 24px 0 !important;
        border: none;
        box-shadow: none !important;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
    }

    details:hover {
        border-color: #1a73e8 !important;
        box-shadow: none !important;
        transform: translateY(-2px) !important;
    }

    details[open] {
        background: #ffffff !important;
        border-color: #1a73e8 !important;
        box-shadow: none !important;
    }

    summary {
        cursor: pointer !important;
        font-weight: 800 !important;
        color: #ffffff !important;
        font-size: 20px !important;
        padding: 16px 24px !important;
        border-radius: 8px !important;
        background: linear-gradient(135deg, #1a73e8 0%, #1557b0 100%) !important;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
        display: flex !important;
        align-items: center !important;
        user-select: none !important;
        box-shadow: none !important;
        letter-spacing: 0.5px !important;
    }

    summary:hover {
        background: linear-gradient(135deg, #1557b0 0%, #0d47a1 100%) !important;
        transform: translateX(6px) scale(1.02) !important;
        box-shadow: none !important;
    }

    summary:active {
        transform: translateX(4px) scale(0.99) !important;
    }

    summary::marker {
        color: rgba(255, 255, 255, 0.9) !important;
        font-size: 1.3em !important;
    }

    summary strong {
        background: rgba(255, 255, 255, 0.2) !important;
        color: #ffffff !important;
        padding: 4px 12px !important;
        border-radius: 8px !important;
        margin-left: 8px !important;
        font-size: 19px !important;
        letter-spacing: 1px !important;
    }

    /* Tables - Premium Design */
    table {
        width: 100% !important;
        border-collapse: separate !important;
        border-spacing: 0 !important;
        margin: 28px 0 !important;
        border-radius: 8px !important;
        overflow: hidden !important;
        box-shadow: none !important;
        border: none !important;
        background: #ffffff !important;
    }

    table.simple-table {
        background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%) !important;
    }

    table tr {
        transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1) !important;
        position: relative !important;
    }

    table tr:nth-child(odd) {
        background: rgba(248, 249, 250, 0.5) !important;
    }

    table tr:nth-child(even) {
        background: rgba(255, 255, 255, 0.8) !important;
    }

    table tr:hover {
        background: linear-gradient(90deg, #e8f0fe 0%, #f1f8ff 100%) !important;
        transform: translateX(4px) scale(1.01) !important;
        box-shadow: none !important;
        z-index: 1 !important;
    }

    table td {
        padding: 18px 24px !important;
        border-bottom: 1px solid rgba(232, 234, 237, 0.6) !important;
        font-size: 16.5px !important;
        line-height: 1.7 !important;
        color: #1f1f1f !important;
        vertical-align: middle !important;
    }

    table tr:last-child td {
        border-bottom: none !important;
    }

    /* First column (A, B, C, D, E) */
    table td:first-child {
        font-weight: 800 !important;
        color: #ffffff !important;
        width: 52px !important;
        text-align: center !important;
        font-size: 18px !important;
        background: linear-gradient(135deg, #1a73e8 0%, #1557b0 100%) !important;
        border-right: 3px solid #1557b0 !important;
        position: relative !important;
        letter-spacing: 0.5px !important;
    }

    table tr:hover td:first-child {
        background: linear-gradient(135deg, #1557b0 0%, #0d47a1 100%) !important;
        box-shadow: none !important;
    }

    /* Second column (content) */
    table td:nth-child(2) {
        font-weight: 500 !important;
        padding-left: 28px !important;
    }

    /* Third column (empty - hide it) */
    table td:last-child:empty {
        display: none !important;
    }

    /* Lists */
    ul, ol {
        margin: 16px 0 !important;
        padding-left: 32px !important;
    }

    li {
        margin: 10px 0 !important;
        line-height: 1.8 !important;
        color: #1f1f1f !important;
    }

    ul.bulleted-list li {
        position: relative !important;
        padding-left: 8px !important;
    }

    ul.toggle {
        list-style: none !important;
        padding-left: 0 !important;
    }

    /* Links */
    a {
        color: #1a73e8 !important;
        text-decoration: none !important;
        font-weight: 600 !important;
        border-bottom: 2px solid transparent !important;
        transition: all 0.2s !important;
    }

    a:hover {
        border-bottom-color: #1a73e8 !important;
        background: rgba(26,115,232,0.08) !important;
        padding: 2px 4px !important;
        border-radius: 8px !important;
    }

    /* Images & Media */
    img, video {
        max-width: none !important;
        height: auto !important;
        border-radius: 8px !important;
        box-shadow: none !important;
        margin: 24px 0 !important;
        display: block !important;
        border: none !important;
    }

    img:hover, video:hover {
        box-shadow: none !important;
        border-color: #1a73e8 !important;
    }

    /* Code blocks (if any) */
    code {
        background: #f1f3f4 !important;
        padding: 2px 8px !important;
        border-radius: 8px !important;
        font-family: 'Courier New', monospace !important;
        font-size: 14px !important;
        color: #d93025 !important;
    }

    pre {
        background: #f8f9fa !important;
        padding: 8px 16px 16px 16px !important;
        border-radius: 8px !important;
        overflow-x: auto !important;
        border-left: 4px solid #1a73e8 !important;
    }

    /* Headings */
    h1, h2, h3, h4, h5, h6 {
        color: #1a73e8 !important;
        font-weight: 700 !important;
        margin-top: 24px !important;
        margin-bottom: 16px !important;
        line-height: 1.4 !important;
    }

    h1 { font-size: 32px !important; }
    h2 { font-size: 26px !important; }
    h3 { font-size: 22px !important; }
    h4 { font-size: 19px !important; }

    /* Blockquotes */
    blockquote {
        border-left: 4px solid #1a73e8 !important;
        padding-left: 20px !important;
        margin: 20px 0 !important;
        font-style: italic !important;
        color: #5f6368 !important;
        background: #f8f9fa !important;
        padding: 16px 20px !important;
        border-radius: 8px !important;
    }

    /* Horizontal Rule */
    hr {
        border: none !important;
        height: 2px !important;
        background: linear-gradient(to right, transparent, #1a73e8, transparent) !important;
        margin: 32px 0 !important;
    }

    /* Selection */
    ::selection {
        background: #e8f0fe !important;
        color: #1a73e8 !important;
    }

    /* Highlighter styles */
    .highlighted {
        background-color: #ffeb3b !important;
        transition: background-color 0.2s ease !important;
    }

    .highlighter-btn {
        background: none !important;
        border: none !important;
        cursor: pointer !important;
        font-size: 20px !important;
        padding: 0 8px !important;
        margin-left: 8px !important;
        transition: transform 0.2s ease !important;
        vertical-align: middle !important;
    }

    .highlighter-btn:hover {
        transform: scale(1.2) !important;
    }

    .highlighter-btn.active {
        transform: scale(1.1) !important;
        filter: brightness(1.2) !important;
    }

    .highlighter-mode-active {
        cursor: text !important;
    }


    /* Right padding to avoid overlap with sidebar buttons */
    body {
        padding-right: 50px !important;
    }

    @media (max-width: 768px) {
        body {
            padding-right: 16px !important;
        }
    }

</style>




<details open>
<summary><strong>19734</strong><button class="bionic-reading-btn" onclick="toggleBionicReading(event)" title="Toggle Bionic Reading (Ctrl+B)"><span id="bionicIcon">üëÅÔ∏è</span></button><button class="highlighter-btn" onclick="toggleHighlighter(event)" title="Toggle Highlighter (Ctrl+H)"><span id="highlighterIcon">üñäÔ∏è</span></button></summary>
<p class="" id="9a8147d3-03e8-48ac-a7d8-8b0b0833c7cb">A physician is conducting a
                                        double-blind randomized controlled trial to determine the effect of a new cream
                                        in reducing the risk of relapse in chronic recurrent atopic dermatitis.  A total
                                        of 30 patients with moderate to severe atopic dermatitis who were experiencing a
                                        flare are randomly divided into 2 groups: 15 patients will receive the new
                                        cream, and 15 patients will receive emollient alone.  The rate of relapse after
                                        2 weeks of treatment is 25% in the group who received the new cream and 50% in
                                        the group who received emollient alone.  However, the difference is found to be
                                        not statistically significant (<em>p</em> = 0.14).  The physician concludes that
                                        use of the new cream does not reduce the risk of relapse in chronic recurrent
                                        atopic dermatitis.  Which of the following is most likely to explain the results
                                        of the study?</p>
<table class="simple-table" id="1b0c0b5e-4460-49c0-a22c-a0585226cb37">
<tbody>
<tr id="a5351573-a760-4687-9f6b-2c16088c4256">
<td class="" id="t]tC">A.</td>
<td class="" id="Bj?a">Ascertainment bias</td>
<td class="" id="Pr{{"></td>
</tr>
<tr id="34862d3c-e283-4fa0-baaf-64eaebdb9944">
<td class="" id="t]tC">B.</td>
<td class="" id="Bj?a">Confounding bias</td>
<td class="" id="Pr{{"></td>
</tr>
<tr id="ebea2e1e-0467-495a-a491-debe82b3e267">
<td class="" id="t]tC">C.</td>
<td class="" id="Bj?a">Ecologic fallacy</td>
<td class="" id="Pr{{"></td>
</tr>
<tr id="bd36bdb4-0633-4dab-abd1-5252610c1224">
<td class="" id="t]tC">D.</td>
<td class="" id="Bj?a">Insufficient statistical power</td>
<td class="" id="Pr{{"></td>
</tr>
<tr id="6f6eeb5e-96b9-40bc-bf7c-01eca24ba534">
<td class="" id="t]tC">E.</td>
<td class="" id="Bj?a">Recall bias</td>
<td class="" id="Pr{{"></td>
</tr>
</tbody>
</table>
<ul class="toggle" id="d27ba96c-4b57-4f63-9a24-a69203f8f812">
<li>
<details>
<summary>Submit</summary>
<p class="" id="e71dea75-1712-41de-a199-c1caea8de656">A physician is
                                                    conducting a double-blind randomized controlled trial to determine
                                                    the effect of a new cream in reducing the risk of relapse in chronic
                                                    recurrent atopic dermatitis.  A total of 30 patients with moderate
                                                    to severe atopic dermatitis who were experiencing a flare are
                                                    randomly divided into 2 groups: 15 patients will receive the new
                                                    cream, and 15 patients will receive emollient alone.  The rate of
                                                    relapse after 2 weeks of treatment is 25% in the group who received
                                                    the new cream and 50% in the group who received emollient alone. 
                                                    However, the difference is found to be not statistically significant
                                                    (<em>p</em> = 0.14).  The physician concludes that use of the new
                                                    cream does not reduce the risk of relapse in chronic recurrent
                                                    atopic dermatitis.  Which of the following is most likely to explain
                                                    the results of the study?</p>
<table class="simple-table" id="3ab6e03b-7494-4dec-bdaf-b36ee1a9e6f0">
<tbody>
<tr id="33cf6cd6-3bd6-4fac-97a1-363d8645057c">
<td class="" id=":XNY">A.</td>
<td class="" id="dfYW">Ascertainment bias (3%)</td>
<td class="" id="W_zO"></td>
</tr>
<tr id="259392fa-5809-44a8-8c40-0281aaaa0063">
<td class="" id=":XNY">B.</td>
<td class="" id="dfYW">Confounding bias (7%)</td>
<td class="" id="W_zO"></td>
</tr>
<tr id="4bd788de-4a91-42fa-a6c3-fe417796fc60">
<td class="" id=":XNY">C.</td>
<td class="" id="dfYW">Ecologic fallacy (1%)</td>
<td class="" id="W_zO"></td>
</tr>
<tr id="7f6dd0e4-23b0-447b-9885-7a04998f5b87">
<td class="" id=":XNY">D.</td>
<td class="" id="dfYW">Insufficient statistical power (86%)
                                                            </td>
<td class="" id="W_zO"></td>
</tr>
<tr id="d3dad02f-f130-4e72-bae5-e97ee02c6f72">
<td class="" id=":XNY">E.</td>
<td class="" id="dfYW">Recall bias (1%)</td>
<td class="" id="W_zO"></td>
</tr>
</tbody>
</table>
<p class="" id="0ef87328-8de7-4edb-8e85-b152661211b6">Incorrect</p>
<p class="" id="7caf3e78-8e82-46b6-b7d8-fc32d61222ca">Correct answer D
                                                </p>
<p class="" id="571f398b-42b1-46c5-9adb-988d14a8ed6f">86%Answered
                                                    correctly</p>
<p class="" id="6205b4fc-f78d-4b90-88e6-f3e6d911c5a3">18 secsTime Spent
                                                </p>
<p class="" id="c90460d5-caad-439c-be9b-a5fbaac35e9b">2024Version</p>
<ul class="bulleted-list" id="cbb86922-2864-48e1-ba02-ede6a48d5104">
<li style="list-style-type:disc">Explanation</li>
</ul>
<ul class="bulleted-list" id="991f177a-3c3a-40b5-8670-78edf4b917a7">
<li style="list-style-type:disc"></li>
</ul>
<p class="" id="39615428-0ee8-4070-88d6-e7a7c4f0d4b1">Statistical power
                                                    represents a study's strength to detect a difference (ie,
                                                    effect size) between treatment groups when one truly exists.  It
                                                    depends on sample size (among other factors): studies with greater
                                                    sample sizes have greater power than studies with smaller sample
                                                    sizes.  An excessively large sample size may determine that a
                                                    clinically irrelevant difference between groups is statistically
                                                    significant (ie, <em>p</em> &lt; 0.05), while an inappropriately
                                                    small sample may determine that a clinically relevant difference
                                                    between groups is statistically insignificant (ie, <em>p</em> &gt;
                                                    0.05).</p>
<p class="" id="599f37d7-13b2-4373-8c5f-01e54d0cfc28">In this case, the
                                                    rate of relapse in the group receiving the new cream is 25% and the
                                                    rate in the group receiving the emollient alone is 50%.  This
                                                    represents a relative risk reduction (RRR) of 50% (ie, [50% ‚àí 25%] /
                                                    50%); therefore, the new cream reduced the risk of relapse by 50%
                                                    (ie, effect size) compared to emollient alone.  A 50% risk reduction
                                                    may be considered clinically relevant; however, it was not
                                                    statistically significant (ie, <em>p</em> = 0.14 &gt; 0.05) in the
                                                    study.</p>
<p class="" id="78a5f090-fbe8-46d8-ae8e-810d02725e7c">The most likely
                                                    explanation is that the sample size (ie, 15 per group) provided
                                                    insufficient power to detect the observed difference between groups
                                                    (ie, effect size, RRR = 50%).  A larger sample size would increase
                                                    the power of the study (ie, its ability to detect the difference),
                                                    and the <em>p</em>-value would reach statistical significance (ie,
                                                    <em>p</em> &lt; 0.05).</p>
<p class="" id="0a78a512-fa69-45ea-85b1-6ed2aa6e6b4f">(Choice A) 
                                                    Ascertainment bias occurs when the results of a study are distorted
                                                    by awareness of treatment assignment, as in an unblind study.  This
                                                    study is double-blinded, thereby minimizing potential ascertainment
                                                    bias.</p>
<p class="" id="01d82f3d-2a0a-4e39-a7b8-2ed078bfc33d">(Choice B) 
                                                    Confounding distorts the relationship between exposures (eg,
                                                    treatments) and the outcome (eg, disease) of interest, and can
                                                    wholly or partially account for observed effects.  This study is a
                                                    randomized trial, thereby minimizing potential confounding bias by
                                                    generating groups that are comparable with respect to known and
                                                    unknown confounding variables.</p>
<p class="" id="cda13d52-b9a7-4c4a-8073-58f06d1cb42f">(Choice C) 
                                                    Ecological fallacy occurs when conclusions are made about
                                                    individuals based on studies where the unit of analysis is a group
                                                    (ie, the conclusions of a study assessing population groups do not
                                                    necessarily apply to individuals).  In this study, the unit of
                                                    analysis is the individual, not the group.</p>
<p class="" id="47f48fab-c2d6-4e59-a126-7b6582c5ff6a">(Choice E)  Recall
                                                    bias results from the inaccurate recollection of past exposure
                                                    status.  It is a potential problem for case-control studies,
                                                    particularly when questionnaires are used to inquire about distant
                                                    past exposure.  However, this study is an experiment in which
                                                    patients are exposed to treatments and then assessed for the
                                                    outcome.</p>
<p class="" id="053aab15-7970-4654-bf26-c18535050171">Educational
                                                    objective:</p>
<p class="" id="f5d87333-0367-4883-acea-17f318085d32">An inappropriately
                                                    small sample will fail to identify important clinically significant
                                                    differences as statistically significant because of a lack of
                                                    sufficient statistical power.</p>
<p class="" id="81cc4d2e-9fac-46fb-8be3-5a9ea8d80fff">Biostatistics</p>
<p class="" id="e96acfff-aa92-4688-b413-07021c11707e">Subject</p>
<p class="" id="29c137bb-4025-4a7a-8fde-898dc9880f47">Biostatistics
                                                    &amp; Epidemiology</p>
<p class="" id="55791820-8fba-4f0b-a79f-44bfd344cbbf">System</p>
<p class="" id="5351c616-175a-40f9-9c0c-6a525e813e0b">Power and sample
                                                    size</p>
<p class="" id="ebbbf4aa-d898-48f5-bb2e-b013d3611966">Topic</p>
<p class="" id="ba8aefdb-1ba9-4d3b-a547-a7cfa938bc6f">Copyright ¬©
                                                    UWorld. All rights reserved.</p>
</details>
</li>
</ul>
</details>


















<style>
.bionic-reading-btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    height: 40px;
    background: rgba(255, 255, 255, 0.2);
    border: 2px solid rgba(255, 255, 255, 0.3);
    border-radius: 8px;
    color: white;
    font-size: 20px;
    cursor: pointer;
    transition: all 0.3s;
    margin-left: auto;
    flex-shrink: 0;
}

.bionic-reading-btn:hover {
    background: rgba(255, 255, 255, 0.35);
    border-color: rgba(255, 255, 255, 0.5);
    transform: scale(1.1);
}

.bionic-reading-btn.active {
    background: rgba(52, 168, 83, 0.4);
    border-color: rgba(52, 168, 83, 0.6);
}

.bionic-reading-btn.active:hover {
    background: rgba(52, 168, 83, 0.5);
}

summary {
    display: flex !important;
    align-items: center !important;
    gap: 12px !important;
}

    /* Highlighter styles */
    .highlighted {
        background-color: #ffeb3b !important;
        transition: background-color 0.2s ease !important;
    }

    .highlighter-btn {
        background: none !important;
        border: none !important;
        cursor: pointer !important;
        font-size: 20px !important;
        padding: 0 8px !important;
        margin-left: 8px !important;
        transition: transform 0.2s ease !important;
        vertical-align: middle !important;
    }

    .highlighter-btn:hover {
        transform: scale(1.2) !important;
    }

    .highlighter-btn.active {
        transform: scale(1.1) !important;
        filter: brightness(1.2) !important;
    }

    .highlighter-mode-active {
        cursor: text !important;
    }


    /* Right padding to avoid overlap with sidebar buttons */
    body {
        padding-right: 50px !important;
    }

    @media (max-width: 768px) {
        body {
            padding-right: 16px !important;
        }
    }


    


    

    /* Adjust table padding to make room for radio button */
    


    /* Clickable Answer Choices */
    table tr.answer-choice {
        cursor: pointer !important;
        transition: all 0.3s ease !important;
    }

    table tr.answer-choice:hover {
        background: #f8f9fa !important;
    }

    table tr.answer-choice td:first-child {
        position: relative !important;
        padding-left: 35px !important;
    }

    table tr.answer-choice td:first-child::before {
        content: '';
        position: absolute;
        left: 8px;
        top: 50%;
        transform: translateY(-50%);
        width: 16px;
        height: 16px;
        border: 2px solid #999;
        border-radius: 50%;
        background: white;
        transition: all 0.2s ease;
        box-sizing: border-box;
    }

    table tr.answer-choice.selected td:first-child::before {
        border-color: #1a73e8;
        border-width: 5px;
    }

    table tr.answer-choice.selected {
        background: #e8f4ff !important;
    }

    table tr.answer-choice.selected td:first-child {
        color: #1a73e8 !important;
        font-weight: 600 !important;
    }

</style>



<script>
let bionicEnabled = false;
const originalContent = {};

function toggleBionicReading(event) {
    if (event) {
        event.preventDefault();
        event.stopPropagation();
    }

    bionicEnabled = !bionicEnabled;
    const btn = document.querySelector('.bionic-reading-btn');
    const icon = document.getElementById('bionicIcon');

    if (bionicEnabled) {
        btn.classList.add('active');
        icon.textContent = '‚úÖ';
        applyBionicReading();
    } else {
        btn.classList.remove('active');
        icon.textContent = 'üëÅÔ∏è';
        restoreOriginalText();
    }
}

function applyBionicReading() {
    // Seleciona todos os elementos de texto, EXCETO summary e buttons
    const textElements = document.querySelectorAll('p:not(summary p):not(button p), td:not(summary td):not(button td), li:not(summary li):not(button li)');

    textElements.forEach((element, index) => {
        // Ignora elementos que cont√™m outros elementos complexos
        if (element.querySelector('p, td, li, h1, h2, h3, h4, h5, h6, button, summary')) {
            return;
        }

        // Ignora se o elemento est√° dentro de um summary ou button
        if (element.closest('summary') || element.closest('button') || element.closest('.bionic-reading-btn')) {
            return;
        }

        // Salva o conte√∫do original
        if (!originalContent[index]) {
            originalContent[index] = {
                element: element,
                html: element.innerHTML
            };
        }

        // Aplica Bionic Reading
        const bionicText = convertToBionic(element.textContent);
        element.innerHTML = bionicText;
    });
}

function restoreOriginalText() {
    // Restaura o conte√∫do original
    Object.values(originalContent).forEach(item => {
        item.element.innerHTML = item.html;
    });
}

function convertToBionic(text) {
    // Divide o texto em palavras, mantendo pontua√ß√£o
    const words = text.split(/(\s+|[.,;:!?()""''\-‚Äì‚Äî])/);

    const bionicWords = words.map(word => {
        // Ignora espa√ßos e pontua√ß√£o
        if (word.match(/^\s+$/) || word.match(/^[.,;:!?()""''\-‚Äì‚Äî]+$/)) {
            return word;
        }

        // Ignora palavras muito curtas (1-2 letras)
        if (word.length <= 2) {
            return word;
        }

        // Determina quantas letras deixar em negrito (metade da palavra, arredondado para cima)
        const boldLength = Math.ceil(word.length / 2);

        // Separa a parte em negrito da parte normal
        const boldPart = word.substring(0, boldLength);
        const normalPart = word.substring(boldLength);

        // Retorna com a primeira parte em negrito
        return `<strong style="font-weight: 700 !important; color: inherit !important; background: none !important; padding: 0 !important;">${boldPart}</strong>${normalPart}`;
    });

    return bionicWords.join('');
}

// Adiciona atalho de teclado (Ctrl+B ou Cmd+B)
document.addEventListener('keydown', function(e) {
    if ((e.ctrlKey || e.metaKey) && e.key === 'b') {
        e.preventDefault();
        toggleBionicReading();
    }
});
</script>

<script>
    let highlighterActive = false;
    let questionHighlights = {};

    // Get question ID from the first summary strong tag
    function getQuestionId() {
        const firstSummary = document.querySelector('summary strong');
        return firstSummary ? firstSummary.textContent.trim() : '1';
    }

    // Load highlights from localStorage
    function loadHighlights() {
        const questionId = getQuestionId();
        const stored = localStorage.getItem('highlights_' + questionId);
        if (stored) {
            questionHighlights = JSON.parse(stored);
            applyStoredHighlights();
        }
    }

    // Save highlights to localStorage
    function saveHighlights() {
        const questionId = getQuestionId();
        localStorage.setItem('highlights_' + questionId, JSON.stringify(questionHighlights));
    }

    // Apply stored highlights
    function applyStoredHighlights() {
        Object.keys(questionHighlights).forEach(key => {
            const element = document.querySelector(`[data-highlight-id="${key}"]`);
            if (element && questionHighlights[key]) {
                element.classList.add('highlighted');
            }
        });
    }

    // Toggle highlighter mode
    function toggleHighlighter(event) {
        event.stopPropagation();
        highlighterActive = !highlighterActive;

        const btn = event.target.closest('.highlighter-btn');
        const icon = btn.querySelector('#highlighterIcon');

        if (highlighterActive) {
            btn.classList.add('active');
            icon.textContent = 'üñçÔ∏è';
            document.body.classList.add('highlighter-mode-active');
        } else {
            btn.classList.remove('active');
            icon.textContent = 'üñäÔ∏è';
            document.body.classList.remove('highlighter-mode-active');
        }
    }

    // Clear all highlights for this question
    function clearHighlights() {
        const questionId = getQuestionId();
        questionHighlights = {};
        localStorage.removeItem('highlights_' + questionId);
        document.querySelectorAll('.highlighted').forEach(el => {
            el.classList.remove('highlighted');
        });
    }

    // Handle text selection and highlighting
    document.addEventListener('mouseup', function(e) {
        if (!highlighterActive) return;

        const selection = window.getSelection();
        if (!selection.toString().trim()) return;

        const range = selection.getRangeAt(0);
        const container = range.commonAncestorContainer;

        // Only highlight text in paragraphs, not in buttons or other elements
        const paragraph = container.nodeType === 3 ? container.parentElement : container;
        if (paragraph.tagName !== 'P' && paragraph.tagName !== 'LI' && paragraph.tagName !== 'TD') {
            return;
        }

        // Create highlight span
        const span = document.createElement('span');
        span.classList.add('highlighted');

        // Generate unique ID for this highlight
        const highlightId = 'hl-' + Date.now() + '-' + Math.random().toString(36).substr(2, 9);
        span.setAttribute('data-highlight-id', highlightId);

        try {
            range.surroundContents(span);
            questionHighlights[highlightId] = true;
            saveHighlights();
        } catch (e) {
            console.log('Could not highlight selection');
        }

        selection.removeAllRanges();
    });

    // Load highlights when page loads
    window.addEventListener('load', loadHighlights);

    // Keyboard shortcut: Ctrl+H to toggle highlighter
    document.addEventListener('keydown', function(e) {
        if (e.ctrlKey && e.key === 'h') {
            e.preventDefault();
            const btn = document.querySelector('.highlighter-btn');
            if (btn) {
                toggleHighlighter({target: btn, stopPropagation: () => {}});
            }
        }
        // Ctrl+Shift+H to clear all highlights
        if (e.ctrlKey && e.shiftKey && e.key === 'H') {
            e.preventDefault();
            if (confirm('Clear all highlights for this question?')) {
                clearHighlights();
            }
        }
    });
</script>





<script>
(function() {
    // Get question ID from summary
    function getQuestionId() {
        const firstSummary = document.querySelector('summary strong');
        return firstSummary ? firstSummary.textContent.trim() : '1';
    }

    // Communicate with parent window (if in iframe)
    function notifyParent(choice) {
        if (window.parent && window.parent !== window) {
            window.parent.postMessage({
                type: 'choiceSelected',
                questionId: getQuestionId(),
                choice: choice
            }, '*');
        }
    }

    // Load saved choice from parent or localStorage
    function loadSavedChoice() {
        const questionId = getQuestionId();

        // Try to get from localStorage first
        const saved = localStorage.getItem('choice_q' + questionId);
        if (saved) {
            selectChoice(saved, false);
        }

        // Ask parent for saved choice (if in iframe)
        if (window.parent && window.parent !== window) {
            window.parent.postMessage({
                type: 'getChoice',
                questionId: questionId
            }, '*');
        }
    }

    // Listen for messages from parent
    window.addEventListener('message', function(event) {
        if (event.data.type === 'setChoice' && event.data.questionId === getQuestionId()) {
            selectChoice(event.data.choice, false);
        }
    });

    // Select a choice
    function selectChoice(choice, notify = true) {
        if (!choice) return;

        const questionId = getQuestionId();

        // Remove previous selection
        document.querySelectorAll('tr.answer-choice').forEach(row => {
            row.classList.remove('selected');
        });

        // Add selection to clicked choice
        const choiceRow = document.querySelector(`tr.answer-choice[data-choice="${choice}"]`);
        if (choiceRow) {
            choiceRow.classList.add('selected');

            // Save to localStorage
            localStorage.setItem('choice_q' + questionId, choice);

            // Notify parent (if in iframe)
            if (notify) {
                notifyParent(choice);
            }
        }
    }

    // Initialize answer choices
    function initializeChoices() {
        // Find all answer choice rows (A, B, C, D, E, F, etc.)
        const choicePattern = /^[A-Z]\.$/;
        const tables = document.querySelectorAll('table.simple-table');

        tables.forEach(table => {
            const rows = table.querySelectorAll('tr');
            rows.forEach(row => {
                const firstCell = row.querySelector('td:first-child');
                if (firstCell && choicePattern.test(firstCell.textContent.trim())) {
                    const choice = firstCell.textContent.trim().replace('.', '');
                    row.classList.add('answer-choice');
                    row.setAttribute('data-choice', choice);
                    row.style.position = 'relative';

                    // Add click handler
                    row.addEventListener('click', function(e) {
                        // Don't trigger if clicking inside a link or button
                        if (e.target.tagName === 'A' || e.target.closest('a')) return;

                        // Toggle selection
                        if (this.classList.contains('selected')) {
                            this.classList.remove('selected');
                            const questionId = getQuestionId();
                            localStorage.removeItem('choice_q' + questionId);
                            notifyParent('');
                        } else {
                            selectChoice(choice);
                        }
                    });
                }
            });
        });

        // Load saved choice after a short delay
        setTimeout(loadSavedChoice, 100);
    }

    // Run when page loads
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initializeChoices);
    } else {
        initializeChoices();
    }
})();
</script>
